/*! License information is available at vendors~orchestra.licenses.txt */(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{BykZ:function(t,e,r){(function(t,e){e.exports=function(){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(t);!(s=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);s=!0);}catch(t){a=!0,i=t}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=c(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}var l=void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function d(){throw new Error("setTimeout has not been defined")}function b(){throw new Error("clearTimeout has not been defined")}var g=d,v=b;function y(t){if(g===setTimeout)return setTimeout(t,0);if((g===d||!g)&&setTimeout)return g=setTimeout,setTimeout(t,0);try{return g(t,0)}catch(e){try{return g.call(null,t,0)}catch(e){return g.call(this,t,0)}}}"function"==typeof l.setTimeout&&(g=setTimeout),"function"==typeof l.clearTimeout&&(v=clearTimeout);var m,_=[],w=!1,E=-1;function S(){w&&m&&(w=!1,m.length?_=m.concat(_):E=-1,_.length&&I())}function I(){if(!w){var t=y(S);w=!0;for(var e=_.length;e;){for(m=_,_=[];++E<e;)m&&m[E].run();E=-1,e=_.length}m=null,w=!1,function(t){if(v===clearTimeout)return clearTimeout(t);if((v===b||!v)&&clearTimeout)return v=clearTimeout,clearTimeout(t);try{v(t)}catch(e){try{return v.call(null,t)}catch(e){return v.call(this,t)}}}(t)}}function T(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];_.push(new k(t,e)),1!==_.length||w||y(I)}function k(t,e){this.fun=t,this.array=e}function x(){}k.prototype.run=function(){this.fun.apply(null,this.array)};var O=x,C=x,D=x,A=x,R=x,M=x,N=x,F=l.performance||{},P=F.now||F.mozNow||F.msNow||F.oNow||F.webkitNow||function(){return(new Date).getTime()},U=new Date,L={nextTick:T,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:O,addListener:C,once:D,off:A,removeListener:R,removeAllListeners:M,emit:N,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*P.call(F),r=Math.floor(e),n=Math.floor(e%1*1e9);return t&&(r-=t[0],(n-=t[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-U)/1e3}},j={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window),h=s&&s.exports===o?o:null,f=i(n[typeof this]&&this),l=a||c!==(f&&f.window)&&c||u||f||Function("return this")(),d={internals:{},config:{Promise:l.Promise},helpers:{}},b=d.helpers.noop=function(){},g=d.helpers.identity=function(t){return t},v=d.helpers.defaultNow=Date.now,y=d.helpers.defaultComparer=function(t,e){return mt(t,e)},m=d.helpers.defaultSubComparer=function(t,e){return t>e?1:t<e?-1:0};d.helpers.defaultKeySerializer=function(t){return t.toString()};var _,w=d.helpers.defaultError=function(t){throw t},E=d.helpers.isPromise=function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then},S=d.helpers.isFunction=((_=function(t){return"function"==typeof t||!1})(/x/)&&(_=function(t){return"function"==typeof t&&"[object Function]"==toString.call(t)}),_);function I(t){for(var e=[],r=0,n=t.length;r<n;r++)e.push(t[r]);return e}var k={e:{}},x=d.internals.tryCatch=function(t){if(!S(t))throw new TypeError("fn must be a function");return e=t,function(){try{return e.apply(this,arguments)}catch(t){return k.e=t,k}};var e};function O(t){throw t}d.config.longStackSupport=!1;var C,D=x((function(){throw new Error}))();C=!!D.e&&!!D.e.stack;var A,R=F();function M(t){var e=P(t);if(!e)return!1;var r=e[0],n=e[1];return r===A&&n>=R&&n<=On}function N(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function F(){if(C)try{throw new Error}catch(r){var t=r.stack.split("\n"),e=P(t[0].indexOf("@")>0?t[1]:t[2]);if(!e)return;return A=e[0],e[1]}}function P(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(r)return[r[1],Number(r[2])];var n=/.*@(.+):(\d+)$/.exec(t);return n?[n[1],Number(n[2])]:void 0}var U=d.EmptyError=function(){this.message="Sequence contains no elements.",Error.call(this)};U.prototype=Object.create(Error.prototype),U.prototype.name="EmptyError";var j=d.ObjectDisposedError=function(){this.message="Object has been disposed",Error.call(this)};j.prototype=Object.create(Error.prototype),j.prototype.name="ObjectDisposedError";var q=d.ArgumentOutOfRangeError=function(){this.message="Argument out of range",Error.call(this)};q.prototype=Object.create(Error.prototype),q.prototype.name="ArgumentOutOfRangeError";var B=d.NotSupportedError=function(t){this.message=t||"This operation is not supported",Error.call(this)};B.prototype=Object.create(Error.prototype),B.prototype.name="NotSupportedError";var z=d.NotImplementedError=function(t){this.message=t||"This operation is not implemented",Error.call(this)};z.prototype=Object.create(Error.prototype),z.prototype.name="NotImplementedError";var V=d.helpers.notImplemented=function(){throw new z};d.helpers.notSupported=function(){throw new B};var W="function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_";l.Set&&"function"==typeof(new l.Set)["@@iterator"]&&(W="@@iterator");var H=d.doneEnumerator={done:!0,value:r},K=d.helpers.isIterable=function(t){return t&&t[W]!==r},G=d.helpers.isArrayLike=function(t){return t&&t.length!==r};d.helpers.iterator=W;var X=d.internals.bindCallback=function(t,e,r){if(void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}},Y="[object Arguments]",J="[object Array]",$="[object Boolean]",Q="[object Date]",Z="[object Error]",tt="[object Number]",et="[object Object]",rt="[object RegExp]",nt="[object String]",it={};it["[object Float32Array]"]=it["[object Float64Array]"]=it["[object Int8Array]"]=it["[object Int16Array]"]=it["[object Int32Array]"]=it["[object Uint8Array]"]=it["[object Uint8ClampedArray]"]=it["[object Uint16Array]"]=it["[object Uint32Array]"]=!0,it[Y]=it[J]=it["[object ArrayBuffer]"]=it[$]=it[Q]=it[Z]=it["[object Function]"]=it["[object Map]"]=it[tt]=it[et]=it[rt]=it["[object Set]"]=it[nt]=it["[object WeakMap]"]=!1;var ot=Object.prototype,st=ot.hasOwnProperty,at=ot.toString,ut=Math.pow(2,53)-1,ct=Object.keys||function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(i){if("object"!=typeof i&&("function"!=typeof i||null===i))throw new TypeError("Object.keys called on non-object");var o,s,a=[];for(o in i)t.call(i,o)&&a.push(o);if(e)for(s=0;s<n;s++)t.call(i,r[s])&&a.push(r[s]);return a}}();function ht(t,e,n,i,o,s){var a=ct(t),u=a.length;if(u!==ct(e).length&&!i)return!1;for(var c,h=u;h--;)if(c=a[h],!(i?c in e:st.call(e,c)))return!1;for(var f=i;++h<u;){var l,p=t[c=a[h]],d=e[c];if(!(l===r?n(p,d,i,o,s):l))return!1;f||(f="constructor"===c)}if(!f){var b=t.constructor,g=e.constructor;if(b!==g&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof g&&g instanceof g))return!1}return!0}var ft=d.internals.isObject=function(t){var e=typeof t;return!!t&&("object"===e||"function"===e)};function lt(t){return!!t&&"object"==typeof t}function pt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ut}var dt=function(){try{Object({toString:0}+"")}catch(t){return function(){return!1}}return function(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}}(),bt=Array.isArray||function(t){return lt(t)&&pt(t.length)&&at.call(t)===J};function gt(t,e){for(var r=-1,n=t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function vt(t,e,n,i,o,s){var a=-1,u=t.length,c=e.length;if(u!==c&&!(i&&c>u))return!1;for(;++a<u;){var h=t[a],f=e[a];if(void 0!==r)return!1;if(i){if(!gt(e,(function(t){return h===t||n(h,t,i,o,s)})))return!1}else if(h!==f&&!n(h,f,i,o,s))return!1}return!0}function yt(t,e,r,n,i){return t===e||(null==t||null==e||!ft(t)&&!lt(e)?t!=t&&e!=e:function(t,e,r,n,i,o){var s,a=bt(t),u=bt(e),c=J,h=J;a||((c=at.call(t))===Y?c=et:c!==et&&(a=lt(s=t)&&pt(s.length)&&!!it[at.call(s)])),u||(h=at.call(e))===Y&&(h=et);var f=c===et&&!dt(t),l=h===et&&!dt(e),p=c===h;if(p&&!a&&!f)return function(t,e,r){switch(r){case $:case Q:return+t==+e;case Z:return t.name===e.name&&t.message===e.message;case tt:return t!==+t?e!==+e:t===+e;case rt:case nt:return t===e+""}return!1}(t,e,c);if(!n){var d=f&&st.call(t,"__wrapped__"),b=l&&st.call(e,"__wrapped__");if(d||b)return r(d?t.value():t,b?e.value():e,n,i,o)}if(!p)return!1;i||(i=[]),o||(o=[]);for(var g=i.length;g--;)if(i[g]===t)return o[g]===e;i.push(t),o.push(e);var v=(a?vt:ht)(t,e,r,n,i,o);return i.pop(),o.pop(),v}(t,e,yt,r,n,i))}var mt=d.internals.isEqual=function(t,e){return yt(t,e)},_t=d.internals.inherits=function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r},wt=d.internals.addProperties=function(t){for(var e=[],r=1,n=arguments.length;r<n;r++)e.push(arguments[r]);for(var i=0,o=e.length;i<o;i++){var s=e[i];for(var a in s)t[a]=s[a]}},Et=d.internals.addRef=function(t,e){return new Sn((function(r){return new Nt(e.getDisposable(),t.subscribe(r))}))};function St(t,e){for(var r=new Array(t),n=0;n<t;n++)r[n]=e();return r}var It=d.CompositeDisposable=function(){var t,e,r=[];if(Array.isArray(arguments[0]))r=arguments[0];else for(e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];this.disposables=r,this.isDisposed=!1,this.length=r.length},Tt=It.prototype;Tt.add=function(t){this.isDisposed?t.dispose():(this.disposables.push(t),this.length++)},Tt.remove=function(t){var e=!1;if(!this.isDisposed){var r=this.disposables.indexOf(t);-1!==r&&(e=!0,this.disposables.splice(r,1),this.length--,t.dispose())}return e},Tt.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=this.disposables.length,e=new Array(t),r=0;r<t;r++)e[r]=this.disposables[r];for(this.disposables=[],this.length=0,r=0;r<t;r++)e[r].dispose()}};var kt=d.Disposable=function(t){this.isDisposed=!1,this.action=t||b};kt.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var xt=kt.create=function(t){return new kt(t)},Ot=kt.empty={dispose:b},Ct=kt.isDisposable=function(t){return t&&S(t.dispose)},Dt=kt.checkDisposed=function(t){if(t.isDisposed)throw new j},At=kt._fixup=function(t){return Ct(t)?t:Ot},Rt=d.SingleAssignmentDisposable=function(){this.isDisposed=!1,this.current=null};Rt.prototype.getDisposable=function(){return this.current},Rt.prototype.setDisposable=function(t){if(this.current)throw new Error("Disposable has already been assigned");var e=this.isDisposed;!e&&(this.current=t),e&&t&&t.dispose()},Rt.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null,t&&t.dispose()}};var Mt=d.SerialDisposable=function(){this.isDisposed=!1,this.current=null};Mt.prototype.getDisposable=function(){return this.current},Mt.prototype.setDisposable=function(t){var e=this.isDisposed;if(!e){var r=this.current;this.current=t}r&&r.dispose(),e&&t&&t.dispose()},Mt.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null}t&&t.dispose()};var Nt=d.BinaryDisposable=function(t,e){this._first=t,this._second=e,this.isDisposed=!1};Nt.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this._first;this._first=null,t&&t.dispose();var e=this._second;this._second=null,e&&e.dispose()}};var Ft=d.NAryDisposable=function(t){this._disposables=t,this.isDisposed=!1};Ft.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=0,e=this._disposables.length;t<e;t++)this._disposables[t].dispose();this._disposables.length=0}};var Pt=d.RefCountDisposable=function(){function t(t){this.disposable=t,this.disposable.count++,this.isInnerDisposed=!1}function e(t){this.underlyingDisposable=t,this.isDisposed=!1,this.isPrimaryDisposed=!1,this.count=0}return t.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,0===this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))},e.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))},e.prototype.getDisposable=function(){return this.isDisposed?Ot:new t(this)},e}();function Ut(t,e){this.scheduler=t,this.disposable=e,this.isDisposed=!1}function Lt(t,e){e.isDisposed||(e.isDisposed=!0,e.disposable.dispose())}Ut.prototype.dispose=function(){this.scheduler.schedule(this,Lt)};var jt=d.internals.ScheduledItem=function(t,e,r,n,i){this.scheduler=t,this.state=e,this.action=r,this.dueTime=n,this.comparer=i||m,this.disposable=new Rt};jt.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())},jt.prototype.compareTo=function(t){return this.comparer(this.dueTime,t.dueTime)},jt.prototype.isCancelled=function(){return this.disposable.isDisposed},jt.prototype.invokeCore=function(){return At(this.action(this.scheduler,this.state))};var qt=d.Scheduler=function(){function t(){}t.isScheduler=function(e){return e instanceof t};var e=t.prototype;return e.schedule=function(t,e){throw new z},e.scheduleFuture=function(e,r,n){var i=r;return i instanceof Date&&(i-=this.now()),0===(i=t.normalize(i))?this.schedule(e,n):this._scheduleFuture(e,i,n)},e._scheduleFuture=function(t,e,r){throw new z},t.now=v,t.prototype.now=v,t.normalize=function(t){return t<0&&(t=0),t},t}(),Bt=qt.normalize,zt=qt.isScheduler;!function(t){function e(t,e){var r=e[0],n=e[1],i=new It;return n(r,(function e(r){var o=!1,s=!1,a=t.schedule(r,(function(t,r){return o?i.remove(a):s=!0,n(r,e),Ot}));s||(i.add(a),o=!0)})),i}function r(t,e){var r=e[0],n=e[1],i=new It;return n(r,(function e(r,o){var s=!1,a=!1,u=t.scheduleFuture(r,o,(function(t,r){return s?i.remove(u):a=!0,n(r,e),Ot}));a||(i.add(u),s=!0)})),i}t.scheduleRecursive=function(t,r){return this.schedule([t,r],e)},t.scheduleRecursiveFuture=function(t,e,n){return this.scheduleFuture([t,n],e,r)}}(qt.prototype),qt.prototype.schedulePeriodic=function(t,e,r){if(void 0===l.setInterval)throw new B;e=Bt(e);var n=t,i=l.setInterval((function(){n=r(n)}),e);return xt((function(){l.clearInterval(i)}))},function(t){t.catchError=t.catch=function(t){return new te(this,t)}}(qt.prototype),d.internals.SchedulePeriodicRecursive=function(){function t(t,e,r,n){this._scheduler=t,this._state=e,this._period=r,this._action=n}return t.prototype.start=function(){var t=new Rt;return this._cancel=t,t.setDisposable(this._scheduler.scheduleRecursiveFuture(0,this._period,function(t){return function(e,r){r(0,t._period);var n=x(t._action)(t._state);n===k&&(t._cancel.dispose(),O(n.e)),t._state=n}}(this))),t},t}();var Vt,Wt,Ht=function(t){function e(){t.call(this)}return _t(e,t),e.prototype.schedule=function(t,e){return At(e(this,t))},e}(qt),Kt=qt.immediate=new Ht,Gt=function(t){var e;function r(){for(;e.length>0;){var t=e.dequeue();!t.isCancelled()&&t.invoke()}}function n(){t.call(this)}return _t(n,t),n.prototype.schedule=function(t,n){var i=new jt(this,t,n,this.now());if(e)e.enqueue(i);else{(e=new re(4)).enqueue(i);var o=x(r)();e=null,o===k&&O(o.e)}return i.disposable},n.prototype.scheduleRequired=function(){return!e},n}(qt),Xt=qt.currentThread=new Gt,Yt=function(){var t,e=b;if(l.setTimeout)t=l.setTimeout,e=l.clearTimeout;else{if(!l.WScript)throw new B;t=function(t,e){l.WScript.Sleep(e),t()}}return{setTimeout:t,clearTimeout:e}}(),Jt=Yt.setTimeout,$t=Yt.clearTimeout;!function(){var t=1,e={},r=!1;function n(t){if(r)Jt((function(){n(t)}),0);else{var i=e[t];if(i){r=!0;var o=x(i)();Wt(t),r=!1,o===k&&O(o.e)}}}Wt=function(t){delete e[t]};var i=new RegExp("^"+String(toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),o="function"==typeof(o=a&&h&&a.setImmediate)&&!i.test(o)&&o;if(S(o))Vt=function(r){var i=t++;return e[i]=r,o((function(){n(i)})),i};else if(void 0!==L&&"[object process]"==={}.toString.call(L))Vt=function(r){var i=t++;return e[i]=r,T((function(){n(i)})),i};else if(function(){if(!l.postMessage||l.importScripts)return!1;var t=!1,e=l.onmessage;return l.onmessage=function(){t=!0},l.postMessage("","*"),l.onmessage=e,t}()){var s="ms.rx.schedule"+Math.random();l.addEventListener("message",(function(t){"string"==typeof t.data&&t.data.substring(0,s.length)===s&&n(t.data.substring(s.length))}),!1),Vt=function(r){var n=t++;return e[n]=r,l.postMessage(s+n,"*"),n}}else if(l.MessageChannel){var u=new l.MessageChannel;u.port1.onmessage=function(t){n(t.data)},Vt=function(r){var n=t++;return e[n]=r,u.port2.postMessage(n),n}}else Vt="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(r){var i=l.document.createElement("script"),o=t++;return e[o]=r,i.onreadystatechange=function(){n(o),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},l.document.documentElement.appendChild(i),o}:function(r){var i=t++;return e[i]=r,Jt((function(){n(i)}),0),i}}();var Qt=function(t){function e(){t.call(this)}function r(t,e,r,n){return function(){t.setDisposable(kt._fixup(e(r,n)))}}function n(t){this._id=t,this.isDisposed=!1}function i(t){this._id=t,this.isDisposed=!1}return _t(e,t),n.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,Wt(this._id))},i.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,$t(this._id))},e.prototype.schedule=function(t,e){var i=new Rt,o=Vt(r(i,e,this,t));return new Nt(i,new n(o))},e.prototype._scheduleFuture=function(t,e,n){if(0===e)return this.schedule(t,n);var o=new Rt,s=Jt(r(o,n,this,t),e);return new Nt(o,new i(s))},e.prototype.scheduleLongRunning=function(t,e){var r=xt(b);return Vt(function(t,e,r){return function(){e(t,r)}}(t,e,r)),r},e}(qt),Zt=qt.default=qt.async=new Qt,te=function(t){function e(e,r){this._scheduler=e,this._handler=r,this._recursiveOriginal=null,this._recursiveWrapper=null,t.call(this)}return _t(e,t),e.prototype.schedule=function(t,e){return this._scheduler.schedule(t,this._wrap(e))},e.prototype._scheduleFuture=function(t,e,r){return this._scheduler.schedule(t,e,this._wrap(r))},e.prototype.now=function(){return this._scheduler.now()},e.prototype._clone=function(t){return new e(t,this._handler)},e.prototype._wrap=function(t){var e=this;return function(r,n){var i=x(t)(e._getRecursiveWrapper(r),n);return i===k?(e._handler(i.e)||O(i.e),Ot):At(i)}},e.prototype._getRecursiveWrapper=function(t){if(this._recursiveOriginal!==t){this._recursiveOriginal=t;var e=this._clone(t);e._recursiveOriginal=t,e._recursiveWrapper=e,this._recursiveWrapper=e}return this._recursiveWrapper},e.prototype.schedulePeriodic=function(t,e,r){var n=this,i=!1,o=new Rt;return o.setDisposable(this._scheduler.schedulePeriodic(t,e,(function(t){if(i)return null;var e=x(r)(t);return e===k?(i=!0,n._handler(e.e)||O(e.e),o.dispose(),null):e}))),o},e}(qt);function ee(t,e){this.id=t,this.value=e}ee.prototype.compareTo=function(t){var e=this.value.compareTo(t.value);return 0===e&&(e=this.id-t.id),e};var re=d.internals.PriorityQueue=function(t){this.items=new Array(t),this.length=0},ne=re.prototype;ne.isHigherPriority=function(t,e){return this.items[t].compareTo(this.items[e])<0},ne.percolate=function(t){if(!(t>=this.length||t<0)){var e=t-1>>1;if(!(e<0||e===t)&&this.isHigherPriority(t,e)){var r=this.items[t];this.items[t]=this.items[e],this.items[e]=r,this.percolate(e)}}},ne.heapify=function(t){if(+t||(t=0),!(t>=this.length||t<0)){var e=2*t+1,r=2*t+2,n=t;if(e<this.length&&this.isHigherPriority(e,n)&&(n=e),r<this.length&&this.isHigherPriority(r,n)&&(n=r),n!==t){var i=this.items[t];this.items[t]=this.items[n],this.items[n]=i,this.heapify(n)}}},ne.peek=function(){return this.items[0].value},ne.removeAt=function(t){this.items[t]=this.items[--this.length],this.items[this.length]=r,this.heapify()},ne.dequeue=function(){var t=this.peek();return this.removeAt(0),t},ne.enqueue=function(t){var e=this.length++;this.items[e]=new ee(re.count++,t),this.percolate(e)},ne.remove=function(t){for(var e=0;e<this.length;e++)if(this.items[e].value===t)return this.removeAt(e),!0;return!1},re.count=0;var ie=d.Notification=function(){function t(){}return t.prototype._accept=function(t,e,r){throw new z},t.prototype._acceptObserver=function(t,e,r){throw new z},t.prototype.accept=function(t,e,r){return t&&"object"==typeof t?this._acceptObserver(t):this._accept(t,e,r)},t.prototype.toObservable=function(t){var e=this;return zt(t)||(t=Kt),new Sn((function(r){return t.schedule(e,(function(t,e){e._acceptObserver(r),"N"===e.kind&&r.onCompleted()}))}))},t}(),oe=function(t){function e(t){this.value=t,this.kind="N"}return _t(e,t),e.prototype._accept=function(t){return t(this.value)},e.prototype._acceptObserver=function(t){return t.onNext(this.value)},e.prototype.toString=function(){return"OnNext("+this.value+")"},e}(ie),se=function(t){function e(t){this.error=t,this.kind="E"}return _t(e,t),e.prototype._accept=function(t,e){return e(this.error)},e.prototype._acceptObserver=function(t){return t.onError(this.error)},e.prototype.toString=function(){return"OnError("+this.error+")"},e}(ie),ae=function(t){function e(){this.kind="C"}return _t(e,t),e.prototype._accept=function(t,e,r){return r()},e.prototype._acceptObserver=function(t){return t.onCompleted()},e.prototype.toString=function(){return"OnCompleted()"},e}(ie),ue=ie.createOnNext=function(t){return new oe(t)},ce=ie.createOnError=function(t){return new se(t)},he=ie.createOnCompleted=function(){return new ae},fe=d.Observer=function(){};fe.prototype.toNotifier=function(){var t=this;return function(e){return e.accept(t)}},fe.prototype.asObserver=function(){var t=this;return new be((function(e){t.onNext(e)}),(function(e){t.onError(e)}),(function(){t.onCompleted()}))},fe.prototype.checked=function(){return new ge(this)};var le=fe.create=function(t,e,r){return t||(t=b),e||(e=w),r||(r=b),new be(t,e,r)};fe.fromNotifier=function(t,e){var r=X(t,e,1);return new be((function(t){return r(ue(t))}),(function(t){return r(ce(t))}),(function(){return r(he())}))},fe.prototype.notifyOn=function(t){return new ve(t,this)},fe.prototype.makeSafe=function(t){return new AnonymousSafeObserver(this._onNext,this._onError,this._onCompleted,t)};var pe,de=d.internals.AbstractObserver=function(t){function e(){this.isStopped=!1}return _t(e,t),e.prototype.next=V,e.prototype.error=V,e.prototype.completed=V,e.prototype.onNext=function(t){!this.isStopped&&this.next(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.error(t))},e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.error(t),!0)},e}(fe),be=d.AnonymousObserver=function(t){function e(e,r,n){t.call(this),this._onNext=e,this._onError=r,this._onCompleted=n}return _t(e,t),e.prototype.next=function(t){this._onNext(t)},e.prototype.error=function(t){this._onError(t)},e.prototype.completed=function(){this._onCompleted()},e}(de),ge=function(t){function e(e){t.call(this),this._observer=e,this._state=0}_t(e,t);var r=e.prototype;return r.onNext=function(t){this.checkAccess();var e=x(this._observer.onNext).call(this._observer,t);this._state=0,e===k&&O(e.e)},r.onError=function(t){this.checkAccess();var e=x(this._observer.onError).call(this._observer,t);this._state=2,e===k&&O(e.e)},r.onCompleted=function(){this.checkAccess();var t=x(this._observer.onCompleted).call(this._observer);this._state=2,t===k&&O(t.e)},r.checkAccess=function(){if(1===this._state)throw new Error("Re-entrancy detected");if(2===this._state)throw new Error("Observer completed");0===this._state&&(this._state=1)},e}(fe),ve=function(t){function e(e,r,n){t.call(this,e,r),this._cancel=n}return _t(e,t),e.prototype.next=function(e){t.prototype.next.call(this,e),this.ensureActive()},e.prototype.error=function(e){t.prototype.error.call(this,e),this.ensureActive()},e.prototype.completed=function(){t.prototype.completed.call(this),this.ensureActive()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._cancel&&this._cancel.dispose(),this._cancel=null},e}(d.internals.ScheduledObserver=function(t){function e(e,r){t.call(this),this.scheduler=e,this.observer=r,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new Mt}function r(t,e){var r;if(t.queue.length>0){r=t.queue.shift();var n=x(r)();if(n===k)return t.queue=[],t.hasFaulted=!0,O(n.e);e(t)}else t.isAcquired=!1}return _t(e,t),e.prototype.next=function(t){this.queue.push(function(t,e){return function(){t.onNext(e)}}(this.observer,t))},e.prototype.error=function(t){this.queue.push(function(t,e){return function(){t.onError(e)}}(this.observer,t))},e.prototype.completed=function(){var t;this.queue.push((t=this.observer,function(){t.onCompleted()}))},e.prototype.ensureActive=function(){var t=!1;!this.hasFaulted&&this.queue.length>0&&(t=!this.isAcquired,this.isAcquired=!0),t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(this,r))},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.disposable.dispose()},e}(de)),ye=d.Observable=function(){function t(){if(d.config.longStackSupport&&C){var t=this._subscribe,e=x(O)(new Error).e;this.stack=e.stack.substring(e.stack.indexOf("\n")+1),this._subscribe=function(t,e){return function(r){var n=r.onError;return r.onError=function(e){(function(t,e){if(C&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf("From previous event:")){for(var r=[],n=e;n;n=n.source)n.stack&&r.unshift(n.stack);r.unshift(t.stack);var i=r.join("\nFrom previous event:\n");t.stack=function(t){for(var e=t.split("\n"),r=[],n=0,i=e.length;n<i;n++){var o=e[n];M(o)||N(o)||!o||r.push(o)}return r.join("\n")}(i)}})(e,t),n.call(r,e)},e.call(t,r)}}(this,t)}}return pe=t.prototype,t.isObservable=function(t){return t&&S(t.subscribe)},pe.subscribe=pe.forEach=function(t,e,r){return this._subscribe("object"==typeof t?t:le(t,e,r))},pe.subscribeOnNext=function(t,e){return this._subscribe(le(void 0!==e?function(r){t.call(e,r)}:t))},pe.subscribeOnError=function(t,e){return this._subscribe(le(null,void 0!==e?function(r){t.call(e,r)}:t))},pe.subscribeOnCompleted=function(t,e){return this._subscribe(le(null,null,void 0!==e?function(){t.call(e)}:t))},t}(),me=d.ObservableBase=function(t){function e(t,e){var r,n=e[0],i=e[1],o=x(i.subscribeCore).call(i,n);o!==k||n.fail(k.e)||O(k.e),n.setDisposable((r=o)&&S(r.dispose)?r:S(r)?xt(r):Ot)}function r(){t.call(this)}return _t(r,t),r.prototype._subscribe=function(t){var r=new In(t),n=[r,this];return Xt.scheduleRequired()?Xt.schedule(n,e):e(0,n),r},r.prototype.subscribeCore=V,r}(ye),_e=d.FlatMapObservable=function(t){function e(e,r,n,i){this.resultSelector=S(n)?n:null,this.selector=X(S(r)?r:function(){return r},i,3),this.source=e,t.call(this)}function r(t,e,r,n){this.i=0,this.selector=e,this.resultSelector=r,this.source=n,this.o=t,de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.selector,this.resultSelector,this))},_t(r,de),r.prototype._wrapResult=function(t,e,r){return this.resultSelector?t.map((function(t,n){return this.resultSelector(e,t,r,n)}),this):t},r.prototype.next=function(t){var e=this.i++,r=x(this.selector)(t,e,this.source);if(r===k)return this.o.onError(r.e);E(r)&&(r=Re(r)),(G(r)||K(r))&&(r=ye.from(r)),this.o.onNext(this._wrapResult(r,t,e))},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(me),we=d.internals.Enumerable=function(){};function Ee(t){this._s=t,this.isDisposed=!1}Ee.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.isDisposed=!0)};var Se=function(t){function e(e){this.sources=e,t.call(this)}function r(t,e){if(!t.isDisposed){var r=x(t.e.next).call(t.e);if(r===k)return t.o.onError(r.e);if(r.done)return t.o.onCompleted();var i=r.value;E(i)&&(i=Re(i));var o=new Rt;t.subscription.setDisposable(o),o.setDisposable(i.subscribe(new n(t,e)))}}function n(t,e){this._state=t,this._recurse=e,de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Mt,n={isDisposed:!1,o:t,subscription:e,e:this.sources[W]()},i=Xt.scheduleRecursive(n,r);return new Ft([e,i,new Ee(n)])},_t(n,de),n.prototype.next=function(t){this._state.o.onNext(t)},n.prototype.error=function(t){this._state.o.onError(t)},n.prototype.completed=function(){this._recurse(this._state)},e}(me);we.prototype.concat=function(){return new Se(this)};var Ie=function(t){function e(e){this.sources=e,t.call(this)}function r(t,e){if(!t.isDisposed){var r=x(t.e.next).call(t.e);if(r===k)return t.o.onError(r.e);if(r.done)return null!==t.lastError?t.o.onError(t.lastError):t.o.onCompleted();var i=r.value;E(i)&&(i=Re(i));var o=new Rt;t.subscription.setDisposable(o),o.setDisposable(i.subscribe(new n(t,e)))}}function n(t,e){this._state=t,this._recurse=e,de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Mt,n={isDisposed:!1,e:this.sources[W](),subscription:e,lastError:null,o:t},i=Xt.scheduleRecursive(n,r);return new Ft([e,i,new Ee(n)])},_t(n,de),n.prototype.next=function(t){this._state.o.onNext(t)},n.prototype.error=function(t){this._state.lastError=t,this._recurse(this._state)},n.prototype.completed=function(){this._state.o.onCompleted()},e}(me);we.prototype.catchError=function(){return new Ie(this)};var Te=function(t){function e(t,e){this.v=t,this.c=null==e?-1:e}function r(t){this.v=t.v,this.l=t.c}return _t(e,t),e.prototype[W]=function(){return new r(this)},r.prototype.next=function(){return 0===this.l?H:(this.l>0&&this.l--,{done:!1,value:this.v})},e}(we),ke=we.repeat=function(t,e){return new Te(t,e)},xe=function(t){function e(t,e,r){this.s=t,this.fn=e?X(e,r,3):null}function r(t){this.i=-1,this.s=t.s,this.l=this.s.length,this.fn=t.fn}return _t(e,t),e.prototype[W]=function(){return new r(this)},r.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:H},e}(we),Oe=we.of=function(t,e,r){return new xe(t,e,r)},Ce=function(t){function e(e,r){this.source=e,this._s=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new ve(this._s,t))},e}(me);pe.observeOn=function(t){return new Ce(this,t)};var De=function(t){function e(e,r){this.source=e,this._s=r,t.call(this)}function r(t,e){var r=e[0],n=e[1],i=e[2];n.setDisposable(new Ut(t,r.subscribe(i)))}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Rt,n=new Mt;return n.setDisposable(e),e.setDisposable(this._s.schedule([this.source,n,t],r)),n},e}(me);pe.subscribeOn=function(t){return new De(this,t)};var Ae=function(t){function e(e,r){this._p=e,this._s=r,t.call(this)}function r(t,e){var r=e[0],n=e[1];r.onNext(n),r.onCompleted()}function n(t,e){var r=e[0],n=e[1];r.onError(n)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Rt,i=this,o=this._p;return S(o)&&(o=x(o)())===k?(t.onError(o.e),e):(o.then((function(n){e.setDisposable(i._s.schedule([t,n],r))}),(function(r){e.setDisposable(i._s.schedule([t,r],n))})),e)},e}(me),Re=ye.fromPromise=function(t,e){return e||(e=Zt),new Ae(t,e)};pe.toPromise=function(t){if(t||(t=d.config.Promise),!t)throw new B("Promise type not provided nor in Rx.config.Promise");var e=this;return new t((function(t,r){var n;e.subscribe((function(t){n=t}),r,(function(){t(n)}))}))};var Me=function(t){function e(e){this.source=e,t.call(this)}function r(t){this.o=t,this.a=[],de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t))},_t(r,de),r.prototype.next=function(t){this.a.push(t)},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onNext(this.a),this.o.onCompleted()},e}(me);pe.toArray=function(){return new Me(this)},ye.create=function(t,e){return new Sn(t,e)};var Ne=function(t){function e(e){this._f=e,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=x(this._f)();return e===k?nr(e.e).subscribe(t):(E(e)&&(e=Re(e)),e.subscribe(t))},e}(me);ye.defer=function(t){return new Ne(t)};var Fe=function(t){function e(e){this.scheduler=e,t.call(this)}function r(t,e){this.observer=t,this.scheduler=e}function n(t,e){return e.onCompleted(),Ot}return _t(e,t),e.prototype.subscribeCore=function(t){return new r(t,this.scheduler).run()},r.prototype.run=function(){var t=this.observer;return this.scheduler===Kt?n(0,t):this.scheduler.schedule(t,n)},e}(me),Pe=new Fe(Kt),Ue=ye.empty=function(t){return zt(t)||(t=Kt),t===Kt?Pe:new Fe(t)},Le=function(t){function e(e,r,n){this._iterable=e,this._fn=r,this._scheduler=n,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=function(t){var e=t[W];if(!e&&"string"==typeof t)return new qe(t)[W]();if(!e&&t.length!==r)return new ze(t)[W]();if(!e)throw new TypeError("Object is not iterable");return t[W]()}(Object(this._iterable));return this._scheduler.scheduleRecursive(0,function(t,e,r){return function(n,i){var o=x(e.next).call(e);if(o===k)return t.onError(o.e);if(o.done)return t.onCompleted();var s=o.value;if(S(r)&&(s=x(r)(s,n))===k)return t.onError(s.e);t.onNext(s),i(n+1)}}(t,e,this._fn))},e}(me),je=Math.pow(2,53)-1;function qe(t){this._s=t}function Be(t){this._s=t,this._l=t.length,this._i=0}function ze(t){this._a=t}function Ve(t){this._a=t,this._l=function(t){var e,r=+t.length;return isNaN(r)?0:0!==r&&"number"==typeof(e=r)&&l.isFinite(e)?(r=function(t){var e=+t;return 0===e?e:isNaN(e)?e:e<0?-1:1}(r)*Math.floor(Math.abs(r)))<=0?0:r>je?je:r:r}(t),this._i=0}qe.prototype[W]=function(){return new Be(this._s)},Be.prototype[W]=function(){return this},Be.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:H},ze.prototype[W]=function(){return new Ve(this._a)},Ve.prototype[W]=function(){return this},Ve.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:H};var We=ye.from=function(t,e,r,n){if(null==t)throw new Error("iterable cannot be null.");if(e&&!S(e))throw new Error("mapFn when provided must be a function");if(e)var i=X(e,r,2);return zt(n)||(n=Xt),new Le(t,i,n)},He=function(t){function e(e,r){this._args=e,this._scheduler=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this._scheduler.scheduleRecursive(0,function(t,e){var r=e.length;return function(n,i){n<r?(t.onNext(e[n]),i(n+1)):t.onCompleted()}}(t,this._args))},e}(me),Ke=ye.fromArray=function(t,e){return zt(e)||(e=Xt),new He(t,e)},Ge=function(t){function e(e,r,n,i,o){this._initialState=e,this._cndFn=r,this._itrFn=n,this._resFn=i,this._s=o,t.call(this)}function r(t,e){if(t.first)t.first=!1;else if(t.newState=x(t.self._itrFn)(t.newState),t.newState===k)return t.o.onError(t.newState.e);var r=x(t.self._cndFn)(t.newState);if(r===k)return t.o.onError(r.e);if(r){var n=x(t.self._resFn)(t.newState);if(n===k)return t.o.onError(n.e);t.o.onNext(n),e(t)}else t.o.onCompleted()}return _t(e,t),e.prototype.subscribeCore=function(t){var e={o:t,self:this,first:!0,newState:this._initialState};return this._s.scheduleRecursive(e,r)},e}(me);ye.generate=function(t,e,r,n,i){return zt(i)||(i=Xt),new Ge(t,e,r,n,i)};var Xe=new(function(t){function e(){t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return Ot},e}(me)),Ye=ye.never=function(){return Xe};function Je(t,e){return zt(t)||(t=Xt),new He(e,t)}ye.of=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return new He(e,Xt)},ye.ofWithScheduler=function(t){for(var e=arguments.length,r=new Array(e-1),n=1;n<e;n++)r[n-1]=arguments[n];return new He(r,t)};var $e=function(t){function e(e,r){this._o=e,this._keys=Object.keys(e),this._scheduler=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this._scheduler.scheduleRecursive(0,function(t,e,r){return function(n,i){if(n<r.length){var o=r[n];t.onNext([o,e[o]]),i(n+1)}else t.onCompleted()}}(t,this._o,this._keys))},e}(me);ye.pairs=function(t,e){return e||(e=Xt),new $e(t,e)};var Qe=function(t){function e(e,r,n){this.start=e,this.rangeCount=r,this.scheduler=n,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.scheduler.scheduleRecursive(0,function(t,e,r){return function(n,i){n<e?(r.onNext(t+n),i(n+1)):r.onCompleted()}}(this.start,this.rangeCount,t))},e}(me);ye.range=function(t,e,r){return zt(r)||(r=Xt),new Qe(t,e,r)};var Ze=function(t){function e(e,r,n){this.value=e,this.repeatCount=null==r?-1:r,this.scheduler=n,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return new tr(t,this).run()},e}(me);function tr(t,e){this.observer=t,this.parent=e}tr.prototype.run=function(){var t=this.observer,e=this.parent.value;return this.parent.scheduler.scheduleRecursive(this.parent.repeatCount,(function(r,n){if((-1===r||r>0)&&(t.onNext(e),r>0&&r--),0===r)return t.onCompleted();n(r)}))},ye.repeat=function(t,e,r){return zt(r)||(r=Xt),new Ze(t,e,r)};var er=function(t){function e(e,r){this._value=e,this._scheduler=r,t.call(this)}function r(t,e){var r=e[0],n=e[1];return n.onNext(r),n.onCompleted(),Ot}return _t(e,t),e.prototype.subscribeCore=function(t){var e=[this._value,t];return this._scheduler===Kt?r(0,e):this._scheduler.schedule(e,r)},e}(me);ye.return=ye.just=function(t,e){return zt(e)||(e=Kt),new er(t,e)};var rr=function(t){function e(e,r){this._error=e,this._scheduler=r,t.call(this)}function r(t,e){var r=e[0];return e[1].onError(r),Ot}return _t(e,t),e.prototype.subscribeCore=function(t){var e=[this._error,t];return this._scheduler===Kt?r(0,e):this._scheduler.schedule(e,r)},e}(me),nr=ye.throw=function(t,e){return zt(e)||(e=Kt),new rr(t,e)},ir=function(t){function e(e,r){this._resFn=e,this._obsFn=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=Ot,r=x(this._resFn)();if(r===k)return new Nt(nr(r.e).subscribe(t),e);r&&(e=r);var n=x(this._obsFn)(r);return new Nt(n===k?nr(n.e).subscribe(t):n.subscribe(t),e)},e}(me);function or(t,e){return t.amb(e)}ye.using=function(t,e){return new ir(t,e)},pe.amb=function(t){var e=this;return new Sn((function(r){var n,i="L",o="R",s=new Rt,a=new Rt;function u(){n||(n=i,a.dispose())}function c(){n||(n=o,s.dispose())}E(t)&&(t=Re(t));var h=le((function(t){u(),n===i&&r.onNext(t)}),(function(t){u(),n===i&&r.onError(t)}),(function(){u(),n===i&&r.onCompleted()})),f=le((function(t){c(),n===o&&r.onNext(t)}),(function(t){c(),n===o&&r.onError(t)}),(function(){c(),n===o&&r.onCompleted()}));return s.setDisposable(e.subscribe(h)),a.setDisposable(t.subscribe(f)),new Nt(s,a)}))},ye.amb=function(){var t,e=Ye();if(Array.isArray(arguments[0]))t=arguments[0];else{var r=arguments.length;t=new Array(t);for(var n=0;n<r;n++)t[n]=arguments[n]}for(n=0,r=t.length;n<r;n++)e=or(e,t[n]);return e};var sr=function(t){function e(e,r){this.source=e,this._fn=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Rt,r=new Mt;return r.setDisposable(e),e.setDisposable(this.source.subscribe(new ar(t,r,this._fn))),r},e}(me),ar=function(t){function e(e,r,n){this._o=e,this._s=r,this._fn=n,t.call(this)}return _t(e,t),e.prototype.next=function(t){this._o.onNext(t)},e.prototype.completed=function(){return this._o.onCompleted()},e.prototype.error=function(t){var e=x(this._fn)(t);if(e===k)return this._o.onError(e.e);E(e)&&(e=Re(e));var r=new Rt;this._s.setDisposable(r),r.setDisposable(e.subscribe(this._o))},e}(de);pe.catch=function(t){return S(t)?new sr(this,t):ur([this,t])};var ur=ye.catch=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var r=0;r<e;r++)t[r]=arguments[r]}return Oe(t).catchError()};function cr(){return!1}function hr(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e}pe.combineLatest=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Array.isArray(e[0])?e[0].unshift(this):e.unshift(this),pr.apply(this,e)};var fr=function(t){function e(e,r){this._params=e,this._cb=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){for(var e=this._params.length,r=new Array(e),n={hasValue:St(e,cr),hasValueAll:!1,isDone:St(e,cr),values:new Array(e)},i=0;i<e;i++){var o=this._params[i],s=new Rt;r[i]=s,E(o)&&(o=Re(o)),s.setDisposable(o.subscribe(new lr(t,i,this._cb,n)))}return new Ft(r)},e}(me),lr=function(t){function e(e,r,n,i){this._o=e,this._i=r,this._cb=n,this._state=i,t.call(this)}return _t(e,t),e.prototype.next=function(t){if(this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll||(this._state.hasValueAll=this._state.hasValue.every(g))){var e=x(this._cb).apply(null,this._state.values);if(e===k)return this._o.onError(e.e);this._o.onNext(e)}else this._state.isDone.filter((r=this._i,function(t,e){return e!==r})).every(g)&&this._o.onCompleted();var r},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._state.isDone[this._i]=!0,this._state.isDone.every(g)&&this._o.onCompleted()},e}(de),pr=ye.combineLatest=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=S(e[t-1])?e.pop():hr;return Array.isArray(e[0])&&(e=e[0]),new fr(e,n)};pe.concat=function(){for(var t=[],e=0,r=arguments.length;e<r;e++)t.push(arguments[e]);return t.unshift(this),gr.apply(null,t)};var dr=function(t){function e(e,r){this._s=e,this._fn=r,t.call(this)}return _t(e,t),e.prototype.next=function(t){this._s.o.onNext(t)},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.i++,this._fn(this._s)},e}(de),br=function(t){function e(e){this._sources=e,t.call(this)}function r(t,e){if(!t.disposable.isDisposed){if(t.i===t.sources.length)return t.o.onCompleted();var r=t.sources[t.i];E(r)&&(r=Re(r));var n=new Rt;t.subscription.setDisposable(n),n.setDisposable(r.subscribe(new dr(t,e)))}}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Mt,n=xt(b),i={o:t,i:0,subscription:e,disposable:n,sources:this._sources},o=Kt.scheduleRecursive(i,r);return new Ft([e,n,o])},e}(me),gr=ye.concat=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(arguments.length);for(var e=0,r=arguments.length;e<r;e++)t[e]=arguments[e]}return new br(t)};pe.concatAll=function(){return this.merge(1)};var vr=function(t){function e(e,r){this.source=e,this.maxConcurrent=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new It;return e.add(this.source.subscribe(new yr(t,this.maxConcurrent,e))),e},e}(me),yr=function(t){function e(e,r,n){this.o=e,this.max=r,this.g=n,this.done=!1,this.q=[],this.activeCount=0,t.call(this)}function r(e,r){this.parent=e,this.sad=r,t.call(this)}return _t(e,t),e.prototype.handleSubscribe=function(t){var e=new Rt;this.g.add(e),E(t)&&(t=Re(t)),e.setDisposable(t.subscribe(new r(this,e)))},e.prototype.next=function(t){this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(t)):this.q.push(t)},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.done=!0,0===this.activeCount&&this.o.onCompleted()},_t(r,t),r.prototype.next=function(t){this.parent.o.onNext(t)},r.prototype.error=function(t){this.parent.o.onError(t)},r.prototype.completed=function(){this.parent.g.remove(this.sad),this.parent.q.length>0?this.parent.handleSubscribe(this.parent.q.shift()):(this.parent.activeCount--,this.parent.done&&0===this.parent.activeCount&&this.parent.o.onCompleted())},e}(de);pe.merge=function(t){return"number"!=typeof t?mr(this,t):new vr(this,t)};var mr=ye.merge=function(){var t,e,r=[],n=arguments.length;if(arguments[0])if(zt(arguments[0]))for(t=arguments[0],e=1;e<n;e++)r.push(arguments[e]);else for(t=Kt,e=0;e<n;e++)r.push(arguments[e]);else for(t=Kt,e=1;e<n;e++)r.push(arguments[e]);return Array.isArray(r[0])&&(r=r[0]),Je(t,r).mergeAll()},_r=d.CompositeError=function(t){this.innerErrors=t,this.message="This contains multiple errors. Check the innerErrors",Error.call(this)};_r.prototype=Object.create(Error.prototype),_r.prototype.name="CompositeError";var wr=function(t){function e(e){this.source=e,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new It,r=new Rt,n={isStopped:!1,errors:[],o:t};return e.add(r),r.setDisposable(this.source.subscribe(new Er(e,n))),e},e}(me),Er=function(t){function e(e,r){this._group=e,this._state=r,t.call(this)}function r(t,e){0===e.length?t.onCompleted():1===e.length?t.onError(e[0]):t.onError(new _r(e))}function n(e,r,n){this._inner=e,this._group=r,this._state=n,t.call(this)}return _t(e,t),e.prototype.next=function(t){var e=new Rt;this._group.add(e),E(t)&&(t=Re(t)),e.setDisposable(t.subscribe(new n(e,this._group,this._state)))},e.prototype.error=function(t){this._state.errors.push(t),this._state.isStopped=!0,1===this._group.length&&r(this._state.o,this._state.errors)},e.prototype.completed=function(){this._state.isStopped=!0,1===this._group.length&&r(this._state.o,this._state.errors)},_t(n,t),n.prototype.next=function(t){this._state.o.onNext(t)},n.prototype.error=function(t){this._state.errors.push(t),this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&r(this._state.o,this._state.errors)},n.prototype.completed=function(){this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&r(this._state.o,this._state.errors)},e}(de);ye.mergeDelayError=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var r=0;r<e;r++)t[r]=arguments[r]}var n=Je(null,t);return new wr(n)};var Sr=function(t){function e(e){this.source=e,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new It,r=new Rt;return e.add(r),r.setDisposable(this.source.subscribe(new Ir(t,e))),e},e}(me),Ir=function(t){function e(e,r){this.o=e,this.g=r,this.done=!1,t.call(this)}function r(e,r){this.parent=e,this.sad=r,t.call(this)}return _t(e,t),e.prototype.next=function(t){var e=new Rt;this.g.add(e),E(t)&&(t=Re(t)),e.setDisposable(t.subscribe(new r(this,e)))},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.done=!0,1===this.g.length&&this.o.onCompleted()},_t(r,t),r.prototype.next=function(t){this.parent.o.onNext(t)},r.prototype.error=function(t){this.parent.o.onError(t)},r.prototype.completed=function(){this.parent.g.remove(this.sad),this.parent.done&&1===this.parent.g.length&&this.parent.o.onCompleted()},e}(de);pe.mergeAll=function(){return new Sr(this)},pe.onErrorResumeNext=function(t){if(!t)throw new Error("Second observable is required");return xr([this,t])};var Tr=function(t){function e(e){this.sources=e,t.call(this)}function r(t,e){if(t.pos<t.sources.length){var r=t.sources[t.pos++];E(r)&&(r=Re(r));var n=new Rt;t.subscription.setDisposable(n),n.setDisposable(r.subscribe(new kr(t,e)))}else t.o.onCompleted()}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Mt,n={pos:0,subscription:e,o:t,sources:this.sources},i=Kt.scheduleRecursive(n,r);return new Nt(e,i)},e}(me),kr=function(t){function e(e,r){this._state=e,this._recurse=r,t.call(this)}return _t(e,t),e.prototype.next=function(t){this._state.o.onNext(t)},e.prototype.error=function(){this._recurse(this._state)},e.prototype.completed=function(){this._recurse(this._state)},e}(de),xr=ye.onErrorResumeNext=function(){var t=[];if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var r=0;r<e;r++)t[r]=arguments[r]}return new Tr(t)},Or=function(t){function e(e,r){this._s=e,this._o=E(r)?Re(r):r,this._open=!1,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Rt;e.setDisposable(this._s.subscribe(new Cr(t,this))),E(this._o)&&(this._o=Re(this._o));var r=new Rt;return r.setDisposable(this._o.subscribe(new Dr(t,this,r))),new Nt(e,r)},e}(me),Cr=function(t){function e(e,r){this._o=e,this._p=r,t.call(this)}return _t(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._p._open&&this._o.onCompleted()},e}(de),Dr=function(t){function e(e,r,n){this._o=e,this._p=r,this._r=n,t.call(this)}return _t(e,t),e.prototype.next=function(){this._p._open=!0,this._r.dispose()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._r.dispose()},e}(de);pe.skipUntil=function(t){return new Or(this,t)};var Ar=function(t){function e(e){this.source=e,t.call(this)}function r(t,e){this.o=t,this.inner=e,this.stopped=!1,this.latest=0,this.hasLatest=!1,de.call(this)}function n(t,e){this.parent=t,this.id=e,de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){var e=new Mt,n=this.source.subscribe(new r(t,e));return new Nt(n,e)},_t(r,de),r.prototype.next=function(t){var e=new Rt,r=++this.latest;this.hasLatest=!0,this.inner.setDisposable(e),E(t)&&(t=Re(t)),e.setDisposable(t.subscribe(new n(this,r)))},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.stopped=!0,!this.hasLatest&&this.o.onCompleted()},_t(n,de),n.prototype.next=function(t){this.parent.latest===this.id&&this.parent.o.onNext(t)},n.prototype.error=function(t){this.parent.latest===this.id&&this.parent.o.onError(t)},n.prototype.completed=function(){this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.stopped&&this.parent.o.onCompleted())},e}(me);pe.switch=pe.switchLatest=function(){return new Ar(this)};var Rr=function(t){function e(e,r){this.source=e,this.other=E(r)?Re(r):r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return new Nt(this.source.subscribe(t),this.other.subscribe(new Mr(t)))},e}(me),Mr=function(t){function e(e){this._o=e,t.call(this)}return _t(e,t),e.prototype.next=function(){this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=b,e}(de);function cr(){return!1}function hr(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e}pe.takeUntil=function(t){return new Rr(this,t)};var Nr=function(t){function e(e,r,n){this._s=e,this._ss=r,this._cb=n,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){for(var e=this._ss.length,r={hasValue:St(e,cr),hasValueAll:!1,values:new Array(e)},n=this._ss.length,i=new Array(n+1),o=0;o<n;o++){var s=this._ss[o],a=new Rt;E(s)&&(s=Re(s)),a.setDisposable(s.subscribe(new Fr(t,o,r))),i[o]=a}var u=new Rt;return u.setDisposable(this._s.subscribe(new Pr(t,this._cb,r))),i[n]=u,new Ft(i)},e}(me),Fr=function(t){function e(e,r,n){this._o=e,this._i=r,this._state=n,t.call(this)}return _t(e,t),e.prototype.next=function(t){this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll=this._state.hasValue.every(g)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=b,e}(de),Pr=function(t){function e(e,r,n){this._o=e,this._cb=r,this._state=n,t.call(this)}return _t(e,t),e.prototype.next=function(t){var e=[t].concat(this._state.values);if(this._state.hasValueAll){var r=x(this._cb).apply(null,e);if(r===k)return this._o.onError(r.e);this._o.onNext(r)}},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(de);function cr(){return!1}function Ur(){return[]}pe.withLatestFrom=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=S(e[t-1])?e.pop():hr;return Array.isArray(e[0])&&(e=e[0]),new Nr(this,e,n)};var Lr=function(t){function e(e,r){this._s=e,this._cb=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){for(var e=this._s.length,r=new Array(e),n=St(e,cr),i=St(e,Ur),o=0;o<e;o++){var s=this._s[o],a=new Rt;r[o]=a,E(s)&&(s=Re(s)),a.setDisposable(s.subscribe(new jr(t,o,this,i,n)))}return new Ft(r)},e}(me),jr=function(t){function e(e,r,n,i,o){this._o=e,this._i=r,this._p=n,this._q=i,this._d=o,t.call(this)}function r(t){return t.length>0}function n(t){return t.shift()}return _t(e,t),e.prototype.next=function(t){if(this._q[this._i].push(t),this._q.every(r)){var e=this._q.map(n),i=x(this._p._cb).apply(null,e);if(i===k)return this._o.onError(i.e);this._o.onNext(i)}else this._d.filter((o=this._i,function(t,e){return e!==o})).every(g)&&this._o.onCompleted();var o},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._d[this._i]=!0,this._d.every(g)&&this._o.onCompleted()},e}(de);function cr(){return!1}function Ur(){return[]}function hr(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e}pe.zip=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=S(e[t-1])?e.pop():hr;Array.isArray(e[0])&&(e=e[0]);var i=this;return e.unshift(i),new Lr(e,n)},ye.zip=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];Array.isArray(e[0])&&(e=S(e[1])?e[0].concat(e[1]):e[0]);var n=e.shift();return n.zip.apply(n,e)};var qr=function(t){function e(e,r){this.sources=e,this._cb=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){for(var e=this.sources,r=e.length,n=new Array(r),i={q:St(r,Ur),done:St(r,cr),cb:this._cb,o:t},o=0;o<r;o++)!function(t){var r=e[t],o=new Rt;(G(r)||K(r))&&(r=We(r)),n[t]=o,o.setDisposable(r.subscribe(new Br(i,t)))}(o);return new Ft(n)},e}(me),Br=function(t){function e(e,r){this._s=e,this._i=r,t.call(this)}function r(t){return t.length>0}function n(t){return t.shift()}return _t(e,t),e.prototype.next=function(t){if(this._s.q[this._i].push(t),this._s.q.every(r)){var e=this._s.q.map(n),i=x(this._s.cb).apply(null,e);if(i===k)return this._s.o.onError(i.e);this._s.o.onNext(i)}else this._s.done.filter((o=this._i,function(t,e){return e!==o})).every(g)&&this._s.o.onCompleted();var o},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.done[this._i]=!0,this._s.done.every(g)&&this._s.o.onCompleted()},e}(de);function zr(t){return t.toArray()}function Vr(t){return t.length>0}pe.zipIterable=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=S(e[t-1])?e.pop():hr,i=this;return e.unshift(i),new qr(e,n)},pe.asObservable=function(){return new Sn((t=this,function(e){return t.subscribe(e)}),this);var t},pe.bufferWithCount=pe.bufferCount=function(t,e){return"number"!=typeof e&&(e=t),this.windowWithCount(t,e).flatMap(zr).filter(Vr)};var Wr=function(t){function e(e){this.source=e,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Hr(t))},e}(me),Hr=function(t){function e(e){this._o=e,t.call(this)}return _t(e,t),e.prototype.next=function(t){t.accept(this._o)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(de);pe.dematerialize=function(){return new Wr(this)};var Kr=function(t){function e(e,r,n){this.source=e,this.keyFn=r,this.comparer=n,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Gr(t,this.keyFn,this.comparer))},e}(me),Gr=function(t){function e(e,r,n){this.o=e,this.keyFn=r,this.comparer=n,this.hasCurrentKey=!1,this.currentKey=null,t.call(this)}return _t(e,t),e.prototype.next=function(t){var e,r=t;return S(this.keyFn)&&(r=x(this.keyFn)(t))===k?this.o.onError(r.e):this.hasCurrentKey&&(e=x(this.comparer)(this.currentKey,r))===k?this.o.onError(e.e):void(this.hasCurrentKey&&e||(this.hasCurrentKey=!0,this.currentKey=r,this.o.onNext(t)))},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.o.onCompleted()},e}(de);pe.distinctUntilChanged=function(t,e){return e||(e=y),new Kr(this,t,e)};var Xr=function(t){function e(e,r,n,i){this.source=e,this._oN=r,this._oE=n,this._oC=i,t.call(this)}function r(t,e){this.o=t,this.t=!e._oN||S(e._oN)?le(e._oN||b,e._oE||b,e._oC||b):e._oN,this.isStopped=!1,de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this))},_t(r,de),r.prototype.next=function(t){var e=x(this.t.onNext).call(this.t,t);e===k&&this.o.onError(e.e),this.o.onNext(t)},r.prototype.error=function(t){var e=x(this.t.onError).call(this.t,t);if(e===k)return this.o.onError(e.e);this.o.onError(t)},r.prototype.completed=function(){var t=x(this.t.onCompleted).call(this.t);if(t===k)return this.o.onError(t.e);this.o.onCompleted()},e}(me);pe.do=pe.tap=pe.doAction=function(t,e,r){return new Xr(this,t,e,r)},pe.doOnNext=pe.tapOnNext=function(t,e){return this.tap(void 0!==e?function(r){t.call(e,r)}:t)},pe.doOnError=pe.tapOnError=function(t,e){return this.tap(b,void 0!==e?function(r){t.call(e,r)}:t)},pe.doOnCompleted=pe.tapOnCompleted=function(t,e){return this.tap(b,null,void 0!==e?function(){t.call(e)}:t)};var Yr=function(t){function e(e,r,n){this.source=e,this._fn=X(r,n,0),t.call(this)}function r(t,e){this.isDisposed=!1,this._s=t,this._fn=e}return _t(e,t),e.prototype.subscribeCore=function(t){var e=x(this.source.subscribe).call(this.source,t);return e===k&&(this._fn(),O(e.e)),new r(e,this._fn)},r.prototype.dispose=function(){if(!this.isDisposed){var t=x(this._s.dispose).call(this._s);this._fn(),t===k&&O(t.e)}},e}(me);pe.finally=function(t,e){return new Yr(this,t,e)};var Jr=function(t){function e(e){this.source=e,t.call(this)}function r(t){this.o=t,this.isStopped=!1}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t))},r.prototype.onNext=b,r.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},r.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},r.prototype.dispose=function(){this.isStopped=!0},r.prototype.fail=function(t){return!this.isStopped&&(this.isStopped=!0,this.observer.onError(t),!0)},e}(me);pe.ignoreElements=function(){return new Jr(this)};var $r=function(t){function e(e,r){this.source=e,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Qr(t))},e}(me),Qr=function(t){function e(e){this._o=e,t.call(this)}return _t(e,t),e.prototype.next=function(t){this._o.onNext(ue(t))},e.prototype.error=function(t){this._o.onNext(ce(t)),this._o.onCompleted()},e.prototype.completed=function(){this._o.onNext(he()),this._o.onCompleted()},e}(de);function Zr(t){return{"@@iterator":function(){return{next:function(){return{done:!1,value:t}}}}}}pe.materialize=function(){return new $r(this)},pe.repeat=function(t){return ke(this,t).concat()},pe.retry=function(t){return ke(this,t).catchError()};var tn=function(t){function e(t){return{isDisposed:!1,dispose:function(){this.isDisposed||(this.isDisposed=!0,t.isDisposed=!0)}}}function r(e,r){this.source=e,this._notifier=r,t.call(this)}return _t(r,t),r.prototype.subscribeCore=function(t){var r=new kn,n=new kn,i=this._notifier(r).subscribe(n),o=this.source["@@iterator"](),s={isDisposed:!1},a=new Mt,u=Xt.scheduleRecursive(null,(function(e,i){if(!s.isDisposed){var u=o.next();if(u.done)t.onCompleted();else{var c=u.value;E(c)&&(c=Re(c));var h=new Rt,f=new Rt;a.setDisposable(new Nt(f,h)),h.setDisposable(c.subscribe((function(e){t.onNext(e)}),(function(e){f.setDisposable(n.subscribe(i,(function(e){t.onError(e)}),(function(){t.onCompleted()}))),r.onNext(e),h.dispose()}),(function(){t.onCompleted()})))}}}));return new Ft([i,a,u,e(s)])},r}(me);function Zr(t){return{"@@iterator":function(){return{next:function(){return{done:!1,value:t}}}}}}pe.retryWhen=function(t){return new tn(Zr(this),t)};var en=function(t){function e(t){return{isDisposed:!1,dispose:function(){this.isDisposed||(this.isDisposed=!0,t.isDisposed=!0)}}}function r(e,r){this.source=e,this._notifier=r,t.call(this)}return _t(r,t),r.prototype.subscribeCore=function(t){var r=new kn,n=new kn,i=this._notifier(r).subscribe(n),o=this.source["@@iterator"](),s={isDisposed:!1},a=new Mt,u=Xt.scheduleRecursive(null,(function(e,i){if(!s.isDisposed){var u=o.next();if(u.done)t.onCompleted();else{var c=u.value;E(c)&&(c=Re(c));var h=new Rt,f=new Rt;a.setDisposable(new Nt(f,h)),h.setDisposable(c.subscribe((function(e){t.onNext(e)}),(function(e){t.onError(e)}),(function(){f.setDisposable(n.subscribe(i,(function(e){t.onError(e)}),(function(){t.onCompleted()}))),r.onNext(null),h.dispose()})))}}}));return new Ft([i,a,u,e(s)])},r}(me);pe.repeatWhen=function(t){return new en(Zr(this),t)};var rn=function(t){function e(e,r,n,i){this.source=e,this.accumulator=r,this.hasSeed=n,this.seed=i,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new nn(t,this))},e}(me),nn=function(t){function e(e,r){this._o=e,this._p=r,this._fn=r.accumulator,this._hs=r.hasSeed,this._s=r.seed,this._ha=!1,this._a=null,this._hv=!1,this._i=0,t.call(this)}return _t(e,t),e.prototype.next=function(t){if(!this._hv&&(this._hv=!0),this._ha?this._a=x(this._fn)(this._a,t,this._i,this._p):(this._a=this._hs?x(this._fn)(this._s,t,this._i,this._p):t,this._ha=!0),this._a===k)return this._o.onError(this._a.e);this._o.onNext(this._a),this._i++},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){!this._hv&&this._hs&&this._o.onNext(this._s),this._o.onCompleted()},e}(de);pe.scan=function(){var t,e=!1,r=arguments[0];return 2===arguments.length&&(e=!0,t=arguments[1]),new rn(this,r,e,t)};var on=function(t){function e(e,r){this.source=e,this._c=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new sn(t,this._c))},e}(me),sn=function(t){function e(e,r){this._o=e,this._c=r,this._q=[],t.call(this)}return _t(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._o.onNext(this._q.shift())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(de);pe.skipLast=function(t){if(t<0)throw new q;return new on(this,t)},pe.startWith=function(){var t,e=0;arguments.length&&zt(arguments[0])?(t=arguments[0],e=1):t=Kt;for(var r=[],n=e,i=arguments.length;n<i;n++)r.push(arguments[n]);return gr.apply(null,[Ke(r,t),this])};var an=function(t){function e(e,r){this._o=e,this._c=r,this._q=[],t.call(this)}return _t(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(;this._q.length>0;)this._o.onNext(this._q.shift());this._o.onCompleted()},e}(de);pe.takeLast=function(t){if(t<0)throw new q;var e=this;return new Sn((function(r){return e.subscribe(new an(r,t))}),e)};var un=function(t){function e(e,r){this._o=e,this._c=r,this._q=[],t.call(this)}return _t(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(this._q),this._o.onCompleted()},e}(de);pe.takeLastBuffer=function(t){if(t<0)throw new q;var e=this;return new Sn((function(r){return e.subscribe(new un(r,t))}),e)},pe.windowWithCount=pe.windowCount=function(t,e){var r=this;if(+t||(t=0),Math.abs(t)===1/0&&(t=0),t<=0)throw new q;if(null==e&&(e=t),+e||(e=0),Math.abs(e)===1/0&&(e=0),e<=0)throw new q;return new Sn((function(n){var i=new Rt,o=new Pt(i),s=0,a=[];function u(){var t=new kn;a.push(t),n.onNext(Et(t,o))}return u(),i.setDisposable(r.subscribe((function(r){for(var n=0,i=a.length;n<i;n++)a[n].onNext(r);var o=s-t+1;o>=0&&o%e==0&&a.shift().onCompleted(),++s%e==0&&u()}),(function(t){for(;a.length>0;)a.shift().onError(t);n.onError(t)}),(function(){for(;a.length>0;)a.shift().onCompleted();n.onCompleted()}))),o}),r)},pe.flatMapConcat=pe.concatMap=function(t,e,r){return new _e(this,t,e,r).merge(1)},pe.concatMapObserver=pe.selectConcatObserver=function(t,e,r,n){var i=this,o=X(t,n,2),s=X(e,n,1),a=X(r,n,0);return new Sn((function(t){var e=0;return i.subscribe((function(r){var n;try{n=o(r,e++)}catch(e){return void t.onError(e)}E(n)&&(n=Re(n)),t.onNext(n)}),(function(e){var r;try{r=s(e)}catch(e){return void t.onError(e)}E(r)&&(r=Re(r)),t.onNext(r),t.onCompleted()}),(function(){var e;try{e=a()}catch(e){return void t.onError(e)}E(e)&&(e=Re(e)),t.onNext(e),t.onCompleted()}))}),this).concatAll()};var cn=function(t){function e(e,r){this._o=e,this._d=r,this._f=!1,t.call(this)}return _t(e,t),e.prototype.next=function(t){this._f=!0,this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){!this._f&&this._o.onNext(this._d),this._o.onCompleted()},e}(de);function hn(t){this.comparer=t,this.set=[]}pe.defaultIfEmpty=function(t){var e=this;return t===r&&(t=null),new Sn((function(r){return e.subscribe(new cn(r,t))}),e)},hn.prototype.push=function(t){var e=-1===function(t,e,r){for(var n=0,i=t.length;n<i;n++)if(r(t[n],e))return n;return-1}(this.set,t,this.comparer);return e&&this.set.push(t),e};var fn=function(t){function e(e,r,n){this.source=e,this._keyFn=r,this._cmpFn=n,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new ln(t,this._keyFn,this._cmpFn))},e}(me),ln=function(t){function e(e,r,n){this._o=e,this._keyFn=r,this._h=new hn(n),t.call(this)}return _t(e,t),e.prototype.next=function(t){var e=t;if(S(this._keyFn)&&(e=x(this._keyFn)(t))===k)return this._o.onError(e.e);this._h.push(e)&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(de);pe.distinct=function(t,e){return e||(e=y),new fn(this,t,e)};var pn=function(t){function e(e,r,n){this.source=e,this.selector=X(r,n,3),t.call(this)}function r(t,e,r){this.o=t,this.selector=e,this.source=r,this.i=0,de.call(this)}return _t(e,t),e.prototype.internalMap=function(t,r){return new e(this.source,function(t,e){return function(r,n,i){return t.call(this,e.selector(r,n,i),n,i)}}(t,this),r)},e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.selector,this))},_t(r,de),r.prototype.next=function(t){var e=x(this.selector)(t,this.i++,this.source);if(e===k)return this.o.onError(e.e);this.o.onNext(e)},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(me);function dn(t,e){return function(n){for(var i=n,o=0;o<e;o++){var s=i[t[o]];if(void 0===s)return r;i=s}return i}}pe.map=pe.select=function(t,e){var r="function"==typeof t?t:function(){return t};return this instanceof pn?this.internalMap(r,e):new pn(this,r,e)},pe.pluck=function(){var t=arguments.length,e=new Array(t);if(0===t)throw new Error("List of properties cannot be empty.");for(var r=0;r<t;r++)e[r]=arguments[r];return this.map(dn(e,t))},pe.flatMapObserver=pe.selectManyObserver=function(t,e,r,n){var i=this;return new Sn((function(o){var s=0;return i.subscribe((function(e){var r;try{r=t.call(n,e,s++)}catch(t){return void o.onError(t)}E(r)&&(r=Re(r)),o.onNext(r)}),(function(t){var r;try{r=e.call(n,t)}catch(t){return void o.onError(t)}E(r)&&(r=Re(r)),o.onNext(r),o.onCompleted()}),(function(){var t;try{t=r.call(n)}catch(t){return void o.onError(t)}E(t)&&(t=Re(t)),o.onNext(t),o.onCompleted()}))}),i).mergeAll()},pe.flatMap=pe.selectMany=pe.mergeMap=function(t,e,r){return new _e(this,t,e,r).mergeAll()},pe.flatMapLatest=pe.switchMap=function(t,e,r){return new _e(this,t,e,r).switchLatest()};var bn=function(t){function e(e,r){this.source=e,this._count=r,t.call(this)}function r(t,e){this._o=t,this._r=e,de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this._count))},_t(r,de),r.prototype.next=function(t){this._r<=0?this._o.onNext(t):this._r--},r.prototype.error=function(t){this._o.onError(t)},r.prototype.completed=function(){this._o.onCompleted()},e}(me);pe.skip=function(t){if(t<0)throw new q;return new bn(this,t)};var gn=function(t){function e(e,r){this.source=e,this._fn=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new vn(t,this))},e}(me),vn=function(t){function e(e,r){this._o=e,this._p=r,this._i=0,this._r=!1,t.call(this)}return _t(e,t),e.prototype.next=function(t){if(!this._r){var e=x(this._p._fn)(t,this._i++,this._p);if(e===k)return this._o.onError(e.e);this._r=!e}this._r&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(de);pe.skipWhile=function(t,e){var r=X(t,e,3);return new gn(this,r)};var yn=function(t){function e(e,r){this.source=e,this._count=r,t.call(this)}function r(t,e){this._o=t,this._c=e,this._r=e,de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this._count))},_t(r,de),r.prototype.next=function(t){this._r-- >0&&(this._o.onNext(t),this._r<=0&&this._o.onCompleted())},r.prototype.error=function(t){this._o.onError(t)},r.prototype.completed=function(){this._o.onCompleted()},e}(me);pe.take=function(t,e){if(t<0)throw new q;return 0===t?Ue(e):new yn(this,t)};var mn=function(t){function e(e,r){this.source=e,this._fn=r,t.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new _n(t,this))},e}(me),_n=function(t){function e(e,r){this._o=e,this._p=r,this._i=0,this._r=!0,t.call(this)}return _t(e,t),e.prototype.next=function(t){if(this._r&&(this._r=x(this._p._fn)(t,this._i++,this._p),this._r===k))return this._o.onError(this._r.e);this._r?this._o.onNext(t):this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(de);pe.takeWhile=function(t,e){var r=X(t,e,3);return new mn(this,r)};var wn=function(t){function e(e,r,n){this.source=e,this.predicate=X(r,n,3),t.call(this)}function r(t,e,r){this.o=t,this.predicate=e,this.source=r,this.i=0,de.call(this)}return _t(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.predicate,this))},e.prototype.internalFilter=function(t,r){return new e(this.source,function(t,e){return function(r,n,i){return e.predicate(r,n,i)&&t.call(this,r,n,i)}}(t,this),r)},_t(r,de),r.prototype.next=function(t){var e=x(this.predicate)(t,this.i++,this.source);if(e===k)return this.o.onError(e.e);e&&this.o.onNext(t)},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(me);pe.filter=pe.where=function(t,e){return this instanceof wn?this.internalFilter(t,e):new wn(this,t,e)};var En=function(t){function e(e,r){this._o=e,this._xform=r,t.call(this)}return _t(e,t),e.prototype.next=function(t){var e=x(this._xform["@@transducer/step"]).call(this._xform,this._o,t);e===k&&this._o.onError(e.e)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._xform["@@transducer/result"](this._o)},e}(de);pe.transduce=function(t){var e=this;return new Sn((function(r){var n=t(function(t){return{"@@transducer/init":function(){return t},"@@transducer/step":function(t,e){return t.onNext(e)},"@@transducer/result":function(t){return t.onCompleted()}}}(r));return e.subscribe(new En(r,n))}),e)};var Sn=d.AnonymousObservable=function(t){function e(t,e){var r,n=e[0],i=e[1],o=x(i.__subscribe).call(i,n);o!==k||n.fail(k.e)||O(k.e),n.setDisposable((r=o)&&S(r.dispose)?r:S(r)?xt(r):Ot)}function r(e,r){this.source=r,this.__subscribe=e,t.call(this)}return _t(r,t),r.prototype._subscribe=function(t){var r=new In(t),n=[r,this];return Xt.scheduleRequired()?Xt.schedule(n,e):e(0,n),r},r}(ye),In=function(t){function e(e){t.call(this),this.observer=e,this.m=new Rt}_t(e,t);var r=e.prototype;return r.next=function(t){var e=x(this.observer.onNext).call(this.observer,t);e===k&&(this.dispose(),O(e.e))},r.error=function(t){var e=x(this.observer.onError).call(this.observer,t);this.dispose(),e===k&&O(e.e)},r.completed=function(){var t=x(this.observer.onCompleted).call(this.observer);this.dispose(),t===k&&O(t.e)},r.setDisposable=function(t){this.m.setDisposable(t)},r.getDisposable=function(){return this.m.getDisposable()},r.dispose=function(){t.prototype.dispose.call(this),this.m.dispose()},e}(de),Tn=function(t,e){this._s=t,this._o=e};Tn.prototype.dispose=function(){if(!this._s.isDisposed&&null!==this._o){var t=this._s.observers.indexOf(this._o);this._s.observers.splice(t,1),this._o=null}};var kn=d.Subject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return _t(e,t),wt(e.prototype,fe.prototype,{_subscribe:function(t){return Dt(this),this.isStopped?this.hasError?(t.onError(this.error),Ot):(t.onCompleted(),Ot):(this.observers.push(t),new Tn(this,t))},hasObservers:function(){return Dt(this),this.observers.length>0},onCompleted:function(){if(Dt(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=I(this.observers),r=e.length;t<r;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(Dt(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;for(var e=0,r=I(this.observers),n=r.length;e<n;e++)r[e].onError(t);this.observers.length=0}},onNext:function(t){if(Dt(this),!this.isStopped)for(var e=0,r=I(this.observers),n=r.length;e<n;e++)r[e].onNext(t)},dispose:function(){this.isDisposed=!0,this.observers=null}}),e.create=function(t,e){return new xn(t,e)},e}(ye);d.AsyncSubject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return _t(e,t),wt(e.prototype,fe.prototype,{_subscribe:function(t){return Dt(this),this.isStopped?(this.hasError?t.onError(this.error):this.hasValue?(t.onNext(this.value),t.onCompleted()):t.onCompleted(),Ot):(this.observers.push(t),new Tn(this,t))},hasObservers:function(){return Dt(this),this.observers.length>0},onCompleted:function(){var t;if(Dt(this),!this.isStopped){this.isStopped=!0;var e=I(this.observers),r=e.length;if(this.hasValue)for(t=0;t<r;t++){var n=e[t];n.onNext(this.value),n.onCompleted()}else for(t=0;t<r;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(Dt(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,r=I(this.observers),n=r.length;e<n;e++)r[e].onError(t);this.observers.length=0}},onNext:function(t){Dt(this),this.isStopped||(this.value=t,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.error=null,this.value=null}}),e}(ye);var xn=d.AnonymousSubject=function(t){function e(e,r){this.observer=e,this.observable=r,t.call(this)}return _t(e,t),wt(e.prototype,fe.prototype,{_subscribe:function(t){return this.observable.subscribe(t)},onCompleted:function(){this.observer.onCompleted()},onError:function(t){this.observer.onError(t)},onNext:function(t){this.observer.onNext(t)}}),e}(ye);"function"==typeof r&&"object"==typeof r.amd&&r.amd?(l.Rx=d,r((function(){return d}))):o&&s?h?(s.exports=d).Rx=d:o.Rx=d:l.Rx=d;var On=F()}).call(p)}(j,j.exports);var q={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observable,o=i.prototype,s=r.BinaryDisposable,a=r.AnonymousObservable,u=r.internals.AbstractObserver,c=r.Disposable.empty,h=r.helpers,f=h.defaultComparer,l=h.identity,p=h.defaultSubComparer,d=h.isFunction,b=h.isPromise,g=h.isArrayLike,v=h.isIterable,y=r.internals.inherits,m=i.fromPromise,_=i.from,w=r.internals.bindCallback,E=r.EmptyError,S=r.ObservableBase,I=r.ArgumentOutOfRangeError,T={e:{}},k=r.internals.tryCatch=function(t){if(!d(t))throw new TypeError("fn must be a function");return e=t,function(){try{return e.apply(this,arguments)}catch(t){return T.e=t,T}};var e},x=function(t){function e(e,r,n){this.source=e,this._k=r,this._c=n,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new O(t,this._k,this._c))},e}(S),O=function(t){function e(e,r,n){this._o=e,this._k=r,this._c=n,this._v=null,this._hv=!1,this._l=[],t.call(this)}return y(e,t),e.prototype.next=function(t){var e=k(this._k)(t);if(e===T)return this._o.onError(e.e);var r=0;if(this._hv){if((r=k(this._c)(e,this._v))===T)return this._o.onError(r.e)}else this._hv=!0,this._v=e;r>0&&(this._v=e,this._l=[]),r>=0&&this._l.push(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(this._l),this._o.onCompleted()},e}(u);function C(t){if(0===t.length)throw new E;return t[0]}var D=function(t){function e(e,r,n,i){this.source=e,this.accumulator=r,this.hasSeed=n,this.seed=i,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new A(t,this))},e}(S),A=function(t){function e(e,r){this._o=e,this._p=r,this._fn=r.accumulator,this._hs=r.hasSeed,this._s=r.seed,this._ha=!1,this._a=null,this._hv=!1,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){if(!this._hv&&(this._hv=!0),this._ha?this._a=k(this._fn)(this._a,t,this._i,this._p):(this._a=this._hs?k(this._fn)(this._s,t,this._i,this._p):t,this._ha=!0),this._a===T)return this._o.onError(this._a.e);this._i++},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._hv&&this._o.onNext(this._a),!this._hv&&this._hs&&this._o.onNext(this._s),!this._hv&&!this._hs&&this._o.onError(new E),this._o.onCompleted()},e}(u);o.reduce=function(){var t,e=!1,r=arguments[0];return 2===arguments.length&&(e=!0,t=arguments[1]),new D(this,r,e,t)};var R=function(t){function e(e,r){this.source=e,this._fn=r,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new M(t,this._fn,this.source))},e}(S),M=function(t){function e(e,r,n){this._o=e,this._fn=r,this._s=n,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){var e=k(this._fn)(t,this._i++,this._s);if(e===T)return this._o.onError(e.e);Boolean(e)&&(this._o.onNext(!0),this._o.onCompleted())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(!1),this._o.onCompleted()},e}(u);o.some=function(t,e){var r=w(t,e,3);return new R(this,r)};var N=function(t){function e(e){this.source=e,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new F(t))},e}(S),F=function(t){function e(e){this._o=e,t.call(this)}return y(e,t),e.prototype.next=function(){this._o.onNext(!1),this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(!0),this._o.onCompleted()},e}(u);o.isEmpty=function(){return new N(this)};var P=function(t){function e(e,r){this.source=e,this._fn=r,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new U(t,this._fn,this.source))},e}(S),U=function(t){function e(e,r,n){this._o=e,this._fn=r,this._s=n,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){var e=k(this._fn)(t,this._i++,this._s);if(e===T)return this._o.onError(e.e);Boolean(e)||(this._o.onNext(!1),this._o.onCompleted())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(!0),this._o.onCompleted()},e}(u);o.every=function(t,e){var r=w(t,e,3);return new P(this,r)};var L=function(t){function e(e,r,n){var i=+n||0;Math.abs(i)===1/0&&(i=0),this.source=e,this._elem=r,this._n=i,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this._n<0?(t.onNext(!1),t.onCompleted(),c):this.source.subscribe(new j(t,this._elem,this._n))},e}(S),j=function(t){function e(e,r,n){this._o=e,this._elem=r,this._n=n,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){var e,r;this._i++>=this._n&&(e=t,r=this._elem,0===e&&0===r||e===r||isNaN(e)&&isNaN(r))&&(this._o.onNext(!0),this._o.onCompleted())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(!1),this._o.onCompleted()},e}(u);o.includes=function(t,e){return new L(this,t,e)};var q=function(t){function e(e,r){this.source=e,this._fn=r,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new B(t,this._fn,this.source))},e}(S),B=function(t){function e(e,r,n){this._o=e,this._fn=r,this._s=n,this._i=0,this._c=0,t.call(this)}return y(e,t),e.prototype.next=function(t){if(this._fn){var e=k(this._fn)(t,this._i++,this._s);if(e===T)return this._o.onError(e.e);Boolean(e)&&this._c++}else this._c++},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(this._c),this._o.onCompleted()},e}(u);o.count=function(t,e){var r=w(t,e,3);return new q(this,r)};var z=function(t){function e(e,r,n){this.source=e,this._e=r,this._n=n,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this._n<0?(t.onNext(-1),t.onCompleted(),c):this.source.subscribe(new V(t,this._e,this._n))},e}(S),V=function(t){function e(e,r,n){this._o=e,this._e=r,this._n=n,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){this._i>=this._n&&t===this._e&&(this._o.onNext(this._i),this._o.onCompleted()),this._i++},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(-1),this._o.onCompleted()},e}(u);o.indexOf=function(t,e){var r=+e||0;return Math.abs(r)===1/0&&(r=0),new z(this,t,r)};var W=function(t){function e(e,r){this.source=e,this._fn=r,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new H(t,this._fn,this.source))},e}(S),H=function(t){function e(e,r,n){this._o=e,this._fn=r,this._s=n,this._i=0,this._c=0,t.call(this)}return y(e,t),e.prototype.next=function(t){if(this._fn){var e=k(this._fn)(t,this._i++,this._s);if(e===T)return this._o.onError(e.e);this._c+=e}else this._c+=t},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onNext(this._c),this._o.onCompleted()},e}(u);o.sum=function(t,e){var r=w(t,e,3);return new W(this,r)},o.minBy=function(t,e){return e||(e=p),new x(this,t,(function(t,r){return-1*e(t,r)}))},o.min=function(t){return this.minBy(l,t).map(C)},o.maxBy=function(t,e){return e||(e=p),new x(this,t,e)},o.max=function(t){return this.maxBy(l,t).map(C)};var K=function(t){function e(e,r){this.source=e,this._fn=r,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new G(t,this._fn,this.source))},e}(S),G=function(t){function e(e,r,n){this._o=e,this._fn=r,this._s=n,this._c=0,this._t=0,t.call(this)}return y(e,t),e.prototype.next=function(t){if(this._fn){var e=k(this._fn)(t,this._c++,this._s);if(e===T)return this._o.onError(e.e);this._t+=e}else this._c++,this._t+=t},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){if(0===this._c)return this._o.onError(new E);this._o.onNext(this._t/this._c),this._o.onCompleted()},e}(u);o.average=function(t,e){var r;return d(t)&&(r=w(t,e,3)),new K(this,r)},o.sequenceEqual=function(t,e){var r=this;return e||(e=f),new a((function(n){var i=!1,o=!1,a=[],u=[],c=r.subscribe((function(t){if(u.length>0){var r=u.shift(),i=k(e)(r,t);if(i===T)return n.onError(i.e);i||(n.onNext(!1),n.onCompleted())}else o?(n.onNext(!1),n.onCompleted()):a.push(t)}),(function(t){n.onError(t)}),(function(){i=!0,0===a.length&&(u.length>0?(n.onNext(!1),n.onCompleted()):o&&(n.onNext(!0),n.onCompleted()))}));(g(t)||v(t))&&(t=_(t)),b(t)&&(t=m(t));var h=t.subscribe((function(t){if(a.length>0){var r=a.shift(),o=k(e)(r,t);if(o===T)return n.onError(o.e);o||(n.onNext(!1),n.onCompleted())}else i?(n.onNext(!1),n.onCompleted()):u.push(t)}),(function(t){n.onError(t)}),(function(){o=!0,0===u.length&&(a.length>0?(n.onNext(!1),n.onCompleted()):i&&(n.onNext(!0),n.onCompleted()))}));return new s(c,h)}),r)};var X=function(t){function e(e,r,n){this.source=e,this._i=r,this._d=n,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Y(t,this._i,this._d))},e}(S),Y=function(t){function e(e,r,n){this._o=e,this._i=r,this._d=n,t.call(this)}return y(e,t),e.prototype.next=function(t){0==this._i--&&(this._o.onNext(t),this._o.onCompleted())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._d===n?this._o.onError(new I):(this._o.onNext(this._d),this._o.onCompleted())},e}(u);o.elementAt=function(t,e){if(t<0)throw new I;return new X(this,t,e)};var J=function(t){function e(e,r,n){this._o=e,this._obj=r,this._s=n,this._i=0,this._hv=!1,this._v=null,t.call(this)}return y(e,t),e.prototype.next=function(t){var e=!1;if(this._obj.predicate){var r=k(this._obj.predicate)(t,this._i++,this._s);if(r===T)return this._o.onError(r.e);Boolean(r)&&(e=!0)}else this._obj.predicate||(e=!0);if(e){if(this._hv)return this._o.onError(new Error("Sequence contains more than one matching element"));this._hv=!0,this._v=t}},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._hv?(this._o.onNext(this._v),this._o.onCompleted()):this._obj.defaultValue===n?this._o.onError(new E):(this._o.onNext(this._obj.defaultValue),this._o.onCompleted())},e}(u);o.single=function(t,e){var r={},n=this;if(d((r="object"==typeof arguments[0]?arguments[0]:{predicate:arguments[0],thisArg:arguments[1],defaultValue:arguments[2]}).predicate)){var i=r.predicate;r.predicate=w(i,r.thisArg,3)}return new a((function(t){return n.subscribe(new J(t,r,n))}),n)};var $=function(t){function e(e,r){this.source=e,this._obj=r,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Q(t,this._obj,this.source))},e}(S),Q=function(t){function e(e,r,n){this._o=e,this._obj=r,this._s=n,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){if(this._obj.predicate){var e=k(this._obj.predicate)(t,this._i++,this._s);if(e===T)return this._o.onError(e.e);Boolean(e)&&(this._o.onNext(t),this._o.onCompleted())}else this._obj.predicate||(this._o.onNext(t),this._o.onCompleted())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._obj.defaultValue===n?this._o.onError(new E):(this._o.onNext(this._obj.defaultValue),this._o.onCompleted())},e}(u);o.first=function(){var t={};if(d((t="object"==typeof arguments[0]?arguments[0]:{predicate:arguments[0],thisArg:arguments[1],defaultValue:arguments[2]}).predicate)){var e=t.predicate;t.predicate=w(e,t.thisArg,3)}return new $(this,t)};var Z=function(t){function e(e,r){this.source=e,this._obj=r,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new tt(t,this._obj,this.source))},e}(S),tt=function(t){function e(e,r,n){this._o=e,this._obj=r,this._s=n,this._i=0,this._hv=!1,this._v=null,t.call(this)}return y(e,t),e.prototype.next=function(t){var e=!1;if(this._obj.predicate){var r=k(this._obj.predicate)(t,this._i++,this._s);if(r===T)return this._o.onError(r.e);Boolean(r)&&(e=!0)}else this._obj.predicate||(e=!0);e&&(this._hv=!0,this._v=t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._hv?(this._o.onNext(this._v),this._o.onCompleted()):this._obj.defaultValue===n?this._o.onError(new E):(this._o.onNext(this._obj.defaultValue),this._o.onCompleted())},e}(u);o.last=function(){var t={};if(d((t="object"==typeof arguments[0]?arguments[0]:{predicate:arguments[0],thisArg:arguments[1],defaultValue:arguments[2]}).predicate)){var e=t.predicate;t.predicate=w(e,t.thisArg,3)}return new Z(this,t)};var et=function(t){function e(e,r,n,i){this._o=e,this._s=r,this._cb=n,this._y=i,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){var e=k(this._cb)(t,this._i,this._s);if(e===T)return this._o.onError(e.e);e?(this._o.onNext(this._y?this._i:t),this._o.onCompleted()):this._i++},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._y&&this._o.onNext(-1),this._o.onCompleted()},e}(u);function rt(t,e,r,n){var i=w(e,r,3);return new a((function(e){return t.subscribe(new et(e,t,i,n))}),t)}o.find=function(t,e){return rt(this,t,e,!1)},o.findIndex=function(t,e){return rt(this,t,e,!0)};var nt=function(t){function e(e){this.source=e,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new it(t))},e}(S),it=function(e){function r(r){this._o=r,this._s=new t.Set,e.call(this)}return y(r,e),r.prototype.next=function(t){this._s.add(t)},r.prototype.error=function(t){this._o.onError(t)},r.prototype.completed=function(){this._o.onNext(this._s),this._o.onCompleted()},r}(u);o.toSet=function(){if(void 0===t.Set)throw new TypeError;return new nt(this)};var ot=function(t){function e(e,r,n){this.source=e,this._k=r,this._e=n,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new st(t,this._k,this._e))},e}(S),st=function(e){function r(r,n,i){this._o=r,this._k=n,this._e=i,this._m=new t.Map,e.call(this)}return y(r,e),r.prototype.next=function(t){var e=k(this._k)(t);if(e===T)return this._o.onError(e.e);var r=t;if(this._e&&(r=k(this._e)(t))===T)return this._o.onError(r.e);this._m.set(e,r)},r.prototype.error=function(t){this._o.onError(t)},r.prototype.completed=function(){this._o.onNext(this._m),this._o.onCompleted()},r}(u);o.toMap=function(e,r){if(void 0===t.Map)throw new TypeError;return new ot(this,e,r)};var at=function(t){function e(e,r,n){this.source=e,this._b=r,this._e=n,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new ut(t,this._b,this._e))},e}(S),ut=function(t){function e(e,r,n){this._o=e,this._b=r,this._e=n,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){this._i>=this._b&&(this._e===this._i?this._o.onCompleted():this._o.onNext(t)),this._i++},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(u);o.slice=function(t,e){var n=t||0;if(n<0)throw new r.ArgumentOutOfRangeError;if("number"==typeof e&&e<n)throw new r.ArgumentOutOfRangeError;return new at(this,n,e)};var ct=function(t){function e(e,r,n){this.source=e,this._e=r,this._n=n,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this._n<0?(t.onNext(-1),t.onCompleted(),c):this.source.subscribe(new ht(t,this._e,this._n))},e}(S),ht=function(t){function e(e,r,n){this._o=e,this._e=r,this._n=n,this._v=0,this._hv=!1,this._i=0,t.call(this)}return y(e,t),e.prototype.next=function(t){this._i>=this._n&&t===this._e&&(this._hv=!0,this._v=this._i),this._i++},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._hv?this._o.onNext(this._v):this._o.onNext(-1),this._o.onCompleted()},e}(u);return o.lastIndexOf=function(t,e){var r=+e||0;return Math.abs(r)===1/0&&(r=0),new ct(this,t,r)},r}))}(q,q.exports);var B={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observable,o=i.fromPromise,s=i.throwError,a=r.AnonymousObservable,u=r.ObservableBase,c=r.AsyncSubject;r.Disposable.create;var h=r.CompositeDisposable;r.Scheduler.immediate;var f=r.Scheduler.default,l=r.internals.inherits,p=r.Scheduler.isScheduler,d=r.helpers.isPromise,b=r.helpers.isFunction,g=r.helpers.isIterable,v=r.helpers.isArrayLike,y={e:{}},m=r.internals.tryCatch=function(t){if(!b(t))throw new TypeError("fn must be a function");return e=t,function(){try{return e.apply(this,arguments)}catch(t){return y.e=t,y}};var e};i.wrap=function(t){function e(){return i.spawn.call(this,t.apply(this,arguments))}return e.__generatorFunction__=t,e};var _=i.spawn=function(){for(var t=arguments[0],e=this,r=[],n=1,o=arguments.length;n<o;n++)r.push(arguments[n]);return new a((function(n){var o=new h;if(b(t)&&(t=t.apply(e,r)),!t||!b(t.next))return n.onNext(t),n.onCompleted();function s(e){var r=m(t.next).call(t,e);if(r===y)return n.onError(r.e);u(r)}function a(e){var r=m(t.next).call(t,e);if(r===y)return n.onError(r.e);u(r)}function u(t){if(t.done)return n.onNext(t.value),void n.onCompleted();var r=w.call(e,t.value),u=null,c=!1;i.isObservable(r)?o.add(r.subscribe((function(t){c=!0,u=t}),a,(function(){c&&s(u)}))):a(new TypeError("type not supported"))}return s(),o}))};function w(t){return t?i.isObservable(t)?t:d(t)?i.fromPromise(t):function(t){var e=t.constructor;return!!e&&("GeneratorFunction"===e.name||"GeneratorFunction"===e.displayName||T(e.prototype))}(t)||T(t)?_.call(this,t):b(t)?I.call(this,t):v(t)||g(t)?E.call(this,t):k(t)?S.call(this,t):t:t}function E(t){return i.from(t).concatMap((function(t){return i.isObservable(t)||k(t)?w.call(null,t):r.Observable.just(t)})).toArray()}function S(t){for(var e=new t.constructor,r=Object.keys(t),o=[],s=0,a=r.length;s<a;s++){var u=r[s],c=w.call(this,t[u]);c&&i.isObservable(c)?h(c,u):e[u]=t[u]}return i.forkJoin.apply(i,o).map((function(){return e}));function h(t,r){e[r]=n,o.push(t.map((function(t){e[r]=t})))}}function I(t){var e=this;return new a((function(r){t.call(e,(function(){var t=arguments[0],e=arguments[1];if(t)return r.onError(t);if(arguments.length>2){for(var n=[],i=1,o=arguments.length;i<o;i++)n.push(arguments[i]);e=n}r.onNext(e),r.onCompleted()}))}))}function T(t){return b(t.next)&&b(t.throw)}function k(t){return Object==t.constructor}i.start=function(t,e,r){return x(t,e,r)()};var x=i.toAsync=function(t,e,r){return p(r)||(r=f),function(){var n=arguments,i=new c;return r.schedule(null,(function(){var r;try{r=t.apply(e,n)}catch(t){return void i.onError(t)}i.onNext(r),i.onCompleted()})),i.asObservable()}};function O(t,e,r,n){var i=new c;return n.push(function(t,e,r){return function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];if(b(r)){if((i=m(r).apply(e,i))===y)return t.onError(i.e);t.onNext(i)}else i.length<=1?t.onNext(i[0]):t.onNext(i);t.onCompleted()}}(i,e,r)),t.apply(e,n),i.asObservable()}function C(t,e,r,n){var i=new c;return n.push(function(t,e,r){return function(){var n=arguments[0];if(n)return t.onError(n);for(var i=arguments.length,o=[],s=1;s<i;s++)o[s-1]=arguments[s];if(b(r)){if((o=m(r).apply(e,o))===y)return t.onError(o.e);t.onNext(o)}else o.length<=1?t.onNext(o[0]):t.onNext(o);t.onCompleted()}}(i,e,r)),t.apply(e,n),i.asObservable()}function D(t,e,r){this._e=t,this._n=e,this._fn=r,this._e.addEventListener(this._n,this._fn,!1),this.isDisposed=!1}function A(e,r,n){var i=new h,o=Object.prototype.toString.call(e);if(function(e){return t.StaticNodeList?e instanceof t.StaticNodeList||e instanceof t.NodeList:"[object NodeList]"===Object.prototype.toString.call(e)}(e)||"[object HTMLCollection]"===o)for(var s=0,a=e.length;s<a;s++)i.add(A(e.item(s),r,n));else e&&i.add(new D(e,r,n));return i}i.fromCallback=function(t,e,r){return function(){void 0===e&&(e=this);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return O(t,e,r,i)}},i.fromNodeCallback=function(t,e,r){return function(){void 0===e&&(e=this);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return C(t,e,r,i)}},D.prototype.dispose=function(){this.isDisposed||(this._e.removeEventListener(this._n,this._fn,!1),this.isDisposed=!0)},r.config.useNativeEvents=!1;var R=function(t){function e(e,r,n){this._el=e,this._n=r,this._fn=n,t.call(this)}return l(e,t),e.prototype.subscribeCore=function(t){return A(this._el,this._n,function(t,e){return function(){var r=arguments[0];if(b(e)&&(r=m(e).apply(null,arguments))===y)return t.onError(r.e);t.onNext(r)}}(t,this._fn))},e}(u);i.fromEvent=function(t,e,n){return t.addListener?N((function(r){t.addListener(e,r)}),(function(r){t.removeListener(e,r)}),n):r.config.useNativeEvents||"function"!=typeof t.on||"function"!=typeof t.off?new R(t,e,n).publish().refCount():N((function(r){t.on(e,r)}),(function(r){t.off(e,r)}),n)};var M=function(t){function e(e,r,n){this._add=e,this._del=r,this._fn=n,t.call(this)}function r(t,e,r){this._del=t,this._fn=e,this._ret=r,this.isDisposed=!1}return l(e,t),e.prototype.subscribeCore=function(t){var e=function(t,e){return function(){var r=arguments[0];if(b(e)&&(r=m(e).apply(null,arguments))===y)return t.onError(r.e);t.onNext(r)}}(t,this._fn),n=this._add(e);return new r(this._del,e,n)},r.prototype.dispose=function(){this.isDisposed||(b(this._del)&&this._del(this._fn,this._ret),this.isDisposed=!0)},e}(u),N=i.fromEventPattern=function(t,e,r){return new M(t,e,r).publish().refCount()};return i.startAsync=function(t){var e=m(t)();return e===y?s(e.e):o(e)},r}))}(B,B.exports);var z={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observable,o=i.prototype,s=r.AnonymousObservable,a=r.internals.AbstractObserver;r.CompositeDisposable;var u=r.BinaryDisposable,c=r.NAryDisposable,h=r.Notification,f=r.Subject,l=r.Observer,p=r.Disposable.empty,d=r.Disposable.create,b=r.internals.inherits,g=r.internals.addProperties,v=r.Scheduler.default,y=r.Scheduler.currentThread,m=r.helpers.identity,_=r.Scheduler.isScheduler,w=r.helpers.isFunction;r.Disposable.checkDisposed;var E={e:{}},S=r.internals.tryCatch=function(t){if(!w(t))throw new TypeError("fn must be a function");return e=t,function(){try{return e.apply(this,arguments)}catch(t){return E.e=t,E}};var e};r.Pauser=function(t){function e(){t.call(this)}return b(e,t),e.prototype.pause=function(){this.onNext(!1)},e.prototype.resume=function(){this.onNext(!0)},e}(f);var I=function(t){function e(e,r){this.source=e,this.controller=new f,this.paused=!0,r&&r.subscribe?this.pauser=this.controller.merge(r):this.pauser=this.controller,t.call(this)}return b(e,t),e.prototype._subscribe=function(t){var e=this.source.publish(),r=e.subscribe(t),n=p,i=this.pauser.startWith(!this.paused).distinctUntilChanged().subscribe((function(t){t?n=e.connect():(n.dispose(),n=p)}));return new c([r,n,i])},e.prototype.pause=function(){this.paused=!0,this.controller.onNext(!1)},e.prototype.resume=function(){this.paused=!1,this.controller.onNext(!0)},e}(i);o.pausable=function(t){return new I(this,t)};var T=function(t){function e(e,r){this.source=e,this.controller=new f,this.paused=!0,r&&r.subscribe?this.pauser=this.controller.merge(r):this.pauser=this.controller,t.call(this)}return b(e,t),e.prototype._subscribe=function(t){var e,r,i,o,a=[];function c(){for(;a.length>0;)t.onNext(a.shift())}return(r=this.source,i=this.pauser.startWith(!this.paused).distinctUntilChanged(),o=function(t,e){return{data:t,shouldFire:e}},new s((function(t){var e,n=[!1,!1],s=!1,a=!1,c=new Array(2);function h(r,i){if(c[i]=r,n[i]=!0,s||(s=n.every(m))){if(e)return t.onError(e);var u=S(o).apply(null,c);if(u===E)return t.onError(u.e);t.onNext(u)}a&&c[1]&&t.onCompleted()}return new u(r.subscribe((function(t){h(t,0)}),(function(r){c[1]?t.onError(r):e=r}),(function(){a=!0,c[1]&&t.onCompleted()})),i.subscribe((function(t){h(t,1)}),(function(e){t.onError(e)}),(function(){a=!0,h(!0,1)})))}),r)).subscribe((function(r){e!==n&&r.shouldFire!==e?(e=r.shouldFire,r.shouldFire&&c()):(e=r.shouldFire,r.shouldFire?t.onNext(r.data):a.push(r.data))}),(function(e){c(),t.onError(e)}),(function(){c(),t.onCompleted()}))},e.prototype.pause=function(){this.paused=!0,this.controller.onNext(!1)},e.prototype.resume=function(){this.paused=!1,this.controller.onNext(!0)},e}(i);o.pausableBuffered=function(t){return new T(this,t)};var k=function(t){function e(e,r,n){t.call(this),this.subject=new x(r,n),this.source=e.multicast(this.subject).refCount()}return b(e,t),e.prototype._subscribe=function(t){return this.source.subscribe(t)},e.prototype.request=function(t){return this.subject.request(null==t?-1:t)},e}(i),x=function(t){function e(e,r){null==e&&(e=!0),t.call(this),this.subject=new f,this.enableQueue=e,this.queue=e?[]:null,this.requestedCount=0,this.requestedDisposable=null,this.error=null,this.hasFailed=!1,this.hasCompleted=!1,this.scheduler=r||y}return b(e,t),g(e.prototype,l,{_subscribe:function(t){return this.subject.subscribe(t)},onCompleted:function(){this.hasCompleted=!0,this.enableQueue&&0!==this.queue.length?this.queue.push(h.createOnCompleted()):(this.subject.onCompleted(),this.disposeCurrentRequest())},onError:function(t){this.hasFailed=!0,this.error=t,this.enableQueue&&0!==this.queue.length?this.queue.push(h.createOnError(t)):(this.subject.onError(t),this.disposeCurrentRequest())},onNext:function(t){this.requestedCount<=0?this.enableQueue&&this.queue.push(h.createOnNext(t)):(0==this.requestedCount--&&this.disposeCurrentRequest(),this.subject.onNext(t))},_processRequest:function(t){if(this.enableQueue)for(;this.queue.length>0&&(t>0||"N"!==this.queue[0].kind);){var e=this.queue.shift();e.accept(this.subject),"N"===e.kind?t--:(this.disposeCurrentRequest(),this.queue=[])}return t},request:function(t){this.disposeCurrentRequest();var e=this;return this.requestedDisposable=this.scheduler.schedule(t,(function(t,r){var n=e._processRequest(r);if(!e.hasCompleted&&!e.hasFailed&&n>0)return e.requestedCount=n,d((function(){e.requestedCount=0}))})),this.requestedDisposable},disposeCurrentRequest:function(){this.requestedDisposable&&(this.requestedDisposable.dispose(),this.requestedDisposable=null)}}),e}(i);o.controlled=function(t,e){return t&&_(t)&&(e=t,t=!0),null==t&&(t=!0),new k(this,t,e)};var O=function(t){function e(e){t.call(this),this.source=e}function r(t,e){return e.source.request(1)}b(e,t),e.prototype._subscribe=function(t){return this.subscription=this.source.subscribe(new n(t,this,this.subscription)),new u(this.subscription,v.schedule(this,r))};var n=function(t){function e(e,r,n){t.call(this),this.observer=e,this.observable=r,this.cancel=n,this.scheduleDisposable=null}function r(t,e){return e.observable.source.request(1)}return b(e,t),e.prototype.completed=function(){this.observer.onCompleted(),this.dispose()},e.prototype.error=function(t){this.observer.onError(t),this.dispose()},e.prototype.next=function(t){this.observer.onNext(t),this.scheduleDisposable=v.schedule(this,r)},e.dispose=function(){this.observer=null,this.cancel&&(this.cancel.dispose(),this.cancel=null),this.scheduleDisposable&&(this.scheduleDisposable.dispose(),this.scheduleDisposable=null),t.prototype.dispose.call(this)},e}(a);return e}(i);k.prototype.stopAndWait=function(){return new O(this)};var C=function(t){function e(e,r){t.call(this),this.source=e,this.windowSize=r}function r(t,e){return e.source.request(e.windowSize)}b(e,t),e.prototype._subscribe=function(t){return this.subscription=this.source.subscribe(new n(t,this,this.subscription)),new u(this.subscription,v.schedule(this,r))};var n=function(t){function e(e,r,n){this.observer=e,this.observable=r,this.cancel=n,this.received=0,this.scheduleDisposable=null,t.call(this)}function r(t,e){return e.observable.source.request(e.observable.windowSize)}return b(e,t),e.prototype.completed=function(){this.observer.onCompleted(),this.dispose()},e.prototype.error=function(t){this.observer.onError(t),this.dispose()},e.prototype.next=function(t){this.observer.onNext(t),this.received=++this.received%this.observable.windowSize,0===this.received&&(this.scheduleDisposable=v.schedule(this,r))},e.prototype.dispose=function(){this.observer=null,this.cancel&&(this.cancel.dispose(),this.cancel=null),this.scheduleDisposable&&(this.scheduleDisposable.dispose(),this.scheduleDisposable=null),t.prototype.dispose.call(this)},e}(a);return e}(i);return k.prototype.windowed=function(t){return new C(this,t)},o.pipe=function(t){var e=this.pausableBuffered();function r(){e.resume()}return t.addListener("drain",r),e.subscribe((function(r){!t.write(r)&&e.pause()}),(function(e){t.emit("error",e)}),(function(){!t._isStdio&&t.end(),t.removeListener("drain",r)})),e.resume(),t},r}))}(z,z.exports);var V={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observable,o=i.prototype,s=r.AnonymousObservable,a=r.ObservableBase,u=r.Subject,c=r.AsyncSubject,h=r.Observer,f=r.internals.ScheduledObserver,l=r.Disposable.create,p=r.Disposable.empty,d=r.BinaryDisposable,b=r.Scheduler.currentThread,g=r.helpers.isFunction,v=r.internals.inherits,y=r.internals.addProperties,m=r.Disposable.checkDisposed;function _(t){for(var e=t.length,r=new Array(e),n=0;n<e;n++)r[n]=t[n];return r}var w=function(t){function e(e,r,n){this.source=e,this._fn1=r,this._fn2=n,t.call(this)}return v(e,t),e.prototype.subscribeCore=function(t){var e=this.source.multicast(this._fn1());return new d(this._fn2(e).subscribe(t),e.connect())},e}(a);o.multicast=function(t,e){return g(t)?new w(this,t,e):new k(this,t)},o.publish=function(t){return t&&g(t)?this.multicast((function(){return new u}),t):this.multicast(new u)},o.share=function(){return this.publish().refCount()},o.publishLast=function(t){return t&&g(t)?this.multicast((function(){return new c}),t):this.multicast(new c)},o.publishValue=function(t,e){return 2===arguments.length?this.multicast((function(){return new S(e)}),t):this.multicast(new S(t))},o.shareValue=function(t){return this.publishValue(t).refCount()},o.replay=function(t,e,r,n){return t&&g(t)?this.multicast((function(){return new I(e,r,n)}),t):this.multicast(new I(e,r,n))},o.shareReplay=function(t,e,r){return this.replay(null,t,e,r).refCount()};var E=function(t,e){this._s=t,this._o=e};E.prototype.dispose=function(){if(!this._s.isDisposed&&null!==this._o){var t=this._s.observers.indexOf(this._o);this._s.observers.splice(t,1),this._o=null}};var S=r.BehaviorSubject=function(t){function e(e){t.call(this),this.value=e,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return v(e,t),y(e.prototype,h.prototype,{_subscribe:function(t){return m(this),this.isStopped?(this.hasError?t.onError(this.error):t.onCompleted(),p):(this.observers.push(t),t.onNext(this.value),new E(this,t))},getValue:function(){return m(this),this.hasError&&thrower(this.error),this.value},hasObservers:function(){return m(this),this.observers.length>0},onCompleted:function(){if(m(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=_(this.observers),r=e.length;t<r;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(m(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,r=_(this.observers),n=r.length;e<n;e++)r[e].onError(t);this.observers.length=0}},onNext:function(t){if(m(this),!this.isStopped){this.value=t;for(var e=0,r=_(this.observers),n=r.length;e<n;e++)r[e].onNext(t)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.error=null}}),e}(i),I=r.ReplaySubject=function(t){var e=Math.pow(2,53)-1;function r(r,n,i){this.bufferSize=null==r?e:r,this.windowSize=null==n?e:n,this.scheduler=i||b,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,t.call(this)}return v(r,t),y(r.prototype,h.prototype,{_subscribe:function(t){m(this);var e,r,n=new f(this.scheduler,t),i=(e=this,r=n,l((function(){r.dispose(),!e.isDisposed&&e.observers.splice(e.observers.indexOf(r),1)})));this._trim(this.scheduler.now()),this.observers.push(n);for(var o=0,s=this.q.length;o<s;o++)n.onNext(this.q[o].value);return this.hasError?n.onError(this.error):this.isStopped&&n.onCompleted(),n.ensureActive(),i},hasObservers:function(){return m(this),this.observers.length>0},_trim:function(t){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&t-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(t){if(m(this),!this.isStopped){var e=this.scheduler.now();this.q.push({interval:e,value:t}),this._trim(e);for(var r=0,n=_(this.observers),i=n.length;r<i;r++){var o=n[r];o.onNext(t),o.ensureActive()}}},onError:function(t){if(m(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;var e=this.scheduler.now();this._trim(e);for(var r=0,n=_(this.observers),i=n.length;r<i;r++){var o=n[r];o.onError(t),o.ensureActive()}this.observers.length=0}},onCompleted:function(){if(m(this),!this.isStopped){this.isStopped=!0;var t=this.scheduler.now();this._trim(t);for(var e=0,r=_(this.observers),n=r.length;e<n;e++){var i=r[e];i.onCompleted(),i.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),r}(i),T=function(t){function e(e){this.source=e,this._count=0,this._connectableSubscription=null,t.call(this)}function r(t,e){this._p=t,this._s=e,this.isDisposed=!1}return v(e,t),e.prototype.subscribeCore=function(t){var e=this.source.subscribe(t);return 1==++this._count&&(this._connectableSubscription=this.source.connect()),new r(this,e)},r.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.dispose(),0==--this._p._count&&this._p._connectableSubscription.dispose())},e}(a),k=r.ConnectableObservable=function(t){function e(e,r){this.source=e,this._connection=null,this._source=e.asObservable(),this._subject=r,t.call(this)}function r(t,e){this._p=t,this._s=e}return v(e,t),r.prototype.dispose=function(){this._s&&(this._s.dispose(),this._s=null,this._p._connection=null)},e.prototype.connect=function(){if(!this._connection){if(this._subject.isStopped)return p;var t=this._source.subscribe(this._subject);this._connection=new r(this,t)}return this._connection},e.prototype._subscribe=function(t){return this._subject.subscribe(t)},e.prototype.refCount=function(){return new T(this)},e}(i);return o.singleInstance=function(){var t,e=this,r=!1;return new s((function(n){return(r||(r=!0,t=e.finally((function(){r=!1})).publish().refCount()),t).subscribe(n)}))},r}))}(V,V.exports);var W={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observable,o=r.ObservableBase,s=r.internals.AbstractObserver,a=r.CompositeDisposable,u=r.BinaryDisposable,c=r.RefCountDisposable,h=r.SingleAssignmentDisposable,f=r.SerialDisposable,l=r.Subject,p=i.prototype,d=i.empty,b=i.never,g=r.AnonymousObservable,v=r.internals.addRef,y=r.internals.inherits,m=r.internals.bindCallback,_=r.helpers.noop,w=r.helpers.isPromise,E=r.helpers.isFunction,S=i.fromPromise,I={e:{}},T=r.internals.tryCatch=function(t){if(!E(t))throw new TypeError("fn must be a function");return e=t,function(){try{return e.apply(this,arguments)}catch(t){return I.e=t,I}};var e},k=t.Map||function(){function t(){this.size=0,this._values=[],this._keys=[]}return t.prototype.delete=function(t){var e=this._keys.indexOf(t);return-1!==e&&(this._values.splice(e,1),this._keys.splice(e,1),this.size--,!0)},t.prototype.get=function(t){var e=this._keys.indexOf(t);return-1===e?n:this._values[e]},t.prototype.set=function(t,e){var r=this._keys.indexOf(t);return-1===r?(this._keys.push(t),this._values.push(e),this.size++):this._values[r]=e,this},t.prototype.forEach=function(t,e){for(var r=0;r<this.size;r++)t.call(e,this._values[r],this._keys[r])},t}();function x(t){return t.toArray()}function O(t,e){return t.groupJoin(this,e,d,(function(t,e){return e}))}function C(t){var e=this;return new g((function(r){var n=new l,i=new a,o=new c(i);return r.onNext(v(n,o)),i.add(e.subscribe((function(t){n.onNext(t)}),(function(t){n.onError(t),r.onError(t)}),(function(){n.onCompleted(),r.onCompleted()}))),w(t)&&(t=S(t)),i.add(t.subscribe((function(t){n.onCompleted(),n=new l,r.onNext(v(n,o))}),(function(t){n.onError(t),r.onError(t)}),(function(){n.onCompleted(),r.onCompleted()}))),o}),e)}function D(t){var e=this;return new g((function(r){var n=new f,i=new a(n),o=new c(i),s=new l;return r.onNext(v(s,o)),i.add(e.subscribe((function(t){s.onNext(t)}),(function(t){s.onError(t),r.onError(t)}),(function(){s.onCompleted(),r.onCompleted()}))),function e(){var i;try{i=t()}catch(t){return void r.onError(t)}w(i)&&(i=S(i));var a=new h;n.setDisposable(a),a.setDisposable(i.take(1).subscribe(_,(function(t){s.onError(t),r.onError(t)}),(function(){s.onCompleted(),s=new l,r.onNext(v(s,o)),e()})))}(),o}),e)}p.join=function(t,e,r,n){var i=this;return new g((function(o){var s=new a,u=!1,c=!1,f=0,l=0,p=new k,d=new k,b=function(t){o.onError(t)};return s.add(i.subscribe((function(t){var r=f++,i=new h;p.set(r,t),s.add(i);var a=T(e)(t);if(a===I)return o.onError(a.e);i.setDisposable(a.take(1).subscribe(_,b,(function(){p.delete(r)&&0===p.size&&u&&o.onCompleted(),s.remove(i)}))),d.forEach((function(e){var r=T(n)(t,e);if(r===I)return o.onError(r.e);o.onNext(r)}))}),b,(function(){u=!0,(c||0===p.size)&&o.onCompleted()}))),s.add(t.subscribe((function(t){var e=l++,i=new h;d.set(e,t),s.add(i);var a=T(r)(t);if(a===I)return o.onError(a.e);i.setDisposable(a.take(1).subscribe(_,b,(function(){d.delete(e)&&0===d.size&&c&&o.onCompleted(),s.remove(i)}))),p.forEach((function(e){var r=T(n)(e,t);if(r===I)return o.onError(r.e);o.onNext(r)}))}),b,(function(){c=!0,(u||0===d.size)&&o.onCompleted()}))),s}),i)},p.groupJoin=function(t,e,r,n){var i=this;return new g((function(o){var s=new a,u=new c(s),f=new k,p=new k,d=0,b=0,g=function(t){return function(e){e.onError(t)}};function g(t){}return s.add(i.subscribe((function(t){var r=new l,i=d++;f.set(i,r);var a=T(n)(t,v(r,u));if(a===I)return f.forEach(g(a.e)),o.onError(a.e);o.onNext(a),p.forEach((function(t){r.onNext(t)}));var c=new h;s.add(c);var b=T(e)(t);if(b===I)return f.forEach(g(b.e)),o.onError(b.e);c.setDisposable(b.take(1).subscribe(_,(function(t){f.forEach(g(t)),o.onError(t)}),(function(){f.delete(i)&&r.onCompleted(),s.remove(c)})))}),(function(t){f.forEach(g(t)),o.onError(t)}),(function(){o.onCompleted()}))),s.add(t.subscribe((function(t){var e=b++;p.set(e,t);var n=new h;s.add(n);var i=T(r)(t);if(i===I)return f.forEach(g(i.e)),o.onError(i.e);n.setDisposable(i.take(1).subscribe(_,(function(t){f.forEach(g(t)),o.onError(t)}),(function(){p.delete(e),s.remove(n)}))),f.forEach((function(e){e.onNext(t)}))}),(function(t){f.forEach(g(t)),o.onError(t)}))),u}),i)},p.buffer=function(){return this.window.apply(this,arguments).flatMap(x)},p.window=function(t,e){return 1===arguments.length&&"function"!=typeof arguments[0]?C.call(this,t):"function"==typeof t?D.call(this,t):O.call(this,t,e)};var A=function(t){function e(e){this.source=e,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new R(t))},e}(o),R=function(t){function e(e){this._o=e,this._p=null,this._hp=!1,t.call(this)}return y(e,t),e.prototype.next=function(t){this._hp?this._o.onNext([this._p,t]):this._hp=!0,this._p=t},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(s);p.pairwise=function(){return new A(this)},p.partition=function(t,e){var r=m(t,e,3);return[this.filter(t,e),this.filter((function(t,e,n){return!r(t,e,n)}))]},p.groupBy=function(t,e){return this.groupByUntil(t,e,b)},p.groupByUntil=function(t,e,r){var i=this;return new g((function(o){var s=new k,u=new a,f=new c(u),p=function(t){return function(e){e.onError(t)}};return u.add(i.subscribe((function(i){var a=T(t)(i);if(a===I)return s.forEach(p(a.e)),o.onError(a.e);var c=!1,d=s.get(a);if(d===n&&(d=new l,s.set(a,d),c=!0),c){var b=new N(a,d,f),g=new N(a,d),v=T(r)(g);if(v===I)return s.forEach(p(v.e)),o.onError(v.e);o.onNext(b);var y=new h;u.add(y),y.setDisposable(v.take(1).subscribe(_,(function(t){s.forEach(p(t)),o.onError(t)}),(function(){s.delete(a)&&d.onCompleted(),u.remove(y)})))}var m=i;if(E(e)&&(m=T(e)(i))===I)return s.forEach(p(m.e)),o.onError(m.e);d.onNext(m)}),(function(t){s.forEach(p(t)),o.onError(t)}),(function(){s.forEach((function(t){t.onCompleted()})),o.onCompleted()}))),f}),i)};var M=function(t){function e(e,r){this._m=e,this._u=r,t.call(this)}return y(e,t),e.prototype.subscribeCore=function(t){return new u(this._m.getDisposable(),this._u.subscribe(t))},e}(o),N=function(t){function e(e,r,n){t.call(this),this.key=e,this.underlyingObservable=n?new M(n,r):r}return y(e,t),e.prototype._subscribe=function(t){return this.underlyingObservable.subscribe(t)},e}(i);return r}))}(W,W.exports);var H={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observable,o=i.prototype,s=r.ObservableBase,a=r.internals.AbstractObserver,u=r.FlatMapObservable,c=i.concat,h=i.defer,f=i.empty,l=r.Disposable.empty,p=r.CompositeDisposable,d=r.SerialDisposable,b=r.SingleAssignmentDisposable,g=r.internals.Enumerable,v=g.of,y=r.Scheduler.currentThread,m=r.AsyncSubject,_=r.Observer,w=r.internals.inherits,E=r.internals.addProperties,S=r.helpers,I=S.noop,T=S.isPromise,k=S.isFunction;r.helpers.isIterable,r.helpers.isArrayLike;var x=r.Scheduler.isScheduler,O=i.fromPromise,C={e:{}},D=r.internals.tryCatch=function(t){if(!k(t))throw new TypeError("fn must be a function");return e=t,function(){try{return e.apply(this,arguments)}catch(t){return C.e=t,C}};var e},A="function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_";t.Set&&"function"==typeof(new t.Set)["@@iterator"]&&(A="@@iterator"),r.doneEnumerator={done:!0,value:n},r.helpers.isIterable=function(t){return t&&t[A]!==n},r.helpers.isArrayLike=function(t){return t&&t.length!==n},r.helpers.iterator=A;var R=function(t){function e(t,e){this.c=t,this.s=e}return w(e,t),e.prototype[A]=function(){var t=this;return{next:function(){return t.c()?{done:!1,value:t.s}:{done:!0,value:void 0}}}},e}(g);o.letBind=o.let=function(t){return t(this)},i.if=function(t,e,r){return h((function(){return r||(r=f()),T(e)&&(e=O(e)),T(r)&&(r=O(r)),"function"==typeof r.now&&(r=f(r)),t()?e:r}))},i.for=i.forIn=function(t,e,r){return v(t,e,r).concat()};var M=i.while=i.whileDo=function(t,e){return T(e)&&(e=O(e)),function(t,e){return new R(t,e)}(t,e).concat()};o.doWhile=function(t){return c([this,M(t,this)])},i.case=function(t,e,r){return h((function(){T(r)&&(r=O(r)),r||(r=f()),x(r)&&(r=f(r));var n=e[t()];return T(n)&&(n=O(n)),n||r}))};var N=function(t){function e(e,r,n){this.source=e,this._fn=r,this._scheduler=n,t.call(this)}function r(t,e){var r,n=t[0],i=t[1];if(n.q.length>0){r=n.q.shift();var o=new b;n.d.add(o),o.setDisposable(r.subscribe(new F(n,i,o))),e([n,i])}else n.isAcquired=!1}return w(e,t),e.prototype._ensureActive=function(t){var e=!1;t.q.length>0&&(e=!t.isAcquired,t.isAcquired=!0),e&&t.m.setDisposable(this._scheduler.scheduleRecursive([t,this],r))},e.prototype.subscribeCore=function(t){var e=new d,r=new p(e),n={q:[],m:e,d:r,activeCount:0,isAcquired:!1,o:t};return n.q.push(this.source),n.activeCount++,this._ensureActive(n),r},e}(s),F=function(t){function e(e,r,n){this._s=e,this._p=r,this._m1=n,t.call(this)}return w(e,t),e.prototype.next=function(t){this._s.o.onNext(t);var e=D(this._p._fn)(t);if(e===C)return this._s.o.onError(e.e);this._s.q.push(e),this._s.activeCount++,this._p._ensureActive(this._s)},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.d.remove(this._m1),this._s.activeCount--,0===this._s.activeCount&&this._s.o.onCompleted()},e}(a);function P(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e}o.expand=function(t,e){return x(e)||(e=y),new N(this,t,e)};var U=function(t){function e(e,r){this._sources=e,this._cb=r,t.call(this)}return w(e,t),e.prototype.subscribeCore=function(t){if(0===this._sources.length)return t.onCompleted(),l;for(var e=this._sources.length,r={finished:!1,hasResults:new Array(e),hasCompleted:new Array(e),results:new Array(e)},n=new p,i=0,o=this._sources.length;i<o;i++){var s=this._sources[i];T(s)&&(s=O(s)),n.add(s.subscribe(new L(t,r,i,this._cb,n)))}return n},e}(s),L=function(t){function e(e,r,n,i,o){this._o=e,this._s=r,this._i=n,this._cb=i,this._subs=o,t.call(this)}return w(e,t),e.prototype.next=function(t){this._s.finished||(this._s.hasResults[this._i]=!0,this._s.results[this._i]=t)},e.prototype.error=function(t){this._s.finished=!0,this._o.onError(t),this._subs.dispose()},e.prototype.completed=function(){if(!this._s.finished){if(!this._s.hasResults[this._i])return this._o.onCompleted();this._s.hasCompleted[this._i]=!0;for(var t=0;t<this._s.results.length;t++)if(!this._s.hasCompleted[t])return;this._s.finished=!0;var e=D(this._cb).apply(null,this._s.results);if(e===C)return this._o.onError(e.e);this._o.onNext(e),this._o.onCompleted()}},e}(a);i.forkJoin=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=k(e[t-1])?e.pop():P;return Array.isArray(e[0])&&(e=e[0]),new U(e,n)},o.forkJoin=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Array.isArray(e[0])?e[0].unshift(this):e.unshift(this),i.forkJoin.apply(null,e)},o.manySelect=o.extend=function(t,e){x(e)||(e=r.Scheduler.immediate);var n=this;return h((function(){var r;return n.map((function(t){var e=new j(t);return r&&r.onNext(t),r=e,e})).tap(I,(function(t){r&&r.onError(t)}),(function(){r&&r.onCompleted()})).observeOn(e).map(t)}),n)};var j=function(t){function e(e){t.call(this),this.head=e,this.tail=new m}return w(e,t),E(e.prototype,_,{_subscribe:function(t){var e=new p;return e.add(y.schedule(this,(function(r,n){t.onNext(n.head),e.add(n.tail.mergeAll().subscribe(t))}))),e},onCompleted:function(){this.onNext(i.empty())},onError:function(t){this.onNext(i.throw(t))},onNext:function(t){this.tail.onNext(t),this.tail.onCompleted()}}),e}(i),q=function(t){function e(e){this.source=e,t.call(this)}return w(e,t),e.prototype.subscribeCore=function(t){var e=new b,r=new p,n={hasCurrent:!1,isStopped:!1,o:t,g:r};return r.add(e),e.setDisposable(this.source.subscribe(new B(n))),r},e}(s),B=function(t){function e(e){this._s=e,t.call(this)}function r(e,r){this._s=e,this._i=r,t.call(this)}return w(e,t),e.prototype.next=function(t){if(!this._s.hasCurrent){this._s.hasCurrent=!0,T(t)&&(t=O(t));var e=new b;this._s.g.add(e),e.setDisposable(t.subscribe(new r(this._s,e)))}},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.isStopped=!0,!this._s.hasCurrent&&1===this._s.g.length&&this._s.o.onCompleted()},w(r,t),r.prototype.next=function(t){this._s.o.onNext(t)},r.prototype.error=function(t){this._s.o.onError(t)},r.prototype.completed=function(){this._s.g.remove(this._i),this._s.hasCurrent=!1,this._s.isStopped&&1===this._s.g.length&&this._s.o.onCompleted()},e}(a);return o.switchFirst=function(){return new q(this)},o.flatMapFirst=o.exhaustMap=function(t,e,r){return new u(this,t,e,r).switchFirst()},o.flatMapWithMaxConcurrent=o.flatMapMaxConcurrent=function(t,e,r,n){return new u(this,e,r,n).merge(t)},r}))}(H,H.exports);var K={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observable,o=i.prototype,s=r.AnonymousObservable,a=i.throwError,u=r.Observer.create,c=r.SingleAssignmentDisposable,h=r.CompositeDisposable,f=r.internals.AbstractObserver,l=r.helpers.noop,p=r.internals.inherits,d=r.helpers.isFunction,b={e:{}},g=r.internals.tryCatch=function(t){if(!d(t))throw new TypeError("fn must be a function");return e=t,function(){try{return e.apply(this,arguments)}catch(t){return b.e=t,b}};var e},v=t.Map||function(){function t(){this.size=0,this._values=[],this._keys=[]}return t.prototype.delete=function(t){var e=this._keys.indexOf(t);return-1!==e&&(this._values.splice(e,1),this._keys.splice(e,1),this.size--,!0)},t.prototype.get=function(t){var e=this._keys.indexOf(t);return-1===e?n:this._values[e]},t.prototype.set=function(t,e){var r=this._keys.indexOf(t);return-1===r?(this._keys.push(t),this._values.push(e),this.size++):this._values[r]=e,this},t.prototype.forEach=function(t,e){for(var r=0;r<this.size;r++)t.call(e,this._values[r],this._keys[r])},t}();function y(t){this.patterns=t}function m(t,e){this.expression=t,this.selector=e}function _(t,e,r){var n=t.get(e);if(!n){var i=new E(e,r);return t.set(e,i),i}return n}function w(t,e,r){this.joinObserverArray=t,this.onNext=e,this.onCompleted=r,this.joinObservers=new v;for(var n=0,i=this.joinObserverArray.length;n<i;n++){var o=this.joinObserverArray[n];this.joinObservers.set(o,o)}}y.prototype.and=function(t){return new y(this.patterns.concat(t))},y.prototype.thenDo=function(t){return new m(this,t)},m.prototype.activate=function(t,e,r){for(var n,i=[],o=(n=e,function(t){n.onError(t)}),s=0,a=this.expression.patterns.length;s<a;s++)i.push(_(t,this.expression.patterns[s],o));var u=new w(i,function(t,e){return function(){var r=g(t.selector).apply(t,arguments);if(r===b)return e.onError(r.e);e.onNext(r)}}(this,e),(function(){for(var t=0,e=i.length;t<e;t++)i[t].removeActivePlan(u);r(u)}));for(s=0,a=i.length;s<a;s++)i[s].addActivePlan(u);return u},w.prototype.dequeue=function(){this.joinObservers.forEach((function(t){t.queue.shift()}))},w.prototype.match=function(){var t,e,r=!0;for(t=0,e=this.joinObserverArray.length;t<e;t++)if(0===this.joinObserverArray[t].queue.length){r=!1;break}if(r){var n=[],i=!1;for(t=0,e=this.joinObserverArray.length;t<e;t++)n.push(this.joinObserverArray[t].queue[0]),"C"===this.joinObserverArray[t].queue[0].kind&&(i=!0);if(i)this.onCompleted();else{this.dequeue();var o=[];for(t=0,e=n.length;t<n.length;t++)o.push(n[t].value);this.onNext.apply(this,o)}}};var E=function(t){function e(e,r){t.call(this),this.source=e,this.onError=r,this.queue=[],this.activePlans=[],this.subscription=new c,this.isDisposed=!1}p(e,t);var r=e.prototype;return r.next=function(t){if(!this.isDisposed){if("E"===t.kind)return this.onError(t.error);this.queue.push(t);for(var e=this.activePlans.slice(0),r=0,n=e.length;r<n;r++)e[r].match()}},r.error=l,r.completed=l,r.addActivePlan=function(t){this.activePlans.push(t)},r.subscribe=function(){this.subscription.setDisposable(this.source.materialize().subscribe(this))},r.removeActivePlan=function(t){this.activePlans.splice(this.activePlans.indexOf(t),1),0===this.activePlans.length&&this.dispose()},r.dispose=function(){t.prototype.dispose.call(this),this.isDisposed||(this.isDisposed=!0,this.subscription.dispose())},e}(f);return o.and=function(t){return new y([this,t])},o.thenDo=function(t){return new y([this]).thenDo(t)},i.when=function(){var t,e=arguments.length;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(e);for(var r=0;r<e;r++)t[r]=arguments[r]}return new s((function(e){var r=[],n=new v,i=u((function(t){e.onNext(t)}),(function(t){n.forEach((function(e){e.onError(t)})),e.onError(t)}),(function(t){e.onCompleted()}));try{for(var o=0,s=t.length;o<s;o++)r.push(t[o].activate(n,i,(function(t){var n=r.indexOf(t);r.splice(n,1),0===r.length&&e.onCompleted()})))}catch(t){return a(t).subscribe(e)}var c=new h;return n.forEach((function(t){t.subscribe(),c.add(t)})),c}))},r}))}(K,K.exports);var G={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observable,o=i.prototype,s=r.AnonymousObservable,a=i.never,u=r.internals.isEqual,c=r.helpers.defaultSubComparer;return o.jortSort=function(){return this.jortSortUntil(a())},o.jortSortUntil=function(t){var e=this;return new s((function(r){var n=[];return e.takeUntil(t).subscribe(n.push.bind(n),r.onError.bind(r),(function(){var t=n.slice(0).sort(c);r.onNext(u(n,t)),r.onCompleted()}))}),e)},r}))}(G,G.exports);var X={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Scheduler,o=r.internals.ScheduledItem,s=r.internals.SchedulePeriodicRecursive,a=r.internals.PriorityQueue,u=r.internals.inherits,c=r.helpers.defaultSubComparer,h=r.helpers.notImplemented;return r.VirtualTimeScheduler=function(t){function e(e,r){this.clock=e,this.comparer=r,this.isEnabled=!1,this.queue=new a(1024),t.call(this)}u(e,t);var r=e.prototype;return r.now=function(){return this.toAbsoluteTime(this.clock)},r.schedule=function(t,e){return this.scheduleAbsolute(t,this.clock,e)},r.scheduleFuture=function(t,e,r){var n=e instanceof Date?this.toRelativeTime(e-this.now()):this.toRelativeTime(e);return this.scheduleRelative(t,n,r)},r.add=h,r.toAbsoluteTime=h,r.toRelativeTime=h,r.schedulePeriodic=function(t,e,r){return new s(this,t,e,r).start()},r.scheduleRelative=function(t,e,r){var n=this.add(this.clock,e);return this.scheduleAbsolute(t,n,r)},r.start=function(){if(!this.isEnabled){this.isEnabled=!0;do{var t=this.getNext();null!==t?(this.comparer(t.dueTime,this.clock)>0&&(this.clock=t.dueTime),t.invoke()):this.isEnabled=!1}while(this.isEnabled)}},r.stop=function(){this.isEnabled=!1},r.advanceTo=function(t){var e=this.comparer(this.clock,t);if(this.comparer(this.clock,t)>0)throw new ArgumentOutOfRangeError;if(0!==e&&!this.isEnabled){this.isEnabled=!0;do{var r=this.getNext();null!==r&&this.comparer(r.dueTime,t)<=0?(this.comparer(r.dueTime,this.clock)>0&&(this.clock=r.dueTime),r.invoke()):this.isEnabled=!1}while(this.isEnabled);this.clock=t}},r.advanceBy=function(t){var e=this.add(this.clock,t),r=this.comparer(this.clock,e);if(r>0)throw new ArgumentOutOfRangeError;0!==r&&this.advanceTo(e)},r.sleep=function(t){var e=this.add(this.clock,t);if(this.comparer(this.clock,e)>=0)throw new ArgumentOutOfRangeError;this.clock=e},r.getNext=function(){for(;this.queue.length>0;){var t=this.queue.peek();if(!t.isCancelled())return t;this.queue.dequeue()}return null},r.scheduleAbsolute=function(t,e,r){var n=this,i=new o(this,t,(function(t,e){return n.queue.remove(i),r(t,e)}),e,this.comparer);return this.queue.enqueue(i),i.disposable},e}(i),r.HistoricalScheduler=function(t){function e(e,r){var n=null==e?0:e,i=r||c;t.call(this,n,i)}u(e,t);var r=e.prototype;return r.add=function(t,e){return t+e},r.toAbsoluteTime=function(t){return new Date(t).getTime()},r.toRelativeTime=function(t){return t},e}(r.VirtualTimeScheduler),r}))}(X,X.exports);var Y={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.Observer,o=r.Observable,s=r.Notification,a=r.VirtualTimeScheduler,u=r.Disposable,c=u.empty,h=u.create,f=r.CompositeDisposable,l=r.internals.inherits,p=r.internals.isEqual;function d(t){this.predicate=t}function b(t){this.predicate=t}d.prototype.equals=function(t){return t===this||null!=t&&"N"===t.kind&&this.predicate(t.value)},b.prototype.equals=function(t){return t===this||null!=t&&"E"===t.kind&&this.predicate(t.error)};var g=r.ReactiveTest={created:100,subscribed:200,disposed:1e3,onNext:function(t,e){return new v(t,"function"==typeof e?new d(e):s.createOnNext(e))},onError:function(t,e){return new v(t,"function"==typeof e?new b(e):s.createOnError(e))},onCompleted:function(t){return new v(t,s.createOnCompleted())},subscribe:function(t,e){return new y(t,e)}},v=r.Recorded=function(t,e,r){this.time=t,this.value=e,this.comparer=r||p};v.prototype.equals=function(t){return this.time===t.time&&this.comparer(this.value,t.value)},v.prototype.toString=function(){return this.value.toString()+"@"+this.time};var y=r.Subscription=function(t,e){this.subscribe=t,this.unsubscribe=e||Number.MAX_VALUE};y.prototype.equals=function(t){return this.subscribe===t.subscribe&&this.unsubscribe===t.unsubscribe},y.prototype.toString=function(){return"("+this.subscribe+", "+(this.unsubscribe===Number.MAX_VALUE?"Infinite":this.unsubscribe)+")"},(r.MockDisposable=function(t){this.scheduler=t,this.disposes=[],this.disposes.push(this.scheduler.clock)}).prototype.dispose=function(){this.disposes.push(this.scheduler.clock)};var m=function(t){function e(e){t.call(this),this.scheduler=e,this.messages=[]}l(e,t);var r=e.prototype;return r.onNext=function(t){this.messages.push(new v(this.scheduler.clock,s.createOnNext(t)))},r.onError=function(t){this.messages.push(new v(this.scheduler.clock,s.createOnError(t)))},r.onCompleted=function(){this.messages.push(new v(this.scheduler.clock,s.createOnCompleted()))},e}(i);function _(t,e){var r=this;this.scheduler=t,this.messages=e,this.subscriptions=[],this.observers=[];for(var n=0,i=this.messages.length;n<i;n++){var o=this.messages[n];!function(e){t.scheduleAbsolute(null,o.time,(function(){for(var t=r.observers.slice(0),n=0,i=t.length;n<i;n++)e.accept(t[n]);return c}))}(o.value)}}_.prototype.then=function(t,e){var i=this;this.subscriptions.push(new y(this.scheduler.clock));var o,s=this.subscriptions.length-1,a=r.Observer.create((function(e){var u=t(e);if(u&&"function"==typeof u.then)o=u;else{var c=i.scheduler.clock;o=new _(i.scheduler,[r.ReactiveTest.onNext(c,n),r.ReactiveTest.onCompleted(c)])}var h=i.observers.indexOf(a);i.observers.splice(h,1),i.subscriptions[s]=new y(i.subscriptions[s].subscribe,i.scheduler.clock)}),(function(t){e(t);var r=i.observers.indexOf(a);i.observers.splice(r,1),i.subscriptions[s]=new y(i.subscriptions[s].subscribe,i.scheduler.clock)}));return this.observers.push(a),o||new _(this.scheduler,this.messages)};var w=function(t){function e(e,r){t.call(this);var n,i=this;this.scheduler=e,this.messages=r,this.subscriptions=[],this.observers=[];for(var o=0,s=this.messages.length;o<s;o++)!function(t){e.scheduleAbsolute(null,n.time,(function(){for(var e=i.observers.slice(0),r=0,n=e.length;r<n;r++)t.accept(e[r]);return c}))}((n=this.messages[o]).value)}return l(e,t),e.prototype._subscribe=function(t){var e=this;this.observers.push(t),this.subscriptions.push(new y(this.scheduler.clock));var r=this.subscriptions.length-1;return h((function(){var n=e.observers.indexOf(t);e.observers.splice(n,1),e.subscriptions[r]=new y(e.subscriptions[r].subscribe,e.scheduler.clock)}))},e}(o),E=function(t){function e(e,r){t.call(this),this.scheduler=e,this.messages=r,this.subscriptions=[]}return l(e,t),e.prototype._subscribe=function(t){var e,r=this;this.subscriptions.push(new y(this.scheduler.clock));for(var n=this.subscriptions.length-1,i=new f,o=0,s=this.messages.length;o<s;o++)!function(n){i.add(r.scheduler.scheduleRelative(null,e.time,(function(){return n.accept(t),c})))}((e=this.messages[o]).value);return h((function(){r.subscriptions[n]=new y(r.subscriptions[n].subscribe,r.scheduler.clock),i.dispose()}))},e}(o);return r.TestScheduler=function(t){function e(t,e){return t>e?1:t<e?-1:0}function n(){t.call(this,0,e)}return l(n,t),n.prototype.scheduleAbsolute=function(e,r,n){return r<=this.clock&&(r=this.clock+1),t.prototype.scheduleAbsolute.call(this,e,r,n)},n.prototype.add=function(t,e){return t+e},n.prototype.toAbsoluteTime=function(t){return new Date(t).getTime()},n.prototype.toRelativeTime=function(t){return t},n.prototype.startScheduler=function(t,e){e||(e={}),null==e.created&&(e.created=g.created),null==e.subscribed&&(e.subscribed=g.subscribed),null==e.disposed&&(e.disposed=g.disposed);var r,n,i=this.createObserver();return this.scheduleAbsolute(null,e.created,(function(){return r=t(),c})),this.scheduleAbsolute(null,e.subscribed,(function(){return n=r.subscribe(i),c})),this.scheduleAbsolute(null,e.disposed,(function(){return n.dispose(),c})),this.start(),i},n.prototype.createHotObservable=function(){var t,e=arguments.length;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(e);for(var r=0;r<e;r++)t[r]=arguments[r]}return new w(this,t)},n.prototype.createColdObservable=function(){var t,e=arguments.length;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(e);for(var r=0;r<e;r++)t[r]=arguments[r]}return new E(this,t)},n.prototype.createResolvedPromise=function(t,e){return new _(this,[r.ReactiveTest.onNext(t,e),r.ReactiveTest.onCompleted(t)])},n.prototype.createRejectedPromise=function(t,e){return new _(this,[r.ReactiveTest.onError(t,e)])},n.prototype.createObserver=function(){return new m(this)},n}(a),r}))}(Y,Y.exports);var J={exports:{}};!function(t,e){(function(r){var n={function:!0,object:!0};function i(t){return t&&t.Object===Object?t:null}var o=e&&!e.nodeType?e:null,s=t&&!t.nodeType?t:null,a=i(o&&s&&"object"==typeof p&&p),u=i(n[typeof self]&&self),c=i(n[typeof window]&&window);s&&s.exports;var h=i(n[typeof this]&&this),f=a||c!==(h&&h.window)&&c||u||h||Function("return this")();t&&t.exports===o?t.exports=r(f,t.exports,j.exports):f.Rx=r(f,{},f.Rx)}).call(p,(function(t,e,r,n){var i=r.internals.inherits,o=r.internals.AbstractObserver,s=r.Observable,a=s.prototype,u=r.AnonymousObservable,c=r.ObservableBase,h=s.defer;s.empty;var f=s.never,l=s.throw;s.fromArray;var p=r.Scheduler.default,d=r.SingleAssignmentDisposable,b=r.SerialDisposable,g=r.CompositeDisposable,v=r.BinaryDisposable,y=r.RefCountDisposable,m=r.Subject,_=r.internals.addRef,w=r.Scheduler.normalize,E=r.helpers,S=E.isPromise,I=E.isFunction,T=r.Scheduler.isScheduler,k=s.fromPromise,x={e:{}},O=r.internals.tryCatch=function(t){if(!I(t))throw new TypeError("fn must be a function");return e=t,function(){try{return e.apply(this,arguments)}catch(t){return x.e=t,x}};var e},C=function(t){function e(e,r){this._dt=e,this._s=r,t.call(this)}function r(t,e){e.onNext(0),e.onCompleted()}return i(e,t),e.prototype.subscribeCore=function(t){return this._s.scheduleFuture(t,this._dt,r)},e}(c);function D(t,e,r){return new u((function(n){var i=t,o=w(e);return r.scheduleRecursiveFuture(0,i,(function(t,e){if(o>0){var s=r.now();(i=new Date(i.getTime()+o)).getTime()<=s&&(i=new Date(s+o))}n.onNext(t),e(t+1,new Date(i))}))}))}function A(t,e,r){return t===e?new u((function(t){return r.schedulePeriodic(0,e,(function(e){return t.onNext(e),e+1}))})):h((function(){return D(new Date(r.now()+t),e,r)}))}var R=s.interval=function(t,e){return A(t,t,T(e)?e:p)};function M(t,e,r){return new u((function(n){var i,o=!1,s=new b,a=null,u=[],c=!1;return i=t.materialize().timestamp(r).subscribe((function(t){var i,h;"E"===t.value.kind?((u=[]).push(t),a=t.value.error,h=!c):(u.push({value:t.value,timestamp:t.timestamp+e}),h=!o,o=!0),h&&(null!==a?n.onError(a):(i=new d,s.setDisposable(i),i.setDisposable(r.scheduleRecursiveFuture(null,e,(function(t,e){var i,s,h,f;if(null===a){c=!0;do{h=null,u.length>0&&u[0].timestamp-r.now()<=0&&(h=u.shift().value),null!==h&&h.accept(n)}while(null!==h);f=!1,s=0,u.length>0?(f=!0,s=Math.max(0,u[0].timestamp-r.now())):o=!1,c=!1,null!==(i=a)?n.onError(i):f&&e(null,s)}})))))})),new v(i,s)}),t)}function N(t,e,r){return h((function(){return M(t,e-r.now(),r)}))}function F(t,e,r){var n,i;return I(e)?i=e:(n=e,i=r),new u((function(e){var r=new g,o=!1,s=new b;function a(){s.setDisposable(t.subscribe((function(t){var n=O(i)(t);if(n===x)return e.onError(n.e);var o=new d;r.add(o),o.setDisposable(n.subscribe((function(){e.onNext(t),r.remove(o),u()}),(function(t){e.onError(t)}),(function(){e.onNext(t),r.remove(o),u()})))}),(function(t){e.onError(t)}),(function(){o=!0,s.dispose(),u()})))}function u(){o&&0===r.length&&e.onCompleted()}return n?s.setDisposable(n.subscribe(a,(function(t){e.onError(t)}),a)):a(),new v(s,r)}),t)}s.timer=function(t,e,r){var i;return T(r)||(r=p),null!=e&&"number"==typeof e?i=e:T(e)&&(r=e),(t instanceof Date||"number"==typeof t)&&i===n?function(t,e){return new C(t,e)}(t,r):t instanceof Date&&i!==n?D(t,e,r):A(t,i,r)},a.delay=function(){var t=arguments[0];if("number"==typeof t||t instanceof Date){var e=t,r=arguments[1];return T(r)||(r=p),e instanceof Date?N(this,e,r):M(this,e,r)}if(s.isObservable(t)||I(t))return F(this,t,arguments[1]);throw new Error("Invalid arguments")};var P=function(t){function e(e,r,n){T(n)||(n=p),this.source=e,this._dt=r,this._s=n,t.call(this)}return i(e,t),e.prototype.subscribeCore=function(t){var e=new b;return new v(this.source.subscribe(new U(t,this._dt,this._s,e)),e)},e}(c),U=function(t){function e(e,r,n,i){this._o=e,this._d=r,this._scheduler=n,this._c=i,this._v=null,this._hv=!1,this._id=0,t.call(this)}return i(e,t),e.prototype.next=function(t){this._hv=!0,this._v=t;var e=++this._id,r=new d;this._c.setDisposable(r),r.setDisposable(this._scheduler.scheduleFuture(this,this._d,(function(r,n){n._hv&&n._id===e&&n._o.onNext(t),n._hv=!1})))},e.prototype.error=function(t){this._c.dispose(),this._o.onError(t),this._hv=!1,this._id++},e.prototype.completed=function(){this._c.dispose(),this._hv&&this._o.onNext(this._v),this._o.onCompleted(),this._hv=!1,this._id++},e}(o);function L(t,e){return new u((function(r){var n,i=!1,o=new b,s=0,a=t.subscribe((function(t){var a=O(e)(t);if(a===x)return r.onError(a.e);S(a)&&(a=k(a)),i=!0,n=t;var u=++s,c=new d;o.setDisposable(c),c.setDisposable(a.subscribe((function(){i&&s===u&&r.onNext(n),i=!1,c.dispose()}),(function(t){r.onError(t)}),(function(){i&&s===u&&r.onNext(n),i=!1,c.dispose()})))}),(function(t){o.dispose(),r.onError(t),i=!1,s++}),(function(){o.dispose(),i&&r.onNext(n),r.onCompleted(),i=!1,s++}));return new v(a,o)}),t)}function j(t){return t.toArray()}function j(t){return t.toArray()}a.debounce=function(){if(I(arguments[0]))return L(this,arguments[0]);if("number"==typeof arguments[0])return new P(this,arguments[0],arguments[1]);throw new Error("Invalid arguments")},a.windowWithTime=a.windowTime=function(t,e,r){var n,i=this;return null==e&&(n=t),T(r)||(r=p),"number"==typeof e?n=e:T(e)&&(n=t,r=e),new u((function(e){var o,s,a=n,u=t,c=[],h=new b,f=0;return o=new g(h),s=new y(o),c.push(new m),e.onNext(_(c[0],s)),function t(){var i=new d,o=!1,l=!1;h.setDisposable(i),u===a?(o=!0,l=!0):u<a?o=!0:l=!0;var p=o?u:a,b=p-f;f=p,o&&(u+=n),l&&(a+=n),i.setDisposable(r.scheduleFuture(null,b,(function(){if(l){var r=new m;c.push(r),e.onNext(_(r,s))}o&&c.shift().onCompleted(),t()})))}(),o.add(i.subscribe((function(t){for(var e=0,r=c.length;e<r;e++)c[e].onNext(t)}),(function(t){for(var r=0,n=c.length;r<n;r++)c[r].onError(t);e.onError(t)}),(function(){for(var t=0,r=c.length;t<r;t++)c[t].onCompleted();e.onCompleted()}))),s}),i)},a.windowWithTimeOrCount=a.windowTimeOrCount=function(t,e,r){var n=this;return T(r)||(r=p),new u((function(i){var o=new b,s=new g(o),a=new y(s),u=0,c=0,h=new m;function f(e){var n=new d;o.setDisposable(n),n.setDisposable(r.scheduleFuture(null,t,(function(){if(e===c){u=0;var t=++c;h.onCompleted(),h=new m,i.onNext(_(h,a)),f(t)}})))}return i.onNext(_(h,a)),f(0),s.add(n.subscribe((function(t){var r=0,n=!1;h.onNext(t),++u===e&&(n=!0,u=0,r=++c,h.onCompleted(),h=new m,i.onNext(_(h,a))),n&&f(r)}),(function(t){h.onError(t),i.onError(t)}),(function(){h.onCompleted(),i.onCompleted()}))),a}),n)},a.bufferWithTime=a.bufferTime=function(t,e,r){return this.windowWithTime(t,e,r).flatMap(j)},a.bufferWithTimeOrCount=a.bufferTimeOrCount=function(t,e,r){return this.windowWithTimeOrCount(t,e,r).flatMap(j)};var q=function(t){function e(e,r){this.source=e,this._s=r,t.call(this)}return i(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new B(t,this._s))},e}(c),B=function(t){function e(e,r){this._o=e,this._s=r,this._l=r.now(),t.call(this)}return i(e,t),e.prototype.next=function(t){var e=this._s.now(),r=e-this._l;this._l=e,this._o.onNext({value:t,interval:r})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(o);a.timeInterval=function(t){return T(t)||(t=p),new q(this,t)};var z=function(t){function e(e,r){this.source=e,this._s=r,t.call(this)}return i(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new V(t,this._s))},e}(c),V=function(t){function e(e,r){this._o=e,this._s=r,t.call(this)}return i(e,t),e.prototype.next=function(t){this._o.onNext({value:t,timestamp:this._s.now()})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(o);a.timestamp=function(t){return T(t)||(t=p),new z(this,t)};var W=function(t){function e(e,r){this.source=e,this._sampler=r,t.call(this)}return i(e,t),e.prototype.subscribeCore=function(t){var e={o:t,atEnd:!1,value:null,hasValue:!1,sourceSubscription:new d};return e.sourceSubscription.setDisposable(this.source.subscribe(new K(e))),new v(e.sourceSubscription,this._sampler.subscribe(new H(e)))},e}(c),H=function(t){function e(e){this._s=e,t.call(this)}return i(e,t),e.prototype._handleMessage=function(){this._s.hasValue&&(this._s.hasValue=!1,this._s.o.onNext(this._s.value)),this._s.atEnd&&this._s.o.onCompleted()},e.prototype.next=function(){this._handleMessage()},e.prototype.error=function(t){this._s.onError(t)},e.prototype.completed=function(){this._handleMessage()},e}(o),K=function(t){function e(e){this._s=e,t.call(this)}return i(e,t),e.prototype.next=function(t){this._s.hasValue=!0,this._s.value=t},e.prototype.error=function(t){this._s.o.onError(t)},e.prototype.completed=function(){this._s.atEnd=!0,this._s.sourceSubscription.dispose()},e}(o);a.sample=function(t,e){return T(e)||(e=p),new W(this,"number"==typeof t?R(t,e):t)};var G=r.TimeoutError=function(t){this.message=t||"Timeout has occurred",this.name="TimeoutError",Error.call(this)};function X(t,e,r,n){return I(e)&&(n=r,r=e,e=f()),s.isObservable(n)||(n=l(new G)),new u((function(i){var o=new b,s=new b,a=new d;o.setDisposable(a);var u=0,c=!1;function h(t){var e=u,r=new d;function a(){return c=e===u}s.setDisposable(r),r.setDisposable(t.subscribe((function(){a()&&o.setDisposable(n.subscribe(i)),r.dispose()}),(function(t){a()&&i.onError(t)}),(function(){a()&&o.setDisposable(n.subscribe(i))})))}function f(){var t=!c;return t&&u++,t}return h(e),a.setDisposable(t.subscribe((function(t){if(f()){i.onNext(t);var e=O(r)(t);if(e===x)return i.onError(e.e);h(S(e)?k(e):e)}}),(function(t){f()&&i.onError(t)}),(function(){f()&&i.onCompleted()}))),new v(o,s)}),t)}function Y(t,e,r,n){return T(r)&&(n=r,r=l(new G)),r instanceof Error&&(r=l(r)),T(n)||(n=p),s.isObservable(r)||(r=l(new G)),new u((function(i){var o=0,s=new d,a=new b,u=!1,c=new b;function h(){var t=o;c.setDisposable(n.scheduleFuture(null,e,(function(){(u=o===t)&&(S(r)&&(r=k(r)),a.setDisposable(r.subscribe(i)))})))}return a.setDisposable(s),h(),s.setDisposable(t.subscribe((function(t){u||(o++,i.onNext(t),h())}),(function(t){u||(o++,i.onError(t))}),(function(){u||(o++,i.onCompleted())}))),new v(a,c)}),t)}G.prototype=Object.create(Error.prototype),a.timeout=function(){var t=arguments[0];if(t instanceof Date||"number"==typeof t)return Y(this,t,arguments[1],arguments[2]);if(s.isObservable(t)||I(t))return X(this,t,arguments[1],arguments[2]);throw new Error("Invalid arguments")};var J=function(t){function e(e,r,n,i,o,s){this._state=e,this._cndFn=r,this._itrFn=n,this._resFn=i,this._timeFn=o,this._s=s,t.call(this)}function r(t,e){if(t.hasResult&&t.o.onNext(t.result),t.first)t.first=!1;else if(t.newState=O(t.self._itrFn)(t.newState),t.newState===x)return t.o.onError(t.newState.e);if(t.hasResult=O(t.self._cndFn)(t.newState),t.hasResult===x)return t.o.onError(t.hasResult.e);if(t.hasResult){if(t.result=O(t.self._resFn)(t.newState),t.result===x)return t.o.onError(t.result.e);var r=O(t.self._timeFn)(t.newState);if(r===x)return t.o.onError(r.e);e(t,r)}else t.o.onCompleted()}return i(e,t),e.prototype.subscribeCore=function(t){var e={o:t,self:this,newState:this._state,first:!0,hasResult:!1};return this._s.scheduleRecursiveFuture(e,new Date(this._s.now()),r)},e}(c);s.generateWithAbsoluteTime=function(t,e,r,n,i,o){return T(o)||(o=p),new J(t,e,r,n,i,o)};var $=function(t){function e(e,r,n,i,o,s){this._state=e,this._cndFn=r,this._itrFn=n,this._resFn=i,this._timeFn=o,this._s=s,t.call(this)}function r(t,e){if(t.hasResult&&t.o.onNext(t.result),t.first)t.first=!1;else if(t.newState=O(t.self._itrFn)(t.newState),t.newState===x)return t.o.onError(t.newState.e);if(t.hasResult=O(t.self._cndFn)(t.newState),t.hasResult===x)return t.o.onError(t.hasResult.e);if(t.hasResult){if(t.result=O(t.self._resFn)(t.newState),t.result===x)return t.o.onError(t.result.e);var r=O(t.self._timeFn)(t.newState);if(r===x)return t.o.onError(r.e);e(t,r)}else t.o.onCompleted()}return i(e,t),e.prototype.subscribeCore=function(t){var e={o:t,self:this,newState:this._state,first:!0,hasResult:!1};return this._s.scheduleRecursiveFuture(e,0,r)},e}(c);s.generateWithRelativeTime=function(t,e,r,n,i,o){return T(o)||(o=p),new $(t,e,r,n,i,o)};var Q=function(t){function e(e,r,n){this.source=e,this._dt=r,this._s=n,t.call(this)}function r(t,e){var r=e[0],n=e[1];e[2].setDisposable(r.subscribe(n))}return i(e,t),e.prototype.subscribeCore=function(t){var e=new b;return e.setDisposable(this._s.scheduleFuture([this.source,t,e],this._dt,r)),e},e}(c);a.delaySubscription=function(t,e){return T(e)||(e=p),new Q(this,t,e)};var Z=function(t){function e(e,r,n){this.source=e,this._d=r,this._s=n,t.call(this)}return i(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new tt(t,this))},e}(c),tt=function(t){function e(e,r){this._o=e,this._s=r._s,this._d=r._d,this._q=[],t.call(this)}return i(e,t),e.prototype.next=function(t){var e=this._s.now();for(this._q.push({interval:e,value:t});this._q.length>0&&e-this._q[0].interval>=this._d;)this._o.onNext(this._q.shift().value)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(var t=this._s.now();this._q.length>0&&t-this._q[0].interval>=this._d;)this._o.onNext(this._q.shift().value);this._o.onCompleted()},e}(o);a.skipLastWithTime=function(t,e){return T(e)||(e=p),new Z(this,t,e)};var et=function(t){function e(e,r,n){this.source=e,this._d=r,this._s=n,t.call(this)}return i(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new rt(t,this._d,this._s))},e}(c),rt=function(t){function e(e,r,n){this._o=e,this._d=r,this._s=n,this._q=[],t.call(this)}return i(e,t),e.prototype.next=function(t){var e=this._s.now();for(this._q.push({interval:e,value:t});this._q.length>0&&e-this._q[0].interval>=this._d;)this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(var t=this._s.now();this._q.length>0;){var e=this._q.shift();t-e.interval<=this._d&&this._o.onNext(e.value)}this._o.onCompleted()},e}(o);a.takeLastWithTime=function(t,e){return T(e)||(e=p),new et(this,t,e)},a.takeLastBufferWithTime=function(t,e){var r=this;return T(e)||(e=p),new u((function(n){var i=[];return r.subscribe((function(r){var n=e.now();for(i.push({interval:n,value:r});i.length>0&&n-i[0].interval>=t;)i.shift()}),(function(t){n.onError(t)}),(function(){for(var r=e.now(),o=[];i.length>0;){var s=i.shift();r-s.interval<=t&&o.push(s.value)}n.onNext(o),n.onCompleted()}))}),r)};var nt=function(t){function e(e,r,n){this.source=e,this._d=r,this._s=n,t.call(this)}function r(t,e){e.onCompleted()}return i(e,t),e.prototype.subscribeCore=function(t){return new v(this._s.scheduleFuture(t,this._d,r),this.source.subscribe(t))},e}(c);a.takeWithTime=function(t,e){return T(e)||(e=p),new nt(this,t,e)};var it=function(t){function e(e,r,n){this.source=e,this._d=r,this._s=n,this._open=!1,t.call(this)}function r(t,e){e._open=!0}return i(e,t),e.prototype.subscribeCore=function(t){return new v(this._s.scheduleFuture(this,this._d,r),this.source.subscribe(new ot(t,this)))},e}(c),ot=function(t){function e(e,r){this._o=e,this._p=r,t.call(this)}return i(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(o);a.skipWithTime=function(t,e){return T(e)||(e=p),new it(this,t,e)};var st=function(t){function e(e,r,n){this.source=e,this._st=r,this._s=n,t.call(this)}function r(t,e){e._open=!0}return i(e,t),e.prototype.subscribeCore=function(t){return this._open=!1,new v(this._s.scheduleFuture(this,this._st,r),this.source.subscribe(new at(t,this)))},e}(c),at=function(t){function e(e,r){this._o=e,this._p=r,t.call(this)}return i(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(o);return a.skipUntilWithTime=function(t,e){return T(e)||(e=p),new st(this,t,e)},a.takeUntilWithTime=function(t,e){T(e)||(e=p);var r=this;return new u((function(n){return new v(e.scheduleFuture(n,t,(function(t,e){e.onCompleted()})),r.subscribe(n))}),r)},a.throttle=function(t,e){T(e)||(e=p);var r=+t||0;if(r<=0)throw new RangeError("windowDuration cannot be less or equal zero.");var n=this;return new u((function(t){var i=0;return n.subscribe((function(n){var o=e.now();(0===i||o-i>=r)&&(i=o,t.onNext(n))}),(function(e){t.onError(e)}),(function(){t.onCompleted()}))}),n)},r}))}(J,J.exports);var $=j.exports,Q={exports:{}};!function(t,e){t.exports=function(){var t=Array.prototype.slice;function e(t,e){e&&(t.prototype=Object.create(e.prototype)),t.prototype.constructor=t}function r(t){return s(t)?t:V(t)}function n(t){return a(t)?t:W(t)}function i(t){return u(t)?t:H(t)}function o(t){return s(t)&&!c(t)?t:K(t)}function s(t){return!(!t||!t[f])}function a(t){return!(!t||!t[l])}function u(t){return!(!t||!t[p])}function c(t){return a(t)||u(t)}function h(t){return!(!t||!t[d])}e(n,r),e(i,r),e(o,r),r.isIterable=s,r.isKeyed=a,r.isIndexed=u,r.isAssociative=c,r.isOrdered=h,r.Keyed=n,r.Indexed=i,r.Set=o;var f="@@__IMMUTABLE_ITERABLE__@@",l="@@__IMMUTABLE_KEYED__@@",p="@@__IMMUTABLE_INDEXED__@@",d="@@__IMMUTABLE_ORDERED__@@",b="delete",g=32,v=31,y={},m={value:!1},_={value:!1};function w(t){return t.value=!1,t}function E(t){t&&(t.value=!0)}function S(){}function I(t,e){e=e||0;for(var r=Math.max(0,t.length-e),n=new Array(r),i=0;i<r;i++)n[i]=t[i+e];return n}function T(t){return void 0===t.size&&(t.size=t.__iterate(x)),t.size}function k(t,e){if("number"!=typeof e){var r=e>>>0;if(""+r!==e||4294967295===r)return NaN;e=r}return e<0?T(t)+e:e}function x(){return!0}function O(t,e,r){return(0===t||void 0!==r&&t<=-r)&&(void 0===e||void 0!==r&&e>=r)}function C(t,e){return A(t,e,0)}function D(t,e){return A(t,e,e)}function A(t,e,r){return void 0===t?r:t<0?Math.max(0,e+t):void 0===e?t:Math.min(e,t)}var R="function"==typeof Symbol&&Symbol.iterator,M="@@iterator",N=R||M;function F(t){this.next=t}function P(t,e,r,n){var i=0===t?e:1===t?r:[e,r];return n?n.value=i:n={value:i,done:!1},n}function U(){return{value:void 0,done:!0}}function L(t){return!!B(t)}function j(t){return t&&"function"==typeof t.next}function q(t){var e=B(t);return e&&e.call(t)}function B(t){var e=t&&(R&&t[R]||t[M]);if("function"==typeof e)return e}function z(t){return t&&"number"==typeof t.length}function V(t){return null==t?rt():s(t)?t.toSeq():function(t){var e=ot(t)||"object"==typeof t&&new Q(t);if(!e)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+t);return e}(t)}function W(t){return null==t?rt().toKeyedSeq():s(t)?a(t)?t.toSeq():t.fromEntrySeq():nt(t)}function H(t){return null==t?rt():s(t)?a(t)?t.entrySeq():t.toIndexedSeq():it(t)}function K(t){return(null==t?rt():s(t)?a(t)?t.entrySeq():t:it(t)).toSetSeq()}F.prototype.toString=function(){return"[Iterator]"},F.KEYS=0,F.VALUES=1,F.ENTRIES=2,F.prototype.inspect=F.prototype.toSource=function(){return this.toString()},F.prototype[N]=function(){return this},e(V,r),V.of=function(){return V(arguments)},V.prototype.toSeq=function(){return this},V.prototype.toString=function(){return this.__toString("Seq {","}")},V.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},V.prototype.__iterate=function(t,e){return st(this,t,e,!0)},V.prototype.__iterator=function(t,e){return at(this,t,e,!0)},e(W,V),W.prototype.toKeyedSeq=function(){return this},e(H,V),H.of=function(){return H(arguments)},H.prototype.toIndexedSeq=function(){return this},H.prototype.toString=function(){return this.__toString("Seq [","]")},H.prototype.__iterate=function(t,e){return st(this,t,e,!1)},H.prototype.__iterator=function(t,e){return at(this,t,e,!1)},e(K,V),K.of=function(){return K(arguments)},K.prototype.toSetSeq=function(){return this},V.isSeq=et,V.Keyed=W,V.Set=K,V.Indexed=H;var G,X,Y,J="@@__IMMUTABLE_SEQ__@@";function $(t){this._array=t,this.size=t.length}function Q(t){var e=Object.keys(t);this._object=t,this._keys=e,this.size=e.length}function Z(t){this._iterable=t,this.size=t.length||t.size}function tt(t){this._iterator=t,this._iteratorCache=[]}function et(t){return!(!t||!t[J])}function rt(){return G||(G=new $([]))}function nt(t){var e=Array.isArray(t)?new $(t).fromEntrySeq():j(t)?new tt(t).fromEntrySeq():L(t)?new Z(t).fromEntrySeq():"object"==typeof t?new Q(t):void 0;if(!e)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+t);return e}function it(t){var e=ot(t);if(!e)throw new TypeError("Expected Array or iterable object of values: "+t);return e}function ot(t){return z(t)?new $(t):j(t)?new tt(t):L(t)?new Z(t):void 0}function st(t,e,r,n){var i=t._cache;if(i){for(var o=i.length-1,s=0;s<=o;s++){var a=i[r?o-s:s];if(!1===e(a[1],n?a[0]:s,t))return s+1}return s}return t.__iterateUncached(e,r)}function at(t,e,r,n){var i=t._cache;if(i){var o=i.length-1,s=0;return new F((function(){var t=i[r?o-s:s];return s++>o?{value:void 0,done:!0}:P(e,n?t[0]:s-1,t[1])}))}return t.__iteratorUncached(e,r)}function ut(t,e){return e?function t(e,r,n,i){return Array.isArray(r)?e.call(i,n,H(r).map((function(n,i){return t(e,n,i,r)}))):ht(r)?e.call(i,n,W(r).map((function(n,i){return t(e,n,i,r)}))):r}(e,t,"",{"":t}):ct(t)}function ct(t){return Array.isArray(t)?H(t).map(ct).toList():ht(t)?W(t).map(ct).toMap():t}function ht(t){return t&&(t.constructor===Object||void 0===t.constructor)}function ft(t,e){if(t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if((t=t.valueOf())===(e=e.valueOf())||t!=t&&e!=e)return!0;if(!t||!e)return!1}return!("function"!=typeof t.equals||"function"!=typeof e.equals||!t.equals(e))}function lt(t,e){if(t===e)return!0;if(!s(e)||void 0!==t.size&&void 0!==e.size&&t.size!==e.size||void 0!==t.__hash&&void 0!==e.__hash&&t.__hash!==e.__hash||a(t)!==a(e)||u(t)!==u(e)||h(t)!==h(e))return!1;if(0===t.size&&0===e.size)return!0;var r=!c(t);if(h(t)){var n=t.entries();return e.every((function(t,e){var i=n.next().value;return i&&ft(i[1],t)&&(r||ft(i[0],e))}))&&n.next().done}var i=!1;if(void 0===t.size)if(void 0===e.size)"function"==typeof t.cacheResult&&t.cacheResult();else{i=!0;var o=t;t=e,e=o}var f=!0,l=e.__iterate((function(e,n){if(r?!t.has(e):i?!ft(e,t.get(n,y)):!ft(t.get(n,y),e))return f=!1,!1}));return f&&t.size===l}function pt(t,e){if(!(this instanceof pt))return new pt(t,e);if(this._value=t,this.size=void 0===e?1/0:Math.max(0,e),0===this.size){if(X)return X;X=this}}function dt(t,e){if(!t)throw new Error(e)}function bt(t,e,r){if(!(this instanceof bt))return new bt(t,e,r);if(dt(0!==r,"Cannot step a Range by 0"),t=t||0,void 0===e&&(e=1/0),r=void 0===r?1:Math.abs(r),e<t&&(r=-r),this._start=t,this._end=e,this._step=r,this.size=Math.max(0,Math.ceil((e-t)/r-1)+1),0===this.size){if(Y)return Y;Y=this}}function gt(){throw TypeError("Abstract")}function vt(){}function yt(){}function mt(){}V.prototype[J]=!0,e($,H),$.prototype.get=function(t,e){return this.has(t)?this._array[k(this,t)]:e},$.prototype.__iterate=function(t,e){for(var r=this._array,n=r.length-1,i=0;i<=n;i++)if(!1===t(r[e?n-i:i],i,this))return i+1;return i},$.prototype.__iterator=function(t,e){var r=this._array,n=r.length-1,i=0;return new F((function(){return i>n?{value:void 0,done:!0}:P(t,i,r[e?n-i++:i++])}))},e(Q,W),Q.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},Q.prototype.has=function(t){return this._object.hasOwnProperty(t)},Q.prototype.__iterate=function(t,e){for(var r=this._object,n=this._keys,i=n.length-1,o=0;o<=i;o++){var s=n[e?i-o:o];if(!1===t(r[s],s,this))return o+1}return o},Q.prototype.__iterator=function(t,e){var r=this._object,n=this._keys,i=n.length-1,o=0;return new F((function(){var s=n[e?i-o:o];return o++>i?{value:void 0,done:!0}:P(t,s,r[s])}))},Q.prototype[d]=!0,e(Z,H),Z.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var r=q(this._iterable),n=0;if(j(r))for(var i;!(i=r.next()).done&&!1!==t(i.value,n++,this););return n},Z.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var r=q(this._iterable);if(!j(r))return new F(U);var n=0;return new F((function(){var e=r.next();return e.done?e:P(t,n++,e.value)}))},e(tt,H),tt.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);for(var r,n=this._iterator,i=this._iteratorCache,o=0;o<i.length;)if(!1===t(i[o],o++,this))return o;for(;!(r=n.next()).done;){var s=r.value;if(i[o]=s,!1===t(s,o++,this))break}return o},tt.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var r=this._iterator,n=this._iteratorCache,i=0;return new F((function(){if(i>=n.length){var e=r.next();if(e.done)return e;n[i]=e.value}return P(t,i,n[i++])}))},e(pt,H),pt.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},pt.prototype.get=function(t,e){return this.has(t)?this._value:e},pt.prototype.includes=function(t){return ft(this._value,t)},pt.prototype.slice=function(t,e){var r=this.size;return O(t,e,r)?this:new pt(this._value,D(e,r)-C(t,r))},pt.prototype.reverse=function(){return this},pt.prototype.indexOf=function(t){return ft(this._value,t)?0:-1},pt.prototype.lastIndexOf=function(t){return ft(this._value,t)?this.size:-1},pt.prototype.__iterate=function(t,e){for(var r=0;r<this.size;r++)if(!1===t(this._value,r,this))return r+1;return r},pt.prototype.__iterator=function(t,e){var r=this,n=0;return new F((function(){return n<r.size?P(t,n++,r._value):{value:void 0,done:!0}}))},pt.prototype.equals=function(t){return t instanceof pt?ft(this._value,t._value):lt(t)},e(bt,H),bt.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},bt.prototype.get=function(t,e){return this.has(t)?this._start+k(this,t)*this._step:e},bt.prototype.includes=function(t){var e=(t-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},bt.prototype.slice=function(t,e){return O(t,e,this.size)?this:(t=C(t,this.size),(e=D(e,this.size))<=t?new bt(0,0):new bt(this.get(t,this._end),this.get(e,this._end),this._step))},bt.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step==0){var r=e/this._step;if(r>=0&&r<this.size)return r}return-1},bt.prototype.lastIndexOf=function(t){return this.indexOf(t)},bt.prototype.__iterate=function(t,e){for(var r=this.size-1,n=this._step,i=e?this._start+r*n:this._start,o=0;o<=r;o++){if(!1===t(i,o,this))return o+1;i+=e?-n:n}return o},bt.prototype.__iterator=function(t,e){var r=this.size-1,n=this._step,i=e?this._start+r*n:this._start,o=0;return new F((function(){var s=i;return i+=e?-n:n,o>r?{value:void 0,done:!0}:P(t,o++,s)}))},bt.prototype.equals=function(t){return t instanceof bt?this._start===t._start&&this._end===t._end&&this._step===t._step:lt(this,t)},e(gt,r),e(vt,gt),e(yt,gt),e(mt,gt),gt.Keyed=vt,gt.Indexed=yt,gt.Set=mt;var _t="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){var r=65535&(t|=0),n=65535&(e|=0);return r*n+((t>>>16)*n+r*(e>>>16)<<16>>>0)|0};function wt(t){return t>>>1&1073741824|3221225471&t}function Et(t){if(!1===t||null==t)return 0;if("function"==typeof t.valueOf&&(!1===(t=t.valueOf())||null==t))return 0;if(!0===t)return 1;var e=typeof t;if("number"===e){if(t!=t||t===1/0)return 0;var r=0|t;for(r!==t&&(r^=4294967295*t);t>4294967295;)r^=t/=4294967295;return wt(r)}if("string"===e)return t.length>Dt?function(t){var e=Mt[t];return void 0===e&&(e=St(t),Rt===At&&(Rt=0,Mt={}),Rt++,Mt[t]=e),e}(t):St(t);if("function"==typeof t.hashCode)return t.hashCode();if("object"===e)return function(t){var e;if(xt&&void 0!==(e=It.get(t)))return e;if(void 0!==(e=t[Ct]))return e;if(!kt){if(void 0!==(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Ct]))return e;if(void 0!==(e=function(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}(t)))return e}if(e=++Ot,1073741824&Ot&&(Ot=0),xt)It.set(t,e);else{if(void 0!==Tt&&!1===Tt(t))throw new Error("Non-extensible objects are not allowed as keys.");if(kt)Object.defineProperty(t,Ct,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Ct]=e;else{if(void 0===t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[Ct]=e}}return e}(t);if("function"==typeof t.toString)return St(t.toString());throw new Error("Value type "+e+" cannot be hashed.")}function St(t){for(var e=0,r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return wt(e)}var It,Tt=Object.isExtensible,kt=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}(),xt="function"==typeof WeakMap;xt&&(It=new WeakMap);var Ot=0,Ct="__immutablehash__";"function"==typeof Symbol&&(Ct=Symbol(Ct));var Dt=16,At=255,Rt=0,Mt={};function Nt(t){dt(t!==1/0,"Cannot perform this action with an infinite size.")}function Ft(t){return null==t?Yt():Pt(t)&&!h(t)?t:Yt().withMutations((function(e){var r=n(t);Nt(r.size),r.forEach((function(t,r){return e.set(r,t)}))}))}function Pt(t){return!(!t||!t[Lt])}e(Ft,vt),Ft.of=function(){var e=t.call(arguments,0);return Yt().withMutations((function(t){for(var r=0;r<e.length;r+=2){if(r+1>=e.length)throw new Error("Missing value for key: "+e[r]);t.set(e[r],e[r+1])}}))},Ft.prototype.toString=function(){return this.__toString("Map {","}")},Ft.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},Ft.prototype.set=function(t,e){return Jt(this,t,e)},Ft.prototype.setIn=function(t,e){return this.updateIn(t,y,(function(){return e}))},Ft.prototype.remove=function(t){return Jt(this,t,y)},Ft.prototype.deleteIn=function(t){return this.updateIn(t,(function(){return y}))},Ft.prototype.update=function(t,e,r){return 1===arguments.length?t(this):this.updateIn([t],e,r)},Ft.prototype.updateIn=function(t,e,r){r||(r=e,e=void 0);var n=function t(e,r,n,i){var o=e===y,s=r.next();if(s.done){var a=o?n:e,u=i(a);return u===a?e:u}dt(o||e&&e.set,"invalid keyPath");var c=s.value,h=o?y:e.get(c,y),f=t(h,r,n,i);return f===h?e:f===y?e.remove(c):(o?Yt():e).set(c,f)}(this,er(t),e,r);return n===y?void 0:n},Ft.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Yt()},Ft.prototype.merge=function(){return ee(this,void 0,arguments)},Ft.prototype.mergeWith=function(e){return ee(this,e,t.call(arguments,1))},Ft.prototype.mergeIn=function(e){var r=t.call(arguments,1);return this.updateIn(e,Yt(),(function(t){return"function"==typeof t.merge?t.merge.apply(t,r):r[r.length-1]}))},Ft.prototype.mergeDeep=function(){return ee(this,re,arguments)},Ft.prototype.mergeDeepWith=function(e){var r=t.call(arguments,1);return ee(this,ne(e),r)},Ft.prototype.mergeDeepIn=function(e){var r=t.call(arguments,1);return this.updateIn(e,Yt(),(function(t){return"function"==typeof t.mergeDeep?t.mergeDeep.apply(t,r):r[r.length-1]}))},Ft.prototype.sort=function(t){return xe(We(this,t))},Ft.prototype.sortBy=function(t,e){return xe(We(this,e,t))},Ft.prototype.withMutations=function(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this},Ft.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new S)},Ft.prototype.asImmutable=function(){return this.__ensureOwner()},Ft.prototype.wasAltered=function(){return this.__altered},Ft.prototype.__iterator=function(t,e){return new Ht(this,t,e)},Ft.prototype.__iterate=function(t,e){var r=this,n=0;return this._root&&this._root.iterate((function(e){return n++,t(e[1],e[0],r)}),e),n},Ft.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Xt(this.size,this._root,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},Ft.isMap=Pt;var Ut,Lt="@@__IMMUTABLE_MAP__@@",jt=Ft.prototype;function qt(t,e){this.ownerID=t,this.entries=e}function Bt(t,e,r){this.ownerID=t,this.bitmap=e,this.nodes=r}function zt(t,e,r){this.ownerID=t,this.count=e,this.nodes=r}function Vt(t,e,r){this.ownerID=t,this.keyHash=e,this.entries=r}function Wt(t,e,r){this.ownerID=t,this.keyHash=e,this.entry=r}function Ht(t,e,r){this._type=e,this._reverse=r,this._stack=t._root&&Gt(t._root)}function Kt(t,e){return P(t,e[0],e[1])}function Gt(t,e){return{node:t,index:0,__prev:e}}function Xt(t,e,r,n){var i=Object.create(jt);return i.size=t,i._root=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function Yt(){return Ut||(Ut=Xt(0))}function Jt(t,e,r){var n,i;if(t._root){var o=w(m),s=w(_);if(n=$t(t._root,t.__ownerID,0,void 0,e,r,o,s),!s.value)return t;i=t.size+(o.value?r===y?-1:1:0)}else{if(r===y)return t;i=1,n=new qt(t.__ownerID,[[e,r]])}return t.__ownerID?(t.size=i,t._root=n,t.__hash=void 0,t.__altered=!0,t):n?Xt(i,n):Yt()}function $t(t,e,r,n,i,o,s,a){return t?t.update(e,r,n,i,o,s,a):o===y?t:(E(a),E(s),new Wt(e,n,[i,o]))}function Qt(t){return t.constructor===Wt||t.constructor===Vt}function Zt(t,e,r,n,i){if(t.keyHash===n)return new Vt(e,n,[t.entry,i]);var o,s=(0===r?t.keyHash:t.keyHash>>>r)&v,a=(0===r?n:n>>>r)&v;return new Bt(e,1<<s|1<<a,s===a?[Zt(t,e,r+5,n,i)]:(o=new Wt(e,n,i),s<a?[t,o]:[o,t]))}function te(t,e,r,n,i){for(var o=0,s=new Array(g),a=0;0!==r;a++,r>>>=1)s[a]=1&r?e[o++]:void 0;return s[n]=i,new zt(t,o+1,s)}function ee(t,e,r){for(var i=[],o=0;o<r.length;o++){var a=r[o],u=n(a);s(a)||(u=u.map((function(t){return ut(t)}))),i.push(u)}return ie(t,e,i)}function re(t,e,r){return t&&t.mergeDeep&&s(e)?t.mergeDeep(e):ft(t,e)?t:e}function ne(t){return function(e,r,n){if(e&&e.mergeDeepWith&&s(r))return e.mergeDeepWith(t,r);var i=t(e,r,n);return ft(e,i)?e:i}}function ie(t,e,r){return 0===(r=r.filter((function(t){return 0!==t.size}))).length?t:0!==t.size||t.__ownerID||1!==r.length?t.withMutations((function(t){for(var n=e?function(r,n){t.update(n,y,(function(t){return t===y?r:e(t,r,n)}))}:function(e,r){t.set(r,e)},i=0;i<r.length;i++)r[i].forEach(n)})):t.constructor(r[0])}function oe(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,127&(t+=t>>8)+(t>>16)}function se(t,e,r,n){var i=n?t:I(t);return i[e]=r,i}jt[Lt]=!0,jt[b]=jt.remove,jt.removeIn=jt.deleteIn,qt.prototype.get=function(t,e,r,n){for(var i=this.entries,o=0,s=i.length;o<s;o++)if(ft(r,i[o][0]))return i[o][1];return n},qt.prototype.update=function(t,e,r,n,i,o,s){for(var a=i===y,u=this.entries,c=0,h=u.length;c<h&&!ft(n,u[c][0]);c++);var f=c<h;if(f?u[c][1]===i:a)return this;if(E(s),(a||!f)&&E(o),!a||1!==u.length){if(!f&&!a&&u.length>=ae)return function(t,e,r,n){t||(t=new S);for(var i=new Wt(t,Et(r),[r,n]),o=0;o<e.length;o++){var s=e[o];i=i.update(t,0,void 0,s[0],s[1])}return i}(t,u,n,i);var l=t&&t===this.ownerID,p=l?u:I(u);return f?a?c===h-1?p.pop():p[c]=p.pop():p[c]=[n,i]:p.push([n,i]),l?(this.entries=p,this):new qt(t,p)}},Bt.prototype.get=function(t,e,r,n){void 0===e&&(e=Et(r));var i=1<<((0===t?e:e>>>t)&v),o=this.bitmap;return 0==(o&i)?n:this.nodes[oe(o&i-1)].get(t+5,e,r,n)},Bt.prototype.update=function(t,e,r,n,i,o,s){void 0===r&&(r=Et(n));var a=(0===e?r:r>>>e)&v,u=1<<a,c=this.bitmap,h=0!=(c&u);if(!h&&i===y)return this;var f=oe(c&u-1),l=this.nodes,p=h?l[f]:void 0,d=$t(p,t,e+5,r,n,i,o,s);if(d===p)return this;if(!h&&d&&l.length>=ue)return te(t,l,c,a,d);if(h&&!d&&2===l.length&&Qt(l[1^f]))return l[1^f];if(h&&d&&1===l.length&&Qt(d))return d;var b=t&&t===this.ownerID,g=h?d?c:c^u:c|u,m=h?d?se(l,f,d,b):function(t,e,r){var n=t.length-1;if(r&&e===n)return t.pop(),t;for(var i=new Array(n),o=0,s=0;s<n;s++)s===e&&(o=1),i[s]=t[s+o];return i}(l,f,b):function(t,e,r,n){var i=t.length+1;if(n&&e+1===i)return t[e]=r,t;for(var o=new Array(i),s=0,a=0;a<i;a++)a===e?(o[a]=r,s=-1):o[a]=t[a+s];return o}(l,f,d,b);return b?(this.bitmap=g,this.nodes=m,this):new Bt(t,g,m)},zt.prototype.get=function(t,e,r,n){void 0===e&&(e=Et(r));var i=(0===t?e:e>>>t)&v,o=this.nodes[i];return o?o.get(t+5,e,r,n):n},zt.prototype.update=function(t,e,r,n,i,o,s){void 0===r&&(r=Et(n));var a=(0===e?r:r>>>e)&v,u=i===y,c=this.nodes,h=c[a];if(u&&!h)return this;var f=$t(h,t,e+5,r,n,i,o,s);if(f===h)return this;var l=this.count;if(h){if(!f&&--l<ce)return function(t,e,r,n){for(var i=0,o=0,s=new Array(r),a=0,u=1,c=e.length;a<c;a++,u<<=1){var h=e[a];void 0!==h&&a!==n&&(i|=u,s[o++]=h)}return new Bt(t,i,s)}(t,c,l,a)}else l++;var p=t&&t===this.ownerID,d=se(c,a,f,p);return p?(this.count=l,this.nodes=d,this):new zt(t,l,d)},Vt.prototype.get=function(t,e,r,n){for(var i=this.entries,o=0,s=i.length;o<s;o++)if(ft(r,i[o][0]))return i[o][1];return n},Vt.prototype.update=function(t,e,r,n,i,o,s){void 0===r&&(r=Et(n));var a=i===y;if(r!==this.keyHash)return a?this:(E(s),E(o),Zt(this,t,e,r,[n,i]));for(var u=this.entries,c=0,h=u.length;c<h&&!ft(n,u[c][0]);c++);var f=c<h;if(f?u[c][1]===i:a)return this;if(E(s),(a||!f)&&E(o),a&&2===h)return new Wt(t,this.keyHash,u[1^c]);var l=t&&t===this.ownerID,p=l?u:I(u);return f?a?c===h-1?p.pop():p[c]=p.pop():p[c]=[n,i]:p.push([n,i]),l?(this.entries=p,this):new Vt(t,this.keyHash,p)},Wt.prototype.get=function(t,e,r,n){return ft(r,this.entry[0])?this.entry[1]:n},Wt.prototype.update=function(t,e,r,n,i,o,s){var a=i===y,u=ft(n,this.entry[0]);return(u?i===this.entry[1]:a)?this:(E(s),a?void E(o):u?t&&t===this.ownerID?(this.entry[1]=i,this):new Wt(t,this.keyHash,[n,i]):(E(o),Zt(this,t,e,Et(n),[n,i])))},qt.prototype.iterate=Vt.prototype.iterate=function(t,e){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(!1===t(r[e?i-n:n]))return!1},Bt.prototype.iterate=zt.prototype.iterate=function(t,e){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var o=r[e?i-n:n];if(o&&!1===o.iterate(t,e))return!1}},Wt.prototype.iterate=function(t,e){return t(this.entry)},e(Ht,F),Ht.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var r,n=e.node,i=e.index++;if(n.entry){if(0===i)return Kt(t,n.entry)}else if(n.entries){if(i<=(r=n.entries.length-1))return Kt(t,n.entries[this._reverse?r-i:i])}else if(i<=(r=n.nodes.length-1)){var o=n.nodes[this._reverse?r-i:i];if(o){if(o.entry)return Kt(t,o.entry);e=this._stack=Gt(o,e)}continue}e=this._stack=this._stack.__prev}return{value:void 0,done:!0}};var ae=8,ue=16,ce=8;function he(t){var e=_e();if(null==t)return e;if(fe(t))return t;var r=i(t),n=r.size;return 0===n?e:(Nt(n),n>0&&n<g?me(0,n,5,null,new de(r.toArray())):e.withMutations((function(t){t.setSize(n),r.forEach((function(e,r){return t.set(r,e)}))})))}function fe(t){return!(!t||!t[le])}e(he,yt),he.of=function(){return this(arguments)},he.prototype.toString=function(){return this.__toString("List [","]")},he.prototype.get=function(t,e){if((t=k(this,t))>=0&&t<this.size){var r=Se(this,t+=this._origin);return r&&r.array[t&v]}return e},he.prototype.set=function(t,e){return function(t,e,r){if((e=k(t,e))!=e)return t;if(e>=t.size||e<0)return t.withMutations((function(t){e<0?Ie(t,e).set(0,r):Ie(t,0,e+1).set(e,r)}));e+=t._origin;var n=t._tail,i=t._root,o=w(_);return e>=ke(t._capacity)?n=we(n,t.__ownerID,0,e,r,o):i=we(i,t.__ownerID,t._level,e,r,o),o.value?t.__ownerID?(t._root=i,t._tail=n,t.__hash=void 0,t.__altered=!0,t):me(t._origin,t._capacity,t._level,i,n):t}(this,t,e)},he.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},he.prototype.insert=function(t,e){return this.splice(t,0,e)},he.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=5,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):_e()},he.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations((function(r){Ie(r,0,e+t.length);for(var n=0;n<t.length;n++)r.set(e+n,t[n])}))},he.prototype.pop=function(){return Ie(this,0,-1)},he.prototype.unshift=function(){var t=arguments;return this.withMutations((function(e){Ie(e,-t.length);for(var r=0;r<t.length;r++)e.set(r,t[r])}))},he.prototype.shift=function(){return Ie(this,1)},he.prototype.merge=function(){return Te(this,void 0,arguments)},he.prototype.mergeWith=function(e){return Te(this,e,t.call(arguments,1))},he.prototype.mergeDeep=function(){return Te(this,re,arguments)},he.prototype.mergeDeepWith=function(e){var r=t.call(arguments,1);return Te(this,ne(e),r)},he.prototype.setSize=function(t){return Ie(this,0,t)},he.prototype.slice=function(t,e){var r=this.size;return O(t,e,r)?this:Ie(this,C(t,r),D(e,r))},he.prototype.__iterator=function(t,e){var r=0,n=ye(this,e);return new F((function(){var e=n();return e===ve?{value:void 0,done:!0}:P(t,r++,e)}))},he.prototype.__iterate=function(t,e){for(var r,n=0,i=ye(this,e);(r=i())!==ve&&!1!==t(r,n++,this););return n},he.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?me(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):(this.__ownerID=t,this)},he.isList=fe;var le="@@__IMMUTABLE_LIST__@@",pe=he.prototype;function de(t,e){this.array=t,this.ownerID=e}pe[le]=!0,pe[b]=pe.remove,pe.setIn=jt.setIn,pe.deleteIn=pe.removeIn=jt.removeIn,pe.update=jt.update,pe.updateIn=jt.updateIn,pe.mergeIn=jt.mergeIn,pe.mergeDeepIn=jt.mergeDeepIn,pe.withMutations=jt.withMutations,pe.asMutable=jt.asMutable,pe.asImmutable=jt.asImmutable,pe.wasAltered=jt.wasAltered,de.prototype.removeBefore=function(t,e,r){if(r===e?1<<e:0===this.array.length)return this;var n=r>>>e&v;if(n>=this.array.length)return new de([],t);var i,o=0===n;if(e>0){var s=this.array[n];if((i=s&&s.removeBefore(t,e-5,r))===s&&o)return this}if(o&&!i)return this;var a=Ee(this,t);if(!o)for(var u=0;u<n;u++)a.array[u]=void 0;return i&&(a.array[n]=i),a},de.prototype.removeAfter=function(t,e,r){if(r===(e?1<<e:0)||0===this.array.length)return this;var n,i=r-1>>>e&v;if(i>=this.array.length)return this;if(e>0){var o=this.array[i];if((n=o&&o.removeAfter(t,e-5,r))===o&&i===this.array.length-1)return this}var s=Ee(this,t);return s.array.splice(i+1),n&&(s.array[i]=n),s};var be,ge,ve={};function ye(t,e){var r=t._origin,n=t._capacity,i=ke(n),o=t._tail;return s(t._root,t._level,0);function s(t,e,r){return 0===e?a(t,r):u(t,e,r)}function a(t,s){var a=s===i?o&&o.array:t&&t.array,u=s>r?0:r-s,c=n-s;return c>g&&(c=g),function(){if(u===c)return ve;var t=e?--c:u++;return a&&a[t]}}function u(t,i,o){var a,u=t&&t.array,c=o>r?0:r-o>>i,h=1+(n-o>>i);return h>g&&(h=g),function(){for(;;){if(a){var t=a();if(t!==ve)return t;a=null}if(c===h)return ve;var r=e?--h:c++;a=s(u&&u[r],i-5,o+(r<<i))}}}}function me(t,e,r,n,i,o,s){var a=Object.create(pe);return a.size=e-t,a._origin=t,a._capacity=e,a._level=r,a._root=n,a._tail=i,a.__ownerID=o,a.__hash=s,a.__altered=!1,a}function _e(){return be||(be=me(0,0,5))}function we(t,e,r,n,i,o){var s,a=n>>>r&v,u=t&&a<t.array.length;if(!u&&void 0===i)return t;if(r>0){var c=t&&t.array[a],h=we(c,e,r-5,n,i,o);return h===c?t:((s=Ee(t,e)).array[a]=h,s)}return u&&t.array[a]===i?t:(E(o),s=Ee(t,e),void 0===i&&a===s.array.length-1?s.array.pop():s.array[a]=i,s)}function Ee(t,e){return e&&t&&e===t.ownerID?t:new de(t?t.array.slice():[],e)}function Se(t,e){if(e>=ke(t._capacity))return t._tail;if(e<1<<t._level+5){for(var r=t._root,n=t._level;r&&n>0;)r=r.array[e>>>n&v],n-=5;return r}}function Ie(t,e,r){void 0!==e&&(e|=0),void 0!==r&&(r|=0);var n=t.__ownerID||new S,i=t._origin,o=t._capacity,s=i+e,a=void 0===r?o:r<0?o+r:i+r;if(s===i&&a===o)return t;if(s>=a)return t.clear();for(var u=t._level,c=t._root,h=0;s+h<0;)c=new de(c&&c.array.length?[void 0,c]:[],n),h+=1<<(u+=5);h&&(s+=h,i+=h,a+=h,o+=h);for(var f=ke(o),l=ke(a);l>=1<<u+5;)c=new de(c&&c.array.length?[c]:[],n),u+=5;var p=t._tail,d=l<f?Se(t,a-1):l>f?new de([],n):p;if(p&&l>f&&s<o&&p.array.length){for(var b=c=Ee(c,n),g=u;g>5;g-=5){var y=f>>>g&v;b=b.array[y]=Ee(b.array[y],n)}b.array[f>>>5&v]=p}if(a<o&&(d=d&&d.removeAfter(n,0,a)),s>=l)s-=l,a-=l,u=5,c=null,d=d&&d.removeBefore(n,0,s);else if(s>i||l<f){for(h=0;c;){var m=s>>>u&v;if(m!==l>>>u&v)break;m&&(h+=(1<<u)*m),u-=5,c=c.array[m]}c&&s>i&&(c=c.removeBefore(n,u,s-h)),c&&l<f&&(c=c.removeAfter(n,u,l-h)),h&&(s-=h,a-=h)}return t.__ownerID?(t.size=a-s,t._origin=s,t._capacity=a,t._level=u,t._root=c,t._tail=d,t.__hash=void 0,t.__altered=!0,t):me(s,a,u,c,d)}function Te(t,e,r){for(var n=[],o=0,a=0;a<r.length;a++){var u=r[a],c=i(u);c.size>o&&(o=c.size),s(u)||(c=c.map((function(t){return ut(t)}))),n.push(c)}return o>t.size&&(t=t.setSize(o)),ie(t,e,n)}function ke(t){return t<g?0:t-1>>>5<<5}function xe(t){return null==t?De():Oe(t)?t:De().withMutations((function(e){var r=n(t);Nt(r.size),r.forEach((function(t,r){return e.set(r,t)}))}))}function Oe(t){return Pt(t)&&h(t)}function Ce(t,e,r,n){var i=Object.create(xe.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=r,i.__hash=n,i}function De(){return ge||(ge=Ce(Yt(),_e()))}function Ae(t,e,r){var n,i,o=t._map,s=t._list,a=o.get(e),u=void 0!==a;if(r===y){if(!u)return t;s.size>=g&&s.size>=2*o.size?(n=(i=s.filter((function(t,e){return void 0!==t&&a!==e}))).toKeyedSeq().map((function(t){return t[0]})).flip().toMap(),t.__ownerID&&(n.__ownerID=i.__ownerID=t.__ownerID)):(n=o.remove(e),i=a===s.size-1?s.pop():s.set(a,void 0))}else if(u){if(r===s.get(a)[1])return t;n=o,i=s.set(a,[e,r])}else n=o.set(e,s.size),i=s.set(s.size,[e,r]);return t.__ownerID?(t.size=n.size,t._map=n,t._list=i,t.__hash=void 0,t):Ce(n,i)}function Re(t,e){this._iter=t,this._useKeys=e,this.size=t.size}function Me(t){this._iter=t,this.size=t.size}function Ne(t){this._iter=t,this.size=t.size}function Fe(t){this._iter=t,this.size=t.size}function Pe(t){var e=Qe(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.includes(e)},e.includes=function(e){return t.has(e)},e.cacheResult=Ze,e.__iterateUncached=function(e,r){var n=this;return t.__iterate((function(t,r){return!1!==e(r,t,n)}),r)},e.__iteratorUncached=function(e,r){if(2===e){var n=t.__iterator(e,r);return new F((function(){var t=n.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t}))}return t.__iterator(1===e?0:1,r)},e}function Ue(t,e,r){var n=Qe(t);return n.size=t.size,n.has=function(e){return t.has(e)},n.get=function(n,i){var o=t.get(n,y);return o===y?i:e.call(r,o,n,t)},n.__iterateUncached=function(n,i){var o=this;return t.__iterate((function(t,i,s){return!1!==n(e.call(r,t,i,s),i,o)}),i)},n.__iteratorUncached=function(n,i){var o=t.__iterator(2,i);return new F((function(){var i=o.next();if(i.done)return i;var s=i.value,a=s[0];return P(n,a,e.call(r,s[1],a,t),i)}))},n}function Le(t,e){var r=Qe(t);return r._iter=t,r.size=t.size,r.reverse=function(){return t},t.flip&&(r.flip=function(){var e=Pe(t);return e.reverse=function(){return t.flip()},e}),r.get=function(r,n){return t.get(e?r:-1-r,n)},r.has=function(r){return t.has(e?r:-1-r)},r.includes=function(e){return t.includes(e)},r.cacheResult=Ze,r.__iterate=function(e,r){var n=this;return t.__iterate((function(t,r){return e(t,r,n)}),!r)},r.__iterator=function(e,r){return t.__iterator(e,!r)},r}function je(t,e,r,n){var i=Qe(t);return n&&(i.has=function(n){var i=t.get(n,y);return i!==y&&!!e.call(r,i,n,t)},i.get=function(n,i){var o=t.get(n,y);return o!==y&&e.call(r,o,n,t)?o:i}),i.__iterateUncached=function(i,o){var s=this,a=0;return t.__iterate((function(t,o,u){if(e.call(r,t,o,u))return a++,i(t,n?o:a-1,s)}),o),a},i.__iteratorUncached=function(i,o){var s=t.__iterator(2,o),a=0;return new F((function(){for(;;){var o=s.next();if(o.done)return o;var u=o.value,c=u[0],h=u[1];if(e.call(r,h,c,t))return P(i,n?c:a++,h,o)}}))},i}function qe(t,e,r,n){var i=t.size;if(void 0!==e&&(e|=0),void 0!==r&&(r===1/0?r=i:r|=0),O(e,r,i))return t;var o=C(e,i),s=D(r,i);if(o!=o||s!=s)return qe(t.toSeq().cacheResult(),e,r,n);var a,u=s-o;u==u&&(a=u<0?0:u);var c=Qe(t);return c.size=0===a?a:t.size&&a||void 0,!n&&et(t)&&a>=0&&(c.get=function(e,r){return(e=k(this,e))>=0&&e<a?t.get(e+o,r):r}),c.__iterateUncached=function(e,r){var i=this;if(0===a)return 0;if(r)return this.cacheResult().__iterate(e,r);var s=0,u=!0,c=0;return t.__iterate((function(t,r){if(!u||!(u=s++<o))return c++,!1!==e(t,n?r:c-1,i)&&c!==a})),c},c.__iteratorUncached=function(e,r){if(0!==a&&r)return this.cacheResult().__iterator(e,r);var i=0!==a&&t.__iterator(e,r),s=0,u=0;return new F((function(){for(;s++<o;)i.next();if(++u>a)return{value:void 0,done:!0};var t=i.next();return n||1===e?t:P(e,u-1,0===e?void 0:t.value[1],t)}))},c}function Be(t,e,r,n){var i=Qe(t);return i.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var a=!0,u=0;return t.__iterate((function(t,o,c){if(!a||!(a=e.call(r,t,o,c)))return u++,i(t,n?o:u-1,s)})),u},i.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var a=t.__iterator(2,o),u=!0,c=0;return new F((function(){var t,o,h;do{if((t=a.next()).done)return n||1===i?t:P(i,c++,0===i?void 0:t.value[1],t);var f=t.value;o=f[0],h=f[1],u&&(u=e.call(r,h,o,s))}while(u);return 2===i?t:P(i,o,h,t)}))},i}function ze(t,e){var r=a(t),i=[t].concat(e).map((function(t){return s(t)?r&&(t=n(t)):t=r?nt(t):it(Array.isArray(t)?t:[t]),t})).filter((function(t){return 0!==t.size}));if(0===i.length)return t;if(1===i.length){var o=i[0];if(o===t||r&&a(o)||u(t)&&u(o))return o}var c=new $(i);return r?c=c.toKeyedSeq():u(t)||(c=c.toSetSeq()),(c=c.flatten(!0)).size=i.reduce((function(t,e){if(void 0!==t){var r=e.size;if(void 0!==r)return t+r}}),0),c}function Ve(t,e,r){var n=Qe(t);return n.__iterateUncached=function(n,i){var o=0,a=!1;return function t(u,c){var h=this;u.__iterate((function(i,u){return(!e||c<e)&&s(i)?t(i,c+1):!1===n(i,r?u:o++,h)&&(a=!0),!a}),i)}(t,0),o},n.__iteratorUncached=function(n,i){var o=t.__iterator(n,i),a=[],u=0;return new F((function(){for(;o;){var t=o.next();if(!1===t.done){var c=t.value;if(2===n&&(c=c[1]),e&&!(a.length<e)||!s(c))return r?t:P(n,u++,c,t);a.push(o),o=c.__iterator(n,i)}else o=a.pop()}return{value:void 0,done:!0}}))},n}function We(t,e,r){e||(e=tr);var n=a(t),i=0,o=t.toSeq().map((function(e,n){return[n,e,i++,r?r(e,n,t):e]})).toArray();return o.sort((function(t,r){return e(t[3],r[3])||t[2]-r[2]})).forEach(n?function(t,e){o[e].length=2}:function(t,e){o[e]=t[1]}),n?W(o):u(t)?H(o):K(o)}function He(t,e,r){if(e||(e=tr),r){var n=t.toSeq().map((function(e,n){return[e,r(e,n,t)]})).reduce((function(t,r){return Ke(e,t[1],r[1])?r:t}));return n&&n[0]}return t.reduce((function(t,r){return Ke(e,t,r)?r:t}))}function Ke(t,e,r){var n=t(r,e);return 0===n&&r!==e&&(null==r||r!=r)||n>0}function Ge(t,e,n){var i=Qe(t);return i.size=new $(n).map((function(t){return t.size})).min(),i.__iterate=function(t,e){for(var r,n=this.__iterator(1,e),i=0;!(r=n.next()).done&&!1!==t(r.value,i++,this););return i},i.__iteratorUncached=function(t,i){var o=n.map((function(t){return t=r(t),q(i?t.reverse():t)})),s=0,a=!1;return new F((function(){var r;return a||(r=o.map((function(t){return t.next()})),a=r.some((function(t){return t.done}))),a?{value:void 0,done:!0}:P(t,s++,e.apply(null,r.map((function(t){return t.value}))))}))},i}function Xe(t,e){return et(t)?e:t.constructor(e)}function Ye(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Je(t){return Nt(t.size),T(t)}function $e(t){return a(t)?n:u(t)?i:o}function Qe(t){return Object.create((a(t)?W:u(t)?H:K).prototype)}function Ze(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):V.prototype.cacheResult.call(this)}function tr(t,e){return t>e?1:t<e?-1:0}function er(t){var e=q(t);if(!e){if(!z(t))throw new TypeError("Expected iterable or array-like: "+t);e=q(r(t))}return e}function rr(t,e){var r,n=function(o){if(o instanceof n)return o;if(!(this instanceof n))return new n(o);if(!r){r=!0;var s=Object.keys(t);(function(t,e){try{e.forEach(sr.bind(void 0,t))}catch(t){}})(i,s),i.size=s.length,i._name=e,i._keys=s,i._defaultValues=t}this._map=Ft(o)},i=n.prototype=Object.create(nr);return i.constructor=n,n}e(xe,Ft),xe.of=function(){return this(arguments)},xe.prototype.toString=function(){return this.__toString("OrderedMap {","}")},xe.prototype.get=function(t,e){var r=this._map.get(t);return void 0!==r?this._list.get(r)[1]:e},xe.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):De()},xe.prototype.set=function(t,e){return Ae(this,t,e)},xe.prototype.remove=function(t){return Ae(this,t,y)},xe.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},xe.prototype.__iterate=function(t,e){var r=this;return this._list.__iterate((function(e){return e&&t(e[1],e[0],r)}),e)},xe.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},xe.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),r=this._list.__ensureOwner(t);return t?Ce(e,r,t,this.__hash):(this.__ownerID=t,this._map=e,this._list=r,this)},xe.isOrderedMap=Oe,xe.prototype[d]=!0,xe.prototype[b]=xe.prototype.remove,e(Re,W),Re.prototype.get=function(t,e){return this._iter.get(t,e)},Re.prototype.has=function(t){return this._iter.has(t)},Re.prototype.valueSeq=function(){return this._iter.valueSeq()},Re.prototype.reverse=function(){var t=this,e=Le(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},Re.prototype.map=function(t,e){var r=this,n=Ue(this,t,e);return this._useKeys||(n.valueSeq=function(){return r._iter.toSeq().map(t,e)}),n},Re.prototype.__iterate=function(t,e){var r,n=this;return this._iter.__iterate(this._useKeys?function(e,r){return t(e,r,n)}:(r=e?Je(this):0,function(i){return t(i,e?--r:r++,n)}),e)},Re.prototype.__iterator=function(t,e){if(this._useKeys)return this._iter.__iterator(t,e);var r=this._iter.__iterator(1,e),n=e?Je(this):0;return new F((function(){var i=r.next();return i.done?i:P(t,e?--n:n++,i.value,i)}))},Re.prototype[d]=!0,e(Me,H),Me.prototype.includes=function(t){return this._iter.includes(t)},Me.prototype.__iterate=function(t,e){var r=this,n=0;return this._iter.__iterate((function(e){return t(e,n++,r)}),e)},Me.prototype.__iterator=function(t,e){var r=this._iter.__iterator(1,e),n=0;return new F((function(){var e=r.next();return e.done?e:P(t,n++,e.value,e)}))},e(Ne,K),Ne.prototype.has=function(t){return this._iter.includes(t)},Ne.prototype.__iterate=function(t,e){var r=this;return this._iter.__iterate((function(e){return t(e,e,r)}),e)},Ne.prototype.__iterator=function(t,e){var r=this._iter.__iterator(1,e);return new F((function(){var e=r.next();return e.done?e:P(t,e.value,e.value,e)}))},e(Fe,W),Fe.prototype.entrySeq=function(){return this._iter.toSeq()},Fe.prototype.__iterate=function(t,e){var r=this;return this._iter.__iterate((function(e){if(e){Ye(e);var n=s(e);return t(n?e.get(1):e[1],n?e.get(0):e[0],r)}}),e)},Fe.prototype.__iterator=function(t,e){var r=this._iter.__iterator(1,e);return new F((function(){for(;;){var e=r.next();if(e.done)return e;var n=e.value;if(n){Ye(n);var i=s(n);return P(t,i?n.get(0):n[0],i?n.get(1):n[1],e)}}}))},Me.prototype.cacheResult=Re.prototype.cacheResult=Ne.prototype.cacheResult=Fe.prototype.cacheResult=Ze,e(rr,vt),rr.prototype.toString=function(){return this.__toString(or(this)+" {","}")},rr.prototype.has=function(t){return this._defaultValues.hasOwnProperty(t)},rr.prototype.get=function(t,e){if(!this.has(t))return e;var r=this._defaultValues[t];return this._map?this._map.get(t,r):r},rr.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var t=this.constructor;return t._empty||(t._empty=ir(this,Yt()))},rr.prototype.set=function(t,e){if(!this.has(t))throw new Error('Cannot set unknown key "'+t+'" on '+or(this));if(this._map&&!this._map.has(t)&&e===this._defaultValues[t])return this;var r=this._map&&this._map.set(t,e);return this.__ownerID||r===this._map?this:ir(this,r)},rr.prototype.remove=function(t){if(!this.has(t))return this;var e=this._map&&this._map.remove(t);return this.__ownerID||e===this._map?this:ir(this,e)},rr.prototype.wasAltered=function(){return this._map.wasAltered()},rr.prototype.__iterator=function(t,e){var r=this;return n(this._defaultValues).map((function(t,e){return r.get(e)})).__iterator(t,e)},rr.prototype.__iterate=function(t,e){var r=this;return n(this._defaultValues).map((function(t,e){return r.get(e)})).__iterate(t,e)},rr.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map&&this._map.__ensureOwner(t);return t?ir(this,e,t):(this.__ownerID=t,this._map=e,this)};var nr=rr.prototype;function ir(t,e,r){var n=Object.create(Object.getPrototypeOf(t));return n._map=e,n.__ownerID=r,n}function or(t){return t._name||t.constructor.name||"Record"}function sr(t,e){Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){dt(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}function ar(t){return null==t?dr():ur(t)&&!h(t)?t:dr().withMutations((function(e){var r=o(t);Nt(r.size),r.forEach((function(t){return e.add(t)}))}))}function ur(t){return!(!t||!t[hr])}nr[b]=nr.remove,nr.deleteIn=nr.removeIn=jt.removeIn,nr.merge=jt.merge,nr.mergeWith=jt.mergeWith,nr.mergeIn=jt.mergeIn,nr.mergeDeep=jt.mergeDeep,nr.mergeDeepWith=jt.mergeDeepWith,nr.mergeDeepIn=jt.mergeDeepIn,nr.setIn=jt.setIn,nr.update=jt.update,nr.updateIn=jt.updateIn,nr.withMutations=jt.withMutations,nr.asMutable=jt.asMutable,nr.asImmutable=jt.asImmutable,e(ar,mt),ar.of=function(){return this(arguments)},ar.fromKeys=function(t){return this(n(t).keySeq())},ar.prototype.toString=function(){return this.__toString("Set {","}")},ar.prototype.has=function(t){return this._map.has(t)},ar.prototype.add=function(t){return lr(this,this._map.set(t,!0))},ar.prototype.remove=function(t){return lr(this,this._map.remove(t))},ar.prototype.clear=function(){return lr(this,this._map.clear())},ar.prototype.union=function(){var e=t.call(arguments,0);return 0===(e=e.filter((function(t){return 0!==t.size}))).length?this:0!==this.size||this.__ownerID||1!==e.length?this.withMutations((function(t){for(var r=0;r<e.length;r++)o(e[r]).forEach((function(e){return t.add(e)}))})):this.constructor(e[0])},ar.prototype.intersect=function(){var e=t.call(arguments,0);if(0===e.length)return this;e=e.map((function(t){return o(t)}));var r=this;return this.withMutations((function(t){r.forEach((function(r){e.every((function(t){return t.includes(r)}))||t.remove(r)}))}))},ar.prototype.subtract=function(){var e=t.call(arguments,0);if(0===e.length)return this;e=e.map((function(t){return o(t)}));var r=this;return this.withMutations((function(t){r.forEach((function(r){e.some((function(t){return t.includes(r)}))&&t.remove(r)}))}))},ar.prototype.merge=function(){return this.union.apply(this,arguments)},ar.prototype.mergeWith=function(e){var r=t.call(arguments,1);return this.union.apply(this,r)},ar.prototype.sort=function(t){return br(We(this,t))},ar.prototype.sortBy=function(t,e){return br(We(this,e,t))},ar.prototype.wasAltered=function(){return this._map.wasAltered()},ar.prototype.__iterate=function(t,e){var r=this;return this._map.__iterate((function(e,n){return t(n,n,r)}),e)},ar.prototype.__iterator=function(t,e){return this._map.map((function(t,e){return e})).__iterator(t,e)},ar.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):(this.__ownerID=t,this._map=e,this)},ar.isSet=ur;var cr,hr="@@__IMMUTABLE_SET__@@",fr=ar.prototype;function lr(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function pr(t,e){var r=Object.create(fr);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}function dr(){return cr||(cr=pr(Yt()))}function br(t){return null==t?_r():gr(t)?t:_r().withMutations((function(e){var r=o(t);Nt(r.size),r.forEach((function(t){return e.add(t)}))}))}function gr(t){return ur(t)&&h(t)}fr[hr]=!0,fr[b]=fr.remove,fr.mergeDeep=fr.merge,fr.mergeDeepWith=fr.mergeWith,fr.withMutations=jt.withMutations,fr.asMutable=jt.asMutable,fr.asImmutable=jt.asImmutable,fr.__empty=dr,fr.__make=pr,e(br,ar),br.of=function(){return this(arguments)},br.fromKeys=function(t){return this(n(t).keySeq())},br.prototype.toString=function(){return this.__toString("OrderedSet {","}")},br.isOrderedSet=gr;var vr,yr=br.prototype;function mr(t,e){var r=Object.create(yr);return r.size=t?t.size:0,r._map=t,r.__ownerID=e,r}function _r(){return vr||(vr=mr(De()))}function wr(t){return null==t?xr():Er(t)?t:xr().unshiftAll(t)}function Er(t){return!(!t||!t[Ir])}yr[d]=!0,yr.__empty=_r,yr.__make=mr,e(wr,yt),wr.of=function(){return this(arguments)},wr.prototype.toString=function(){return this.__toString("Stack [","]")},wr.prototype.get=function(t,e){var r=this._head;for(t=k(this,t);r&&t--;)r=r.next;return r?r.value:e},wr.prototype.peek=function(){return this._head&&this._head.value},wr.prototype.push=function(){if(0===arguments.length)return this;for(var t=this.size+arguments.length,e=this._head,r=arguments.length-1;r>=0;r--)e={value:arguments[r],next:e};return this.__ownerID?(this.size=t,this._head=e,this.__hash=void 0,this.__altered=!0,this):kr(t,e)},wr.prototype.pushAll=function(t){if(0===(t=i(t)).size)return this;Nt(t.size);var e=this.size,r=this._head;return t.reverse().forEach((function(t){e++,r={value:t,next:r}})),this.__ownerID?(this.size=e,this._head=r,this.__hash=void 0,this.__altered=!0,this):kr(e,r)},wr.prototype.pop=function(){return this.slice(1)},wr.prototype.unshift=function(){return this.push.apply(this,arguments)},wr.prototype.unshiftAll=function(t){return this.pushAll(t)},wr.prototype.shift=function(){return this.pop.apply(this,arguments)},wr.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):xr()},wr.prototype.slice=function(t,e){if(O(t,e,this.size))return this;var r=C(t,this.size);if(D(e,this.size)!==this.size)return yt.prototype.slice.call(this,t,e);for(var n=this.size-r,i=this._head;r--;)i=i.next;return this.__ownerID?(this.size=n,this._head=i,this.__hash=void 0,this.__altered=!0,this):kr(n,i)},wr.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?kr(this.size,this._head,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},wr.prototype.__iterate=function(t,e){if(e)return this.reverse().__iterate(t);for(var r=0,n=this._head;n&&!1!==t(n.value,r++,this);)n=n.next;return r},wr.prototype.__iterator=function(t,e){if(e)return this.reverse().__iterator(t);var r=0,n=this._head;return new F((function(){if(n){var e=n.value;return n=n.next,P(t,r++,e)}return{value:void 0,done:!0}}))},wr.isStack=Er;var Sr,Ir="@@__IMMUTABLE_STACK__@@",Tr=wr.prototype;function kr(t,e,r,n){var i=Object.create(Tr);return i.size=t,i._head=e,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function xr(){return Sr||(Sr=kr(0))}function Or(t,e){var r=function(r){t.prototype[r]=e[r]};return Object.keys(e).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(r),t}Tr[Ir]=!0,Tr.withMutations=jt.withMutations,Tr.asMutable=jt.asMutable,Tr.asImmutable=jt.asImmutable,Tr.wasAltered=jt.wasAltered,r.Iterator=F,Or(r,{toArray:function(){Nt(this.size);var t=new Array(this.size||0);return this.valueSeq().__iterate((function(e,r){t[r]=e})),t},toIndexedSeq:function(){return new Me(this)},toJS:function(){return this.toSeq().map((function(t){return t&&"function"==typeof t.toJS?t.toJS():t})).__toJS()},toJSON:function(){return this.toSeq().map((function(t){return t&&"function"==typeof t.toJSON?t.toJSON():t})).__toJS()},toKeyedSeq:function(){return new Re(this,!0)},toMap:function(){return Ft(this.toKeyedSeq())},toObject:function(){Nt(this.size);var t={};return this.__iterate((function(e,r){t[r]=e})),t},toOrderedMap:function(){return xe(this.toKeyedSeq())},toOrderedSet:function(){return br(a(this)?this.valueSeq():this)},toSet:function(){return ar(a(this)?this.valueSeq():this)},toSetSeq:function(){return new Ne(this)},toSeq:function(){return u(this)?this.toIndexedSeq():a(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return wr(a(this)?this.valueSeq():this)},toList:function(){return he(a(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){return Xe(this,ze(this,t.call(arguments,0)))},includes:function(t){return this.some((function(e){return ft(e,t)}))},entries:function(){return this.__iterator(2)},every:function(t,e){Nt(this.size);var r=!0;return this.__iterate((function(n,i,o){if(!t.call(e,n,i,o))return r=!1,!1})),r},filter:function(t,e){return Xe(this,je(this,t,e,!0))},find:function(t,e,r){var n=this.findEntry(t,e);return n?n[1]:r},forEach:function(t,e){return Nt(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){Nt(this.size),t=void 0!==t?""+t:",";var e="",r=!0;return this.__iterate((function(n){r?r=!1:e+=t,e+=null!=n?n.toString():""})),e},keys:function(){return this.__iterator(0)},map:function(t,e){return Xe(this,Ue(this,t,e))},reduce:function(t,e,r){var n,i;return Nt(this.size),arguments.length<2?i=!0:n=e,this.__iterate((function(e,o,s){i?(i=!1,n=e):n=t.call(r,n,e,o,s)})),n},reduceRight:function(t,e,r){var n=this.toKeyedSeq().reverse();return n.reduce.apply(n,arguments)},reverse:function(){return Xe(this,Le(this,!0))},slice:function(t,e){return Xe(this,qe(this,t,e,!0))},some:function(t,e){return!this.every(Mr(t),e)},sort:function(t){return Xe(this,We(this,t))},values:function(){return this.__iterator(1)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(t,e){return T(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return function(t,e,r){var n=Ft().asMutable();return t.__iterate((function(i,o){n.update(e.call(r,i,o,t),0,(function(t){return t+1}))})),n.asImmutable()}(this,t,e)},equals:function(t){return lt(this,t)},entrySeq:function(){var t=this;if(t._cache)return new $(t._cache);var e=t.toSeq().map(Rr).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(Mr(t),e)},findEntry:function(t,e,r){var n=r;return this.__iterate((function(r,i,o){if(t.call(e,r,i,o))return n=[i,r],!1})),n},findKey:function(t,e){var r=this.findEntry(t,e);return r&&r[0]},findLast:function(t,e,r){return this.toKeyedSeq().reverse().find(t,e,r)},findLastEntry:function(t,e,r){return this.toKeyedSeq().reverse().findEntry(t,e,r)},findLastKey:function(t,e){return this.toKeyedSeq().reverse().findKey(t,e)},first:function(){return this.find(x)},flatMap:function(t,e){return Xe(this,function(t,e,r){var n=$e(t);return t.toSeq().map((function(i,o){return n(e.call(r,i,o,t))})).flatten(!0)}(this,t,e))},flatten:function(t){return Xe(this,Ve(this,t,!0))},fromEntrySeq:function(){return new Fe(this)},get:function(t,e){return this.find((function(e,r){return ft(r,t)}),void 0,e)},getIn:function(t,e){for(var r,n=this,i=er(t);!(r=i.next()).done;){var o=r.value;if((n=n&&n.get?n.get(o,y):y)===y)return e}return n},groupBy:function(t,e){return function(t,e,r){var n=a(t),i=(h(t)?xe():Ft()).asMutable();t.__iterate((function(o,s){i.update(e.call(r,o,s,t),(function(t){return(t=t||[]).push(n?[s,o]:o),t}))}));var o=$e(t);return i.map((function(e){return Xe(t,o(e))}))}(this,t,e)},has:function(t){return this.get(t,y)!==y},hasIn:function(t){return this.getIn(t,y)!==y},isSubset:function(t){return t="function"==typeof t.includes?t:r(t),this.every((function(e){return t.includes(e)}))},isSuperset:function(t){return(t="function"==typeof t.isSubset?t:r(t)).isSubset(this)},keyOf:function(t){return this.findKey((function(e){return ft(e,t)}))},keySeq:function(){return this.toSeq().map(Ar).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return He(this,t)},maxBy:function(t,e){return He(this,e,t)},min:function(t){return He(this,t?Nr(t):Ur)},minBy:function(t,e){return He(this,e?Nr(e):Ur,t)},rest:function(){return this.slice(1)},skip:function(t){return this.slice(Math.max(0,t))},skipLast:function(t){return Xe(this,this.toSeq().reverse().skip(t).reverse())},skipWhile:function(t,e){return Xe(this,Be(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(Mr(t),e)},sortBy:function(t,e){return Xe(this,We(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return Xe(this,this.toSeq().reverse().take(t).reverse())},takeWhile:function(t,e){return Xe(this,function(t,e,r){var n=Qe(t);return n.__iterateUncached=function(n,i){var o=this;if(i)return this.cacheResult().__iterate(n,i);var s=0;return t.__iterate((function(t,i,a){return e.call(r,t,i,a)&&++s&&n(t,i,o)})),s},n.__iteratorUncached=function(n,i){var o=this;if(i)return this.cacheResult().__iterator(n,i);var s=t.__iterator(2,i),a=!0;return new F((function(){if(!a)return{value:void 0,done:!0};var t=s.next();if(t.done)return t;var i=t.value,u=i[0],c=i[1];return e.call(r,c,u,o)?2===n?t:P(n,u,c,t):(a=!1,{value:void 0,done:!0})}))},n}(this,t,e))},takeUntil:function(t,e){return this.takeWhile(Mr(t),e)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(t){if(t.size===1/0)return 0;var e=h(t),r=a(t),n=e?1:0;return function(t,e){return e=_t(e,3432918353),e=_t(e<<15|e>>>-15,461845907),e=_t(e<<13|e>>>-13,5),e=_t((e=(e+3864292196|0)^t)^e>>>16,2246822507),e=wt((e=_t(e^e>>>13,3266489909))^e>>>16)}(t.__iterate(r?e?function(t,e){n=31*n+Lr(Et(t),Et(e))|0}:function(t,e){n=n+Lr(Et(t),Et(e))|0}:e?function(t){n=31*n+Et(t)|0}:function(t){n=n+Et(t)|0}),n)}(this))}});var Cr=r.prototype;Cr[f]=!0,Cr[N]=Cr.values,Cr.__toJS=Cr.toArray,Cr.__toStringMapper=Fr,Cr.inspect=Cr.toSource=function(){return this.toString()},Cr.chain=Cr.flatMap,Cr.contains=Cr.includes,Or(n,{flip:function(){return Xe(this,Pe(this))},mapEntries:function(t,e){var r=this,n=0;return Xe(this,this.toSeq().map((function(i,o){return t.call(e,[o,i],n++,r)})).fromEntrySeq())},mapKeys:function(t,e){var r=this;return Xe(this,this.toSeq().flip().map((function(n,i){return t.call(e,n,i,r)})).flip())}});var Dr=n.prototype;function Ar(t,e){return e}function Rr(t,e){return[e,t]}function Mr(t){return function(){return!t.apply(this,arguments)}}function Nr(t){return function(){return-t.apply(this,arguments)}}function Fr(t){return"string"==typeof t?JSON.stringify(t):String(t)}function Pr(){return I(arguments)}function Ur(t,e){return t<e?1:t>e?-1:0}function Lr(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}return Dr[l]=!0,Dr[N]=Cr.entries,Dr.__toJS=Cr.toObject,Dr.__toStringMapper=function(t,e){return JSON.stringify(e)+": "+Fr(t)},Or(i,{toKeyedSeq:function(){return new Re(this,!1)},filter:function(t,e){return Xe(this,je(this,t,e,!1))},findIndex:function(t,e){var r=this.findEntry(t,e);return r?r[0]:-1},indexOf:function(t){var e=this.keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){var e=this.lastKeyOf(t);return void 0===e?-1:e},reverse:function(){return Xe(this,Le(this,!1))},slice:function(t,e){return Xe(this,qe(this,t,e,!1))},splice:function(t,e){var r=arguments.length;if(e=Math.max(0|e,0),0===r||2===r&&!e)return this;t=C(t,t<0?this.count():this.size);var n=this.slice(0,t);return Xe(this,1===r?n:n.concat(I(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var r=this.findLastEntry(t,e);return r?r[0]:-1},first:function(){return this.get(0)},flatten:function(t){return Xe(this,Ve(this,t,!1))},get:function(t,e){return(t=k(this,t))<0||this.size===1/0||void 0!==this.size&&t>this.size?e:this.find((function(e,r){return r===t}),void 0,e)},has:function(t){return(t=k(this,t))>=0&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return Xe(this,function(t,e){var r=Qe(t);return r.size=t.size&&2*t.size-1,r.__iterateUncached=function(r,n){var i=this,o=0;return t.__iterate((function(t,n){return(!o||!1!==r(e,o++,i))&&!1!==r(t,o++,i)}),n),o},r.__iteratorUncached=function(r,n){var i,o=t.__iterator(1,n),s=0;return new F((function(){return(!i||s%2)&&(i=o.next()).done?i:s%2?P(r,s++,e):P(r,s++,i.value,i)}))},r}(this,t))},interleave:function(){var t=[this].concat(I(arguments)),e=Ge(this.toSeq(),H.of,t),r=e.flatten(!0);return e.size&&(r.size=e.size*t.length),Xe(this,r)},keySeq:function(){return bt(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(t,e){return Xe(this,Be(this,t,e,!1))},zip:function(){return Xe(this,Ge(this,Pr,[this].concat(I(arguments))))},zipWith:function(t){var e=I(arguments);return e[0]=this,Xe(this,Ge(this,t,e))}}),i.prototype[p]=!0,i.prototype[d]=!0,Or(o,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),o.prototype.has=Cr.includes,o.prototype.contains=o.prototype.includes,Or(W,n.prototype),Or(H,i.prototype),Or(K,o.prototype),Or(vt,n.prototype),Or(yt,i.prototype),Or(mt,o.prototype),{Iterable:r,Seq:V,Collection:gt,Map:Ft,OrderedMap:xe,List:he,Stack:wr,Set:ar,OrderedSet:br,Record:rr,Range:bt,Repeat:pt,is:ft,fromJS:ut}}()}(Q);var Z=Q.exports,tt=function(t){var e,r=t.Symbol;return"function"==typeof r?r.observable?e=r.observable:(e=r("observable"),r.observable=e):e="@@observable",e}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==l?l:e),et=function(){return Math.random().toString(36).substring(7).split("").join(".")},rt={INIT:"@@redux/INIT"+et(),REPLACE:"@@redux/REPLACE"+et(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+et()}};function nt(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function it(t,e,r){var n;if("function"==typeof e&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof e&&void 0===r&&(r=e,e=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(it)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var i=t,o=e,s=[],a=s,u=!1;function c(){a===s&&(a=s.slice())}function h(){if(u)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function f(t){if("function"!=typeof t)throw new Error("Expected the listener to be a function.");if(u)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var e=!0;return c(),a.push(t),function(){if(e){if(u)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");e=!1,c();var r=a.indexOf(t);a.splice(r,1),s=null}}}function l(t){if(!nt(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,o=i(o,t)}finally{u=!1}for(var e=s=a,r=0;r<e.length;r++)(0,e[r])();return t}function p(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");i=t,l({type:rt.REPLACE})}function d(){var t,e=f;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");function r(){t.next&&t.next(h())}return r(),{unsubscribe:e(r)}}})[tt]=function(){return this},t}return l({type:rt.INIT}),(n={dispatch:l,subscribe:f,getState:h,replaceReducer:p})[tt]=d,n}function ot(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function st(t,e){var r=Object.keys(t);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(t)),e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r}function at(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?st(r,!0).forEach((function(e){ot(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):st(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ut(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}function ct(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t){return function(){var r=t.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},o=e.map((function(t){return t(i)}));return at({},r,{dispatch:n=ut.apply(void 0,o)(r.dispatch)})}}}function ht(t){return function(e){var r=e.dispatch,n=e.getState;return function(e){return function(i){return"function"==typeof i?i(r,n,t):e(i)}}}}var ft=ht();ft.withExtraArgument=ht;var lt={},pt={exports:{}},dt={},bt={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t&&"@@redux/INIT"===t.type?"initialState argument passed to createStore":"previous state received by the reducer"},t.exports=e.default}(bt,bt.exports);var gt={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r=i(Q.exports),n=i(bt.exports);function i(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,i){var o=Object.keys(e);if(!o.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";var s=(0,n.default)(i);if(r.default.isImmutable?!r.default.isImmutable(t):!r.default.Iterable.isIterable(t))return"The "+s+' is of unexpected type. Expected argument to be an instance of Immutable.Collection or Immutable.Record with the following properties: "'+o.join('", "')+'".';var a=t.toSeq().keySeq().toArray().filter((function(t){return!e.hasOwnProperty(t)}));return a.length>0?"Unexpected "+(1===a.length?"property":"properties")+' "'+a.join('", "')+'" found in '+s+'. Expected to find one of the known reducer property names instead: "'+o.join('", "')+'". Unexpected properties will be ignored.':null},t.exports=e.default}(gt,gt.exports);var vt={exports:{}};!function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){if(void 0===t)throw new Error('Reducer "'+e+'" returned undefined when handling "'+r.type+'" action. To ignore an action, you must explicitly return the previous state.')},t.exports=e.default}(vt,vt.exports),Object.defineProperty(dt,"__esModule",{value:!0}),dt.validateNextState=dt.getUnexpectedInvocationParameterMessage=dt.getStateName=void 0;var yt=wt(bt.exports),mt=wt(gt.exports),_t=wt(vt.exports);function wt(t){return t&&t.__esModule?t:{default:t}}dt.getStateName=yt.default,dt.getUnexpectedInvocationParameterMessage=mt.default,dt.validateNextState=_t.default,function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var r,n=(r=Q.exports)&&r.__esModule?r:{default:r},i=dt;e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.default.Map,r=Object.keys(t);return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e(),o=arguments[1];return n.withMutations((function(e){r.forEach((function(r){var n=(0,t[r])(e.get(r),o);(0,i.validateNextState)(n,r,o),e.set(r,n)}))}))}},t.exports=e.default}(pt,pt.exports),Object.defineProperty(lt,"__esModule",{value:!0});var Et,St=lt.combineReducers=void 0,It=(Et=pt.exports)&&Et.__esModule?Et:{default:Et};St=lt.combineReducers=It.default;var Tt=function(){return new Z.List},kt="PLAYBACK_PLAY",xt="PLAYBACK_SET",Ot="PLAYBACK_PAUSE",Ct="PLAYBACK_ENDED",Dt="PLAYBACK_TOGGLE_REPEAT",At="PLAYBACK_TOGGLE_MUTE",Rt="PLAYBACK_SET_VOLUME",Mt="PLAYBACK_SET_TIME",Nt="PLAYBACK_SEEK_TO",Ft="PLAYBACK_SET_BITRATE",Pt="PLAYBACK_SET_DURATION",Ut="PLAYBACK_STALLED",Lt="PLAYBACK_STALL_COMPLETED",jt="PLAYBACK_SEEK_COMPLETED",qt="PLAYBACK_STARTED",Bt="ADD_TRACK",zt="REMOVE_TRACK",Vt="RESET_TRACK",Wt="REPLACE_TRACK",Ht="UPDATE_TRACK",Kt="UPDATE_TRACK_DATA",Gt="INCREASE_DYNAMIC_TRACK_DURATION",Xt="DECREASE_DYNAMIC_TRACK_DURATION",Yt="GET_MANIFEST_START",Jt="GET_MANIFEST_SUCCEED",$t="GET_MANIFEST_FAILED",Qt="UTCTIMING_REQUEST",Zt="UTCTIMING_REQUESTED",te="UTCTIMING_REQUEST_FAILED",ee="SET_SERVER_TIME_OFFSET",re="SERVER_TIME_SYNC_COMPLETED",ne="MEDIA_SOURCE_OPENED",ie="MEDIA_SOURCE_CLOSED",oe="MEDIA_SOURCE_ENDED",se="BUFFER_APPENDED",ae="BUFFER_APPENDING",ue="BUFFER_RANGES_UPDATED",ce="GET_FRAGMENT_START",he="GET_FRAGMENT_SUCCEED",fe="GET_FRAGMENT_FAILED",le="END_DYNAMIC_TRACK",pe="NETWORK_ONLINE",de="NETWORK_OFFLINE",be="ERROR",ge="UPDATE_CONFIG",ve="PLAYBACK_DECREASE_BITRATE",ye="PLAYBACK_INCREASE_BITRATE",me="GET_LICENSE_START",_e="GET_LICENSE_SUCCEED",we="GET_LICENSE_FAILED",Ee="SESSION_UPDATE_START",Se="SESSION_UPDATE_SUCCEED",Ie="SESSION_UPDATE_FAILED",Te="SET_CONTENT_PROTECTION_LABEL",ke="UPDATE_ABR",xe="UPDATE_LATEST_ABR",Oe=new Map;Oe.set("debug",!1);var Ce={initialConfig:{abr:{rule:"min",factor:.75,samples:30,blackoutDuration:600,blackoutMaxDuration:4800},cacheSize:2,secondsToPrefetch:20,secondsToPrefetchAhead:240,secondsToRetryManifest:10,maxNetworkRetries:3,userAgent:l.navigator.userAgent,maxPrecedingTime:3600,secondsToRetryManifestJitter:300,drm:{}},getDebugMode:function(){return Oe.get("debug")},setDebugMode:function(t){Oe.set("debug",t)}};function De(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.Map(),e=arguments.length>1?arguments[1]:void 0;switch(e.type){case ce:return t.set("isRequesting",!0);case he:return t.merge({isRequesting:!1,data:e.payload.data});case fe:return t.set("isRequesting",!1);case ae:return t.set("isBuffering",!0);case se:return t=t.merge({isBuffering:!1,endTime:e.payload.endTime,startTime:e.payload.startTime}),void 0!==e.payload.fragmentIndex&&(t=t.set("data",null)),t;default:return t}}function Ae(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.List(),e=arguments.length>1?arguments[1]:void 0;if(!e.payload)return t;var r=t.get(e.payload.fragmentIndex);switch(e.type){case Gt:var n=e.payload.newFragments.map((function(t){return Z.fromJS(t)}));return t.push.apply(t,u(n));case Xt:return t.splice(-e.payload.numOfFragsToBeRemoved);default:return t.set(e.payload.fragmentIndex,De(r,e))}}var Re=Z.Map({trackIds:Z.List()});function Me(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.List(),r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Bt:var n=r.payload.track.id;return(t=e.indexOf(n))>=0&&(e=e.remove(t)),e.push(n);case zt:return(t=e.indexOf(r.payload.trackId))<0?e:e.delete(t);default:return e}}function Ne(t,e){if(!e)return t;if(!t.has(e.payload.trackId))return t;switch(e.type){case ae:var r;return r=void 0===e.payload.fragmentIndex?[e.payload.trackId,"bitrates",e.payload.bitrate,"initialization"]:[e.payload.trackId,"bitrates",e.payload.bitrate,"fragments",e.payload.fragmentIndex],t.setIn([e.payload.trackId,"bitrates",e.payload.bitrate,"needsInitFragment"],!1).setIn(r,De(t.getIn(r),e));case ce:case he:case fe:case se:if(void 0===e.payload.fragmentIndex){var n=[e.payload.trackId,"bitrates",e.payload.bitrate,"initialization"];return t.setIn(n,De(t.getIn(n),e))}var i=[e.payload.trackId,"bitrates",e.payload.bitrate,"fragments"];return t.setIn(i,Ae(t.getIn(i),e));default:return t}}function Fe(t,e){if(!e)return t;switch(e.type){case me:return t.set("isRequesting",!0);case _e:return t.merge({isRequesting:!1,data:e.payload.data});case we:return t.merge({isRequesting:!1});case Ee:return t.set("isUpdating",!0);case Se:case Ie:return t.merge({isUpdating:!1,data:null});default:return t}}function Pe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.Map(),e=arguments.length>1?arguments[1]:void 0;switch(e.type){case Yt:return t.merge({isRequesting:!0});case $t:return t.set("isRequesting",!1);case Jt:return t.merge({isRequesting:!1,manifest:e.payload.manifest});default:return t}}function Ue(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.List(),r=arguments.length>1?arguments[1]:void 0;switch(r.type){case Yt:var n=r.payload.manifestId;return(t=e.indexOf(n))>=0&&(e=e.remove(t)),e.push(n);default:return e}}function Le(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.Map(),e=arguments.length>1?arguments[1]:void 0,r=e.payload.manifestId,n=e.payload.trackId;switch(e.type){case Yt:case $t:case Jt:return t.set(r,Pe(t.getIn([n,"manifests",r]),e));default:return t}}var je=Z.Map({id:void 0,time:0,duration:void 0,stalled:!1,playing:!1,seeking:!0,paused:!0,ended:!1,volume:1,muted:!1,repeating:!1,bitrate:void 0,codecs:void 0,started:!1}),qe=Z.Map({updating:!1}),Be=Z.Map({readyState:"closed",sourceBuffer:qe});function ze(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,e=arguments.length>1?arguments[1]:void 0;if(!e)return t;switch(e.type){case ae:return t.set("updating",!0);case se:return t.set("updating",!1);default:return t}}var Ve={mediaSource:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,e=arguments.length>1?arguments[1]:void 0;if(!e)return t;switch(e.type){case ne:return t.set("readyState","open");case ie:return t.set("readyState","closed");case oe:return t.set("readyState","ended");case ae:case se:return t.set("sourceBuffer",ze(t.get("sourceBuffer"),e));default:return t}},initialMediaSource:Be},We={CHROME:"chrome",SAFARI:"safari",FIREFOX_DESKTOP:"firefoxDesktop",FIREFOX_MOBILE:"firefoxMobile",IE:"ie",EDGE:"edge",UNKNOWN:"unknown"},He={ANDROID:"android",CHROME_OS:"chromeOs",I_OS:"iOS",LINUX:"linux",MAC_OS:"mac",WEB_OS:"webOs",TIZEN:"tizen",WINDOWS:"windows",WINDOWS_PHONE:"windowsPhone",COMCAST_TV:"comcastTv",UNKNOWN:"unknown"},Ke={};Ke[We.CHROME]=48,Ke[We.SAFARI]=10,Ke[We.FIREFOX_DESKTOP]=45,Ke[We.FIREFOX_MOBILE]=45,Ke[We.IE]=11,Ke[We.EDGE]=13,Ke["DRM."+We.CHROME]=75,Ke["DRM."+We.FIREFOX_DESKTOP]=68,Ke["DRM."+We.FIREFOX_MOBILE]=85;var Ge={};Ge[We.CHROME]=/Chrome\/((?:\d+)(?:\.\d+)+)/i,Ge[We.SAFARI]=/Version\/((?:\d+)(?:\.\d+)+) Safari\//i,Ge[We.FIREFOX_DESKTOP]=/Firefox\/((?:\d+)(?:\.\d+)+)/i,Ge[We.FIREFOX_MOBILE]=/Firefox\/((?:\d+)(?:\.\d+)+)/i,Ge[We.IE]=/[Trident|MSIE].*; rv:((?:\d+)(?:\.\d+)+)/i,Ge[We.EDGE]=/Edge\/((?:\d+)(?:\.\d+)+)/i;var Xe=l.navigator.userAgent,Ye=null,Je=null,$e=null,Qe=function(){function t(){n(this,t)}return o(t,null,[{key:"cacheCheck",value:function(){Xe!==l.navigator.userAgent&&(Xe=l.navigator.userAgent,Ye=null,Je=null,$e=null)}},{key:"getBrowserName",value:function(){if(t.cacheCheck(),null!==Ye)return Ye;switch(!0){case/chrome/i.test(Xe)&&!/edge/i.test(Xe):Ye=We.CHROME;break;case/safari/i.test(Xe)&&!/chrome/i.test(Xe):Ye=We.SAFARI;break;case/Firefox/i.test(Xe)&&this.isMobileBrowser():Ye=We.FIREFOX_MOBILE;break;case/Firefox/i.test(Xe):Ye=We.FIREFOX_DESKTOP;break;case/MSIE|Trident/i.test(Xe):Ye=We.IE;break;case/Edge/i.test(Xe):Ye=We.EDGE;break;default:Ye=We.UNKNOWN}return Ye}},{key:"getOsName",value:function(){if(t.cacheCheck(),null!==Je)return Je;switch(!0){case/windows phone/i.test(Xe):Je=He.WINDOWS_PHONE;break;case/windows/i.test(Xe):Je=He.WINDOWS;break;case/tizen(?!browser)/i.test(Xe):Je=He.TIZEN;break;case/macintosh/i.test(Xe):Je=He.MAC_OS;break;case/(ipad|ipod|iphone)/i.test(Xe):Je=He.I_OS;break;case/android/i.test(Xe):Je=He.ANDROID;break;case/webos/i.test(Xe):Je=He.WEB_OS;break;case/\bwpe\b/i.test(Xe)&&/linux/i.test(Xe):Je=He.COMCAST_TV;break;case/linux/i.test(Xe):Je=He.LINUX;break;case/cros/i.test(Xe):Je=He.CHROME_OS;break;default:Je=He.UNKNOWN}return Je}},{key:"getBrowserMajorVersion",value:function(){return t.getBrowserVersion()[0]}},{key:"getBrowserVersion",value:function(){if(t.cacheCheck(),null!=$e)return $e;var e=Ge[t.getBrowserName()];if(e){var r=Xe.match(e),n=r&&r[1]?r[1]:"0";$e=n.split(".").map((function(t){return parseInt(t)}))}else $e=[0];return $e}},{key:"isLessThanVersion",value:function(e){for(var r=t.getBrowserVersion(),n=e.split(".").map((function(t){return parseInt(t)})),i=0;i<n.length;i++){var o=r[i]||0,s=n[i]||0;if(o>s)return!1;if(o<s)return!0}return!1}},{key:"isVersionSupported",value:function(){var e=Ke[t.getBrowserName()];return!e||t.getBrowserMajorVersion()>=e}},{key:"isEMEVersionSupported",value:function(){var e=Ke["DRM."+t.getBrowserName()];return!e||t.getBrowserMajorVersion()>=e}},{key:"isMobileBrowser",value:function(){return/Mobi|tablet|ipad|playbook|silk|android/i.test(l.navigator.userAgent)}},{key:"isChromeOS",value:function(){return/cros/i.test(l.navigator.userAgent)}},{key:"isAndroid",value:function(){return/android/i.test(l.navigator.userAgent)}}]),t}(),Ze={BROWSER_NAMES:We,OS_NAMES:He,isVersionSupported:Qe.isVersionSupported,isEMEVersionSupported:Qe.isEMEVersionSupported,isLessThanVersion:Qe.isLessThanVersion,isMobileBrowser:Qe.isMobileBrowser,isChrome:function(){return Qe.getBrowserName()===We.CHROME},isFirefoxDesktop:function(){return Qe.getBrowserName()===We.FIREFOX_DESKTOP},isFirefoxMobile:function(){return Qe.getBrowserName()===We.FIREFOX_MOBILE},isSafari:function(){return Qe.getBrowserName()===We.SAFARI},isIE:function(){return Qe.getBrowserName()===We.IE},isEdge:function(){return Qe.getBrowserName()===We.EDGE},isAndroid:function(){return Qe.getOsName()===He.ANDROID},isChromeOS:function(){return Qe.getOsName()===He.CHROME_OS},isIOS:function(){return Qe.getOsName()===He.I_OS},isLinux:function(){return Qe.getOsName()===He.LINUX},isMacOS:function(){return Qe.getOsName()===He.MAC_OS},isTizenOS:function(){return Qe.getOsName()===He.TIZEN},isWebOS:function(){return Qe.getOsName()===He.WEB_OS},isWindows:function(){return Qe.getOsName()===He.WINDOWS},isWindowsPhone:function(){return Qe.getOsName()===He.WINDOWS_PHONE},isComcastTV:function(){return Qe.getOsName()===He.COMCAST_TV&&Qe.getBrowserName()===We.SAFARI}};if(Ze.isComcastTV()&&Ze.isLessThanVersion("10")){var tr=HTMLAudioElement.prototype.pause;HTMLAudioElement.prototype.pause=function(){var t=this.currentTime,e=this.duration;(!isFinite(t)||!isFinite(e)||t<e-2)&&tr.call(this)}}var er=function(){var t=new Audio,e=l.MediaSource&&new MediaSource;if(t.src=!!e&&l.URL&&"function"==typeof URL.createObjectURL&&URL.createObjectURL(e),t._mediaSource=e,Ze.isComcastTV()&&Ze.isLessThanVersion("10")){t.loop=!0;var r=0;t.addEventListener("timeupdate",(function(){var e=t.duration,n=t.currentTime;isFinite(e)&&r>n&&n<3&&r>e-3?(r=0,t.pause(),t.dispatchEvent(new CustomEvent("ended"))):r=n})),t.addEventListener("canplay",(function(){t.paused&&(t.play(),t.pause())}))}return t},rr=function(t){return t.src=!!t._mediaSource&&l.URL&&"function"==typeof URL.createObjectURL&&URL.createObjectURL(t._mediaSource),t},nr=function(){return Z.Map({_freeAudioEls:Z.List(Array.from({length:Ce.initialConfig.cacheSize+1},er)),_limit:Ce.initialConfig.cacheSize+1,_usedCount:0})},ir=Z.Map({audioEl:void 0,lastBufferedIndex:void 0,lastBufferedData:void 0,ranges:Z.List(),mediaSource:Ve.initialMediaSource}),or=Z.Map({count:0,list:Z.List()}),sr="undefined"!=typeof self?self:void 0,ar="URLSearchParams"in sr,ur="Symbol"in sr&&"iterator"in Symbol,cr="FileReader"in sr&&"Blob"in sr&&function(){try{return new Blob,!0}catch(t){return!1}}(),hr="FormData"in sr,fr="ArrayBuffer"in sr;if(fr)var lr=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],pr=ArrayBuffer.isView||function(t){return t&&lr.indexOf(Object.prototype.toString.call(t))>-1};function dr(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function br(t){return"string"!=typeof t&&(t=String(t)),t}function gr(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return ur&&(e[Symbol.iterator]=function(){return e}),e}function vr(t){this.map={},t instanceof vr?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function yr(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function mr(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function _r(t){var e=new FileReader,r=mr(e);return e.readAsArrayBuffer(t),r}function wr(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function Er(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:cr&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:hr&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:ar&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():fr&&cr&&function(t){return t&&DataView.prototype.isPrototypeOf(t)}(t)?(this._bodyArrayBuffer=wr(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):fr&&(ArrayBuffer.prototype.isPrototypeOf(t)||pr(t))?this._bodyArrayBuffer=wr(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):ar&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},cr&&(this.blob=function(){var t=yr(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?yr(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(_r)}),this.text=function(){var t,e,r,n=yr(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,r=mr(e=new FileReader),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},hr&&(this.formData=function(){return this.text().then(Tr)}),this.json=function(){return this.text().then(JSON.parse)},this}vr.prototype.append=function(t,e){t=dr(t),e=br(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},vr.prototype.delete=function(t){delete this.map[dr(t)]},vr.prototype.get=function(t){return t=dr(t),this.has(t)?this.map[t]:null},vr.prototype.has=function(t){return this.map.hasOwnProperty(dr(t))},vr.prototype.set=function(t,e){this.map[dr(t)]=br(e)},vr.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},vr.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),gr(t)},vr.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),gr(t)},vr.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),gr(t)},ur&&(vr.prototype[Symbol.iterator]=vr.prototype.entries);var Sr=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Ir(t,e){var r,n,i=(e=e||{}).body;if(t instanceof Ir){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new vr(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new vr(e.headers)),this.method=(n=(r=e.method||this.method||"GET").toUpperCase(),Sr.indexOf(n)>-1?n:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var o=/([?&])_=[^&]*/;o.test(this.url)?this.url=this.url.replace(o,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function Tr(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(i))}})),e}function kr(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"",this.headers=new vr(e.headers),this.url=e.url||"",this._initBody(t)}Ir.prototype.clone=function(){return new Ir(this,{body:this._bodyInit})},Er.call(Ir.prototype),Er.call(kr.prototype),kr.prototype.clone=function(){return new kr(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new vr(this.headers),url:this.url})},kr.error=function(){var t=new kr(null,{status:0,statusText:""});return t.type="error",t};var xr=[301,302,303,307,308];kr.redirect=function(t,e){if(-1===xr.indexOf(e))throw new RangeError("Invalid status code");return new kr(null,{status:e,headers:{location:t}})};var Or=sr.DOMException;function Cr(t,e){return new Promise((function(r,n){var i=new Ir(t,e);if(i.signal&&i.signal.aborted)return n(new Or("Aborted","AbortError"));var o=new XMLHttpRequest;function s(){o.abort()}o.onload=function(){var t,e,n={status:o.status,statusText:o.statusText,headers:(t=o.getAllResponseHeaders()||"",e=new vr,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();e.append(n,i)}})),e)};n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;setTimeout((function(){r(new kr(i,n))}),0)},o.onerror=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},o.ontimeout=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},o.onabort=function(){setTimeout((function(){n(new Or("Aborted","AbortError"))}),0)},o.open(i.method,function(t){try{return""===t&&sr.location.href?sr.location.href:t}catch(e){return t}}(i.url),!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&(cr?o.responseType="blob":fr&&i.headers.get("Content-Type")&&-1!==i.headers.get("Content-Type").indexOf("application/octet-stream")&&(o.responseType="arraybuffer")),i.headers.forEach((function(t,e){o.setRequestHeader(e,t)})),i.signal&&(i.signal.addEventListener("abort",s),o.onreadystatechange=function(){4===o.readyState&&i.signal.removeEventListener("abort",s)}),o.send(void 0===i._bodyInit?null:i._bodyInit)}))}function Dr(t){if(t.status>=200&&t.status<300)return t;var e=new Error(t.statusText);throw e.response=t,e.shouldNotRetry=t.status>=400&&t.status<=499,e}function Ar(t){var e=Math.floor(Math.random()*Math.pow(2,t))+1;return Math.round(100*e)}function Rr(t,e,r){return(t*e+r)/(e+1)}function Mr(t,e,r){return(t*e+r*r)/(e+1)}function Nr(t,e){return Math.sqrt(e-t*t)}function Fr(t,e,r,n,i){var o=t.get("bytesTotal")+r,s=Rr(t.get("bytesMean"),n,r),a=Mr(t.get("bytesMeanSquared"),n,r),u=Nr(s,a),c=8*o/(i/1e3),h=Rr(t.get("latencyMean"),n,e),f=Mr(t.get("latencyMeanSquared"),n,e);return{bitrateMean:c,bytesTotal:o,bytesMean:s,bytesMeanSquared:a,bytesStDev:u,latencyMean:h,latencyMeanSquared:f,latencyStDev:Nr(h,f),requestTimeTotal:i}}"function"!=typeof Or&&((Or=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack}).prototype=Object.create(Error.prototype),Or.prototype.constructor=Or),Cr.polyfill=!0,sr.fetch||(sr.fetch=Cr,sr.Headers=vr,sr.Request=Ir,sr.Response=kr);var Pr=function(t,e,r){return t.method=t.method||"GET",t.keepAlive=!0,$.Observable.create((function(r){fetch(t.url,t).then(Dr).then((function(t){return t[e]()})).then((function(t){r.onNext(t),r.onCompleted()})).catch((function(t){return r.onError(t)}))})).retryWhen((function(t){return t.scan((function(t,e){return{count:t.count+1,error:e}}),{count:0}).flatMap((function(t){if(t.error.shouldNotRetry||t.count>=r)throw t.error;var e=Ar(t.count);return l.navigator.onLine?$.Observable.timer(e):$.Observable.fromEvent(l,"online").take(1)}))}))},Ur=function(){return Z.Map({bitrateMean:0,requestTimeTotal:0,requestsStarted:0,requestsCompleted:0,requestsFailed:0,requestsSucceeded:0,bytesTotal:0,bytesMean:0,bytesMeanSquared:0,bytesStDev:0,latencyMean:0,latencyMeanSquared:0,latencyStDev:0,latencySucceedMean:0,latencySucceedMeanSquared:0,latencySucceedStDev:0,latencyFailMean:0,latencyFailMeanSquared:0,latencyFailStDev:0})},Lr=function(t,e,r){var n=Date.now()-t,i=e.byteLength,o=r.getIn(["network","currentTrack"]),s=o.get("requestTimeTotal")+n,a=o.get("requestsCompleted"),u=o.get("requestsSucceeded"),c=Rr(o.get("latencySucceedMean"),u,n),h=Mr(o.get("latencySucceedMeanSquared"),u,n),f=Nr(c,h),l=r.getIn(["network","session"]),p=l.get("requestTimeTotal")+n,d=l.get("requestsCompleted"),b=l.get("requestsSucceeded"),g=Rr(l.get("latencySucceedMean"),b,n),v=Mr(l.get("latencySucceedMeanSquared"),b,n),y=Nr(g,v);return{lastRequest:{bitrate:8*i/(n/1e3),latency:n,size:i,time:new Date(t)},currentTrack:Object.assign(Fr(o,n,i,a,s),{requestsSucceeded:u+1,requestsCompleted:a+1,latencySucceedMean:c,latencySucceedMeanSquared:h,latencySucceedStDev:f}),session:Object.assign(Fr(l,n,i,d,p),{requestsSucceeded:b+1,requestsCompleted:d+1,latencySucceedMean:g,latencySucceedMeanSquared:v,latencySucceedStDev:y})}},jr=function(t,e,r){var n=Date.now()-t,i=e.response&&JSON.stringify(e.response).length,o=r.getIn(["network","currentTrack"]),s=o.get("requestTimeTotal")+n,a=o.get("requestsCompleted"),u=o.get("requestsFailed"),c=Rr(o.get("latencyFailMean"),u,n),h=Mr(o.get("latencyFailMeanSquared"),u,n),f=Nr(c,h),l=r.getIn(["network","session"]),p=l.get("requestTimeTotal")+n,d=l.get("requestsCompleted"),b=l.get("requestsFailed"),g=Rr(l.get("latencyFailMean"),b,n),v=Mr(l.get("latencyFailMeanSquared"),b,n),y=Nr(g,g);return{lastRequest:{bitrate:8*i/(n/1e3),latency:n,size:i,time:new Date(t)},currentTrack:Object.assign(Fr(o,n,i,a,s),{requestsFailed:u+1,requestsCompleted:a+1,latencyFailMean:c,latencyFailMeanSquared:h,latencyFailStDev:f}),session:Object.assign(Fr(l,n,i,d,p),{requestsFailed:b+1,requestsCompleted:d+1,latencyFailMean:g,latencyFailMeanSquared:v,latencyFailStDev:y})}},qr=Z.Map({online:!0,lastRequest:null,currentTrack:Ur(),session:Ur()}),Br=function(){return new Z.Map({latestBandwidthBPS:null,bandwidthBPS:null})},zr=Z.Map({endedAt:null,initAt:null,pausedAt:null,resumedAt:null,stalledAt:null,startedAt:null,seekedAt:null}),Vr=St({abr:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Br(),e=arguments.length>1?arguments[1]:void 0;if(!e)return t;switch(e.type){case ge:return Br();case xe:return t.merge({latestBandwidthBPS:e.payload.abr.bandwidthBPS});case ke:return t.merge({latestBandwidthBPS:e.payload.abr.bandwidthBPS,bandwidthBPS:e.payload.abr.bandwidthBPS});default:return t}},cache:function(){var t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,n=arguments.length>1?arguments[1]:void 0;if(!n)return r;switch(n.type){case Bt:return t=n.payload.track.id,r.set(t,Z.fromJS(n.payload.track)).set("trackIds",Me(r.get("trackIds"),n));case zt:return r.remove(n.payload.trackId).set("trackIds",Me(r.get("trackIds"),n));case Wt:case Vt:return r.set(n.payload.track.get("id"),n.payload.track);case Gt:return t=n.payload.trackId,(r=r.mergeDeep(s({},t,{duration:n.payload.availableDuration,durationWithOffset:n.payload.availableDurationWithOffset,numOfAvailableSegments:n.payload.newNumOfAvailableSegments}))).getIn([t,"bitrateList"]).forEach((function(t){e=[n.payload.trackId,"bitrates",t,"fragments"],n.payload.newFragments=n.payload.newFragmentsForBitrate[t],r=r.setIn(e,Ae(r.getIn(e),n))})),r;case Xt:return t=n.payload.trackId,(r=r.mergeDeep(s({},t,{duration:n.payload.availableDuration,durationWithOffset:n.payload.availableDurationWithOffset,numOfAvailableSegments:n.payload.newNumOfAvailableSegments}))).getIn([t,"bitrateList"]).forEach((function(t){e=[n.payload.trackId,"bitrates",t,"fragments"],r=r.setIn(e,Ae(r.getIn(e),n))})),r;case Yt:return r.setIn([n.payload.trackId,"manifests"],Le(r.getIn([n.payload.trackId,"manifests"]),n)).setIn([n.payload.trackId,"manifestIds"],Ue(r.getIn([t,"manifestIds"]),n));case $t:case Jt:return r.setIn([n.payload.trackId,"manifests"],Le(r.getIn([n.payload.trackId,"manifests"]),n));case Qt:return r.setIn([n.payload.trackId,"isRequestingUTCTiming"],!0);case te:return r.setIn([n.payload.trackId,"isRequestingUTCTiming"],!1);case Zt:return t=n.payload.trackId,r.setIn([n.payload.trackId,"isRequestingUTCTiming"],!1);case ee:return r.setIn([n.payload.trackId,"serverTimeOffset"],n.payload.serverTimeOffset);case re:return r.setIn([n.payload.trackId,"waitingServerTimeSync"],!1);case Ht:return t=n.payload.track.get("id"),r.set(t,n.payload.track);case Kt:return t=n.payload.trackId,r=r.mergeDeep(s({},t,n.payload.data));case le:return r.setIn([n.payload.trackId,"dynamicTrackEnded"],!0);case Te:return r.setIn([n.payload.trackId,"supportedContentProtection"],n.payload.label);case ce:case he:case ae:case se:return Ne(r,n);case me:case _e:case we:case Ee:case Se:case Ie:if(t=n.payload.trackId,r.hasIn([t])){var i=n.payload.bitrate,o=n.payload.label,a=[t,"bitrates",i,"contentProtections",o];return r.setIn(a,Fe(r.getIn(a),n))}return r;case de:return r.get("trackIds").forEach((function(t){r.hasIn([t,"bitrates"])&&(r=r.setIn([t,"bitrates"],r.getIn([t,"bitrates"]).map((function(t){return(t=t.has("fragments")?t.set("fragments",t.get("fragments").map((function(t){return t.set("isRequesting",!1)}))):t).has("initialization")?t.setIn(["initialization","isRequesting"],!1):t}))))})),r;default:return r}},config:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.fromJS(Ce.initialConfig),e=arguments.length>1?arguments[1]:void 0;if(!e)return t;var r=e.payload?e.payload.config:{};switch(e.type){case ge:return t.mergeDeep(Z.fromJS(r));default:return t}},errors:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:or,e=arguments.length>1?arguments[1]:void 0;if(!e)return t;switch(e.type){case be:return t.set("count",t.get("count")+1).set("list",t.get("list").push(Z.fromJS(e.payload)).slice(-10));default:return t}},history:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt(),e=arguments.length>1?arguments[1]:void 0;return e?t.size<10?t.unshift(e):t.unshift(e).setSize(10):t},media:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nr(),r=arguments.length>1?arguments[1]:void 0;if(!r)return e;switch(r.type){case Bt:return e.get(r.payload.track.id)?e:e.set(r.payload.track.id,ir).updateIn([r.payload.track.id,"audioEl"],(function(){return Object.assign(e.get("_freeAudioEls").last(),{id:r.payload.track.id})})).update("_freeAudioEls",(function(t){return t.pop()})).update("_usedCount",(function(t){return t+1}));case zt:return e.get(r.payload.trackId)?e.update("_freeAudioEls",(function(t){if(e.get("_usedCount")-1+t.size<e.get("_limit")){var n=e.getIn([r.payload.trackId,"audioEl"]);return t.push(rr(n))}return t})).remove(r.payload.trackId).update("_usedCount",(function(t){return t-1})):e;case se:t=r.payload.trackId,e=e.mergeDeep(s({},t,{lastBufferedData:r.payload.fragment.get("data"),lastBufferedIndex:r.payload.fragment.get("index")}));case ae:case ne:case ie:case oe:return e.has(r.payload.trackId)?e.setIn([r.payload.trackId,"mediaSource"],Ve.mediaSource(e.getIn([r.payload.trackId,"mediaSource"]),r)):e;case Nt:case ve:case ye:return e.setIn([r.payload.trackId,"lastBufferedIndex"],void 0);case ue:return e.setIn([r.payload.trackId,"ranges"],Z.fromJS(r.payload.ranges));case Vt:return e.setIn([r.payload.track.get("id"),"lastBufferedIndex"],void 0);case Ht:return t=r.payload.track.get("id"),e.mergeDeep(s({},t,{lastBufferedIndex:void 0,lastBufferedData:void 0}));case ge:if(r.payload.config.hasOwnProperty("cacheSize")){var n=r.payload.config.cacheSize+1,i=e.get("_limit");if(n>i){for(var o=e.get("_freeAudioEls"),a=0;a<n-i;++a)o=o.push(er());return e.set("_freeAudioEls",o).set("_limit",n)}return e.set("_limit",n)}default:return e}},network:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qr,e=arguments.length>1?arguments[1]:void 0;if(!e)return t;switch(e.type){case pe:return t.set("online",!0);case de:return t.set("online",!1);case ce:return t.updateIn(["session","requestsStarted"],(function(t){return t+1})).updateIn(["currentTrack","requestsStarted"],(function(t){return t+1}));case fe:case he:return t.mergeDeep({lastRequest:e.payload.metrics.lastRequest,currentTrack:e.payload.metrics.currentTrack,session:e.payload.metrics.session});case xt:return t.set("currentTrack",Ur().set("id",e.payload.trackId));default:return t}},playback:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,e=arguments.length>1?arguments[1]:void 0;if(!e)return t;switch(e.type){case xt:return t.merge({id:e.payload.trackId,bitrate:e.payload.bitrate,codecs:e.payload.codecs,time:e.payload.time,duration:e.payload.duration,seeking:!0,started:!1});case kt:return t.merge({playing:!0,paused:!1,ended:!1});case Ot:return t.merge({playing:!1,paused:!0});case Ct:return t.merge({playing:!1,paused:!0,ended:!0,started:!1});case qt:return t.merge({started:!0,seeking:!1});case At:return t.set("muted",!t.get("muted"));case Dt:return t.set("repeating",!t.get("repeating"));case Mt:return t.set("time",e.payload.time);case Nt:return t.merge({time:e.payload.time,seeking:!0});case Ft:case ye:case ve:return t.merge({bitrate:e.payload.bitrate,codecs:e.payload.codecs});case Pt:return t.set("duration",e.payload.duration);case Rt:return t.set("volume",e.payload.volume);case Ut:return t.set("stalled",!0);case Lt:return t.set("stalled",!1);case jt:return t.merge({seeking:!1});case Ht:var r=e.payload.track&&e.payload.track.get("id");return t.get("id")===r?t.merge({bitrate:e.payload.playback.bitrate,time:e.payload.playback.time}):t;case Gt:case Xt:return t.set("duration",e.payload.availableDuration);case zt:return e.payload.trackId===t.get("id")?je.set("volume",t.get("volume")):t;default:return t}},playbackTimestamps:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zr,e=arguments.length>1?arguments[1]:void 0;if(!e)return t;switch(e.type){case xt:return zr.merge({initAt:Date.now()});case qt:return t.merge({startedAt:Date.now()});case kt:return t.merge({resumedAt:Date.now()});case Ot:return t.merge({pausedAt:Date.now()});case Ct:return t.merge({endedAt:Date.now()});case Nt:return t.merge({seekedAt:Date.now()});case Ut:return t.merge({stalledAt:Date.now()});default:return t}}}),Wr={exports:{}};function Hr(){var t=URLSearchParams&&new URLSearchParams(l.location&&l.location.search),e=t&&t.get("maestroLogs"),r={terse:!1,enabled:!1,serialize:!1};switch(e){case"":case"default":r.enabled=!1;break;case"1":case"on":case"true":r.enabled=!0;break;case"0":case"off":case"false":case void 0:case null:break;case"terse":r.enabled=!0,r.terse=!0;break;case"serialize":r.enabled=!0,r.serialize=!0;break;default:console.warn("unknown maestroLogs mode",e)}if(r.enabled){var n=function(t){var e=Z.Iterable.isIterable(t)?t.toJS():t;return r.serialize?JSON.stringify(e):e},i={collapsed:!0,predicate:function(t,e){return!r.serialize&&!r.terse||e.type!==Mt},stateTransformer:r.terse?function(){return"omitted"}:n,actionTransformer:n,errorTransformer:n};return r.serialize&&(i.titleFormatter=function(t,e){var r=JSON.parse(t);return"".concat(r.type," @ ").concat(e)}),Wr.exports.createLogger(i)}return null}!function(t,e){!function(t){function e(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}function r(t,e){Object.defineProperty(this,"kind",{value:t,enumerable:!0}),e&&e.length&&Object.defineProperty(this,"path",{value:e,enumerable:!0})}function n(t,e,r){n.super_.call(this,"E",t),Object.defineProperty(this,"lhs",{value:e,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}function i(t,e){i.super_.call(this,"N",t),Object.defineProperty(this,"rhs",{value:e,enumerable:!0})}function o(t,e){o.super_.call(this,"D",t),Object.defineProperty(this,"lhs",{value:e,enumerable:!0})}function s(t,e,r){s.super_.call(this,"A",t),Object.defineProperty(this,"index",{value:e,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})}function a(t,e,r){var n=t.slice((r||e)+1||t.length);return t.length=e<0?t.length+e:e,t.push.apply(t,n),t}function u(t){var e=void 0===t?"undefined":S(t);return"object"!==e?e:t===Math?"math":null===t?"null":Array.isArray(t)?"array":"[object Date]"===Object.prototype.toString.call(t)?"date":"function"==typeof t.toString&&/^\/.*\//.test(t.toString())?"regexp":"object"}function c(t,e,r,h,f,l,p){p=p||[];var d=(f=f||[]).slice(0);if(void 0!==l){if(h){if("function"==typeof h&&h(d,l))return;if("object"===(void 0===h?"undefined":S(h))){if(h.prefilter&&h.prefilter(d,l))return;if(h.normalize){var b=h.normalize(d,l,t,e);b&&(t=b[0],e=b[1])}}}d.push(l)}"regexp"===u(t)&&"regexp"===u(e)&&(t=t.toString(),e=e.toString());var g=void 0===t?"undefined":S(t),v=void 0===e?"undefined":S(e),y="undefined"!==g||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(l),m="undefined"!==v||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(l);if(!y&&m)r(new i(d,e));else if(!m&&y)r(new o(d,t));else if(u(t)!==u(e))r(new n(d,t,e));else if("date"===u(t)&&t-e!=0)r(new n(d,t,e));else if("object"===g&&null!==t&&null!==e)if(p.filter((function(e){return e.lhs===t})).length)t!==e&&r(new n(d,t,e));else{if(p.push({lhs:t,rhs:e}),Array.isArray(t)){var _;for(t.length,_=0;_<t.length;_++)_>=e.length?r(new s(d,_,new o(void 0,t[_]))):c(t[_],e[_],r,h,d,_,p);for(;_<e.length;)r(new s(d,_,new i(void 0,e[_++])))}else{var w=Object.keys(t),E=Object.keys(e);w.forEach((function(n,i){var o=E.indexOf(n);o>=0?(c(t[n],e[n],r,h,d,n,p),E=a(E,o)):c(t[n],void 0,r,h,d,n,p)})),E.forEach((function(t){c(void 0,e[t],r,h,d,t,p)}))}p.length=p.length-1}else t!==e&&("number"===g&&isNaN(t)&&isNaN(e)||r(new n(d,t,e)))}function h(t,e,r,n){return n=n||[],c(t,e,(function(t){t&&n.push(t)}),r),n.length?n:void 0}function f(t,e,r){if(t&&e&&r&&r.kind){for(var n=t,i=-1,o=r.path?r.path.length-1:0;++i<o;)void 0===n[r.path[i]]&&(n[r.path[i]]="number"==typeof r.path[i]?[]:{}),n=n[r.path[i]];switch(r.kind){case"A":!function t(e,r,n){if(n.path&&n.path.length){var i,o=e[r],s=n.path.length-1;for(i=0;i<s;i++)o=o[n.path[i]];switch(n.kind){case"A":t(o[n.path[i]],n.index,n.item);break;case"D":delete o[n.path[i]];break;case"E":case"N":o[n.path[i]]=n.rhs}}else switch(n.kind){case"A":t(e[r],n.index,n.item);break;case"D":e=a(e,r);break;case"E":case"N":e[r]=n.rhs}return e}(r.path?n[r.path[i]]:n,r.index,r.item);break;case"D":delete n[r.path[i]];break;case"E":case"N":n[r.path[i]]=r.rhs}}}function l(t){return"color: "+k[t].color+"; font-weight: bold"}function d(t,e,r,n){var i=h(t,e);try{n?r.groupCollapsed("diff"):r.group("diff")}catch(t){r.log("diff")}i?i.forEach((function(t){var e=t.kind,n=function(t){var e=t.kind,r=t.path,n=t.lhs,i=t.rhs,o=t.index,s=t.item;switch(e){case"E":return[r.join("."),n,"→",i];case"N":return[r.join("."),i];case"D":return[r.join(".")];case"A":return[r.join(".")+"["+o+"]",s];default:return[]}}(t);r.log.apply(r,["%c "+k[e].text,l(e)].concat(I(n)))})):r.log("—— no diff ——");try{r.groupEnd()}catch(t){r.log("—— diff end —— ")}}function b(t,e,r,n){switch(void 0===t?"undefined":S(t)){case"object":return"function"==typeof t[n]?t[n].apply(t,I(r)):t[n];case"function":return t(e);default:return t}}function g(t,e){var r=e.logger,n=e.actionTransformer,i=e.titleFormatter,o=void 0===i?function(t){var e=t.timestamp,r=t.duration;return function(t,n,i){var o=["action"];return o.push("%c"+String(t.type)),e&&o.push("%c@ "+n),r&&o.push("%c(in "+i.toFixed(2)+" ms)"),o.join(" ")}}(e):i,s=e.collapsed,a=e.colors,u=e.level,c=e.diff,h=void 0===e.titleFormatter;t.forEach((function(i,f){var l=i.started,p=i.startedTime,g=i.action,v=i.prevState,y=i.error,m=i.took,_=i.nextState,E=t[f+1];E&&(_=E.prevState,m=E.started-l);var S=n(g),I="function"==typeof s?s((function(){return _}),g,i):s,T=w(p),k=a.title?"color: "+a.title(S)+";":"",x=["color: gray; font-weight: lighter;"];x.push(k),e.timestamp&&x.push("color: gray; font-weight: lighter;"),e.duration&&x.push("color: gray; font-weight: lighter;");var O=o(S,T,m);try{I?a.title&&h?r.groupCollapsed.apply(r,["%c "+O].concat(x)):r.groupCollapsed(O):a.title&&h?r.group.apply(r,["%c "+O].concat(x)):r.group(O)}catch(t){r.log(O)}var C=b(u,S,[v],"prevState"),D=b(u,S,[S],"action"),A=b(u,S,[y,v],"error"),R=b(u,S,[_],"nextState");if(C)if(a.prevState){var M="color: "+a.prevState(v)+"; font-weight: bold";r[C]("%c prev state",M,v)}else r[C]("prev state",v);if(D)if(a.action){var N="color: "+a.action(S)+"; font-weight: bold";r[D]("%c action    ",N,S)}else r[D]("action    ",S);if(y&&A)if(a.error){var F="color: "+a.error(y,v)+"; font-weight: bold;";r[A]("%c error     ",F,y)}else r[A]("error     ",y);if(R)if(a.nextState){var P="color: "+a.nextState(_)+"; font-weight: bold";r[R]("%c next state",P,_)}else r[R]("next state",_);c&&d(v,_,r,I);try{r.groupEnd()}catch(t){r.log("—— log end ——")}}))}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},x,t),r=e.logger,n=e.stateTransformer,i=e.errorTransformer,o=e.predicate,s=e.logErrors,a=e.diffPredicate;if(void 0===r)return function(){return function(t){return function(e){return t(e)}}};if(t.getState&&t.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(t){return function(e){return t(e)}}};var u=[];return function(t){var r=t.getState;return function(t){return function(c){if("function"==typeof o&&!o(r,c))return t(c);var h={};u.push(h),h.started=E.now(),h.startedTime=new Date,h.prevState=n(r()),h.action=c;var f=void 0;if(s)try{f=t(c)}catch(t){h.error=i(t)}else f=t(c);h.took=E.now()-h.started,h.nextState=n(r());var l=e.diff&&"function"==typeof a?a(r,c):e.diff;if(g(u,Object.assign({},e,{diff:l})),u.length=0,h.error)throw h.error;return f}}}}var y,m,_=function(t,e){return function(t,e){return new Array(e+1).join(t)}("0",e-t.toString().length)+t},w=function(t){return _(t.getHours(),2)+":"+_(t.getMinutes(),2)+":"+_(t.getSeconds(),2)+"."+_(t.getMilliseconds(),3)},E="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},T=[];y="object"===(void 0===p?"undefined":S(p))&&p?p:"undefined"!=typeof window?window:{},(m=y.DeepDiff)&&T.push((function(){void 0!==m&&y.DeepDiff===h&&(y.DeepDiff=m,m=void 0)})),e(n,r),e(i,r),e(o,r),e(s,r),Object.defineProperties(h,{diff:{value:h,enumerable:!0},observableDiff:{value:c,enumerable:!0},applyDiff:{value:function(t,e,r){t&&e&&c(t,e,(function(n){r&&!r(t,e,n)||f(t,e,n)}))},enumerable:!0},applyChange:{value:f,enumerable:!0},revertChange:{value:function(t,e,r){if(t&&e&&r&&r.kind){var n,i,o=t;for(i=r.path.length-1,n=0;n<i;n++)void 0===o[r.path[n]]&&(o[r.path[n]]={}),o=o[r.path[n]];switch(r.kind){case"A":!function t(e,r,n){if(n.path&&n.path.length){var i,o=e[r],s=n.path.length-1;for(i=0;i<s;i++)o=o[n.path[i]];switch(n.kind){case"A":t(o[n.path[i]],n.index,n.item);break;case"D":case"E":o[n.path[i]]=n.lhs;break;case"N":delete o[n.path[i]]}}else switch(n.kind){case"A":t(e[r],n.index,n.item);break;case"D":case"E":e[r]=n.lhs;break;case"N":e=a(e,r)}return e}(o[r.path[n]],r.index,r.item);break;case"D":case"E":o[r.path[n]]=r.lhs;break;case"N":delete o[r.path[n]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==m},enumerable:!0},noConflict:{value:function(){return T&&(T.forEach((function(t){t()})),T=null),h},enumerable:!0}});var k={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},x={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(t){return t},actionTransformer:function(t){return t},errorTransformer:function(t){return t},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},O=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dispatch,r=t.getState;return"function"==typeof e||"function"==typeof r?v()({dispatch:e,getState:r}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};t.defaults=x,t.createLogger=v,t.logger=O,t.default=O,Object.defineProperty(t,"__esModule",{value:!0})}(e)}(0,Wr.exports);var Kr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.Map(),e=[ft],r=Hr();null!==r&&e.push(r);var n=l&&l.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?l.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({name:"Maestro"}):ut;return it(Vr,t,n(ct.apply(void 0,e)))};function Gr(t){return $.Observable.create((function(e){return t.subscribe((function(){return e.onNext(t.getState())}))}))}var Xr={};
/*! codem-isoboxer v0.3.7 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */function Yr(t,e){if(t)for(var r=0;r<t.size;r++){var n=t.get(r),i=n.get(0),o=n.get(1);if(e>=i&&e<=o)return n}}!function(t){var e={parseBuffer:function(t){return new r(t).parse()},addBoxProcessor:function(t,e){"string"==typeof t&&"function"==typeof e&&(n.prototype._boxProcessors[t]=e)},createFile:function(){return new r},createBox:function(t,e,r){var i=n.create(t);return e&&e.append(i,r),i},createFullBox:function(t,r,n){var i=e.createBox(t,r,n);return i.version=0,i.flags=0,i},Utils:{}};e.Utils.dataViewToString=function(t,e){var r=e||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(r).decode(t);var n=[],i=0;if("utf-8"===r)for(;i<t.byteLength;){var o=t.getUint8(i++);o<128||(o<224?(o=(31&o)<<6,o|=63&t.getUint8(i++)):o<240?(o=(15&o)<<12,o|=(63&t.getUint8(i++))<<6,o|=63&t.getUint8(i++)):(o=(7&o)<<18,o|=(63&t.getUint8(i++))<<12,o|=(63&t.getUint8(i++))<<6,o|=63&t.getUint8(i++))),n.push(String.fromCharCode(o))}else for(;i<t.byteLength;)n.push(String.fromCharCode(t.getUint8(i++)));return n.join("")},e.Utils.utf8ToByteArray=function(t){var e,r;if("undefined"!=typeof TextEncoder)e=(new TextEncoder).encode(t);else for(e=[],r=0;r<t.length;++r){var n=t.charCodeAt(r);n<128?e.push(n):n<2048?(e.push(192|n>>6),e.push(128|63&n)):n<65536?(e.push(224|n>>12),e.push(128|63&n>>6),e.push(128|63&n)):(e.push(240|n>>18),e.push(128|63&n>>12),e.push(128|63&n>>6),e.push(128|63&n))}return e},e.Utils.appendBox=function(t,e,r){if(e._offset=t._cursor.offset,e._root=t._root?t._root:t,e._raw=t._raw,e._parent=t,-1!==r)if(null!=r){var n,i=-1;if("number"==typeof r)i=r;else{if("string"==typeof r)n=r;else{if("object"!=typeof r||!r.type)return void t.boxes.push(e);n=r.type}for(var o=0;o<t.boxes.length;o++)if(n===t.boxes[o].type){i=o+1;break}}t.boxes.splice(i,0,e)}else t.boxes.push(e)},t.parseBuffer=e.parseBuffer,t.addBoxProcessor=e.addBoxProcessor,t.createFile=e.createFile,t.createBox=e.createBox,t.createFullBox=e.createFullBox,t.Utils=e.Utils,e.Cursor=function(t){this.offset=void 0===t?0:t};var r=function(t){this._cursor=new e.Cursor,this.boxes=[],t&&(this._raw=new DataView(t))};r.prototype.fetch=function(t){var e=this.fetchAll(t,!0);return e.length?e[0]:null},r.prototype.fetchAll=function(t,e){var n=[];return r._sweep.call(this,t,n,e),n},r.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var t=n.parse(this);if(void 0===t.type)break;this.boxes.push(t)}return this},r._sweep=function(t,e,n){for(var i in this.type&&this.type==t&&e.push(this),this.boxes){if(e.length&&n)return;r._sweep.call(this.boxes[i],t,e,n)}},r.prototype.write=function(){var t,e=0;for(t=0;t<this.boxes.length;t++)e+=this.boxes[t].getLength(!1);var r=new Uint8Array(e);for(this._rawo=new DataView(r.buffer),this.bytes=r,this._cursor.offset=0,t=0;t<this.boxes.length;t++)this.boxes[t].write();return r.buffer},r.prototype.append=function(t,r){e.Utils.appendBox(this,t,r)};var n=function(){this._cursor=new e.Cursor};n.parse=function(t){var e=new n;return e._offset=t._cursor.offset,e._root=t._root?t._root:t,e._raw=t._raw,e._parent=t,e._parseBox(),t._cursor.offset=e._raw.byteOffset+e._raw.byteLength,e},n.create=function(t){var e=new n;return e.type=t,e.boxes=[],e},n.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],n.prototype._boxProcessors={},n.prototype._procField=function(t,e,r){this._parsing?this[t]=this._readField(e,r):this._writeField(e,r,this[t])},n.prototype._procFieldArray=function(t,e,r,n){var i;if(this._parsing)for(this[t]=[],i=0;i<e;i++)this[t][i]=this._readField(r,n);else for(i=0;i<this[t].length;i++)this._writeField(r,n,this[t][i])},n.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},n.prototype._procEntries=function(t,e,r){var n;if(this._parsing)for(this[t]=[],n=0;n<e;n++)this[t].push({}),r.call(this,this[t][n]);else for(n=0;n<e;n++)r.call(this,this[t][n])},n.prototype._procSubEntries=function(t,e,r,n){var i;if(this._parsing)for(t[e]=[],i=0;i<r;i++)t[e].push({}),n.call(this,t[e][i]);else for(i=0;i<r;i++)n.call(this,t[e][i])},n.prototype._procEntryField=function(t,e,r,n){this._parsing?t[e]=this._readField(r,n):this._writeField(r,n,t[e])},n.prototype._procSubBoxes=function(t,e){var r;if(this._parsing)for(this[t]=[],r=0;r<e;r++)this[t].push(n.parse(this));else for(r=0;r<e;r++)this._rawo?this[t][r].write():this.size+=this[t][r].getLength()},n.prototype._readField=function(t,e){switch(t){case"uint":return this._readUint(e);case"int":return this._readInt(e);case"template":return this._readTemplate(e);case"string":return-1===e?this._readTerminatedString():this._readString(e);case"data":return this._readData(e);case"utf8":return this._readUTF8String();default:return-1}},n.prototype._readInt=function(t){var e=null,r=this._cursor.offset-this._raw.byteOffset;switch(t){case 8:e=this._raw.getInt8(r);break;case 16:e=this._raw.getInt16(r);break;case 32:e=this._raw.getInt32(r);break;case 64:var n=this._raw.getInt32(r),i=this._raw.getInt32(r+4);e=n*Math.pow(2,32)+i}return this._cursor.offset+=t>>3,e},n.prototype._readUint=function(t){var e,r,n=null,i=this._cursor.offset-this._raw.byteOffset;switch(t){case 8:n=this._raw.getUint8(i);break;case 16:n=this._raw.getUint16(i);break;case 24:n=((e=this._raw.getUint16(i))<<8)+(r=this._raw.getUint8(i+2));break;case 32:n=this._raw.getUint32(i);break;case 64:e=this._raw.getUint32(i),r=this._raw.getUint32(i+4),n=e*Math.pow(2,32)+r}return this._cursor.offset+=t>>3,n},n.prototype._readString=function(t){for(var e="",r=0;r<t;r++){var n=this._readUint(8);e+=String.fromCharCode(n)}return e},n.prototype._readTemplate=function(t){return this._readUint(t/2)+this._readUint(t/2)/Math.pow(2,t/2)},n.prototype._readTerminatedString=function(){for(var t="";this._cursor.offset-this._offset<this._raw.byteLength;){var e=this._readUint(8);if(0===e)break;t+=String.fromCharCode(e)}return t},n.prototype._readData=function(t){var e=t>0?t:this._raw.byteLength-(this._cursor.offset-this._offset);if(e>0){var r=new Uint8Array(this._raw.buffer,this._cursor.offset,e);return this._cursor.offset+=e,r}return null},n.prototype._readUTF8String=function(){var t=this._raw.byteLength-(this._cursor.offset-this._offset),r=null;return t>0&&(r=new DataView(this._raw.buffer,this._cursor.offset,t),this._cursor.offset+=t),r?e.Utils.dataViewToString(r):r},n.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},n.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},n.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(n.parse(this))},n.prototype.append=function(t,r){e.Utils.appendBox(this,t,r)},n.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var t=0;t<this.boxes.length;t++)this.size+=this.boxes[t].getLength();return this._data&&this._writeData(this._data),this.size},n.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var t=0;t<this.boxes.length;t++)this.boxes[t].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},n.prototype._writeInt=function(t,e){if(this._rawo){var r=this._cursor.offset-this._rawo.byteOffset;switch(t){case 8:this._rawo.setInt8(r,e);break;case 16:this._rawo.setInt16(r,e);break;case 32:this._rawo.setInt32(r,e);break;case 64:var n=Math.floor(e/Math.pow(2,32)),i=e-n*Math.pow(2,32);this._rawo.setUint32(r,n),this._rawo.setUint32(r+4,i)}this._cursor.offset+=t>>3}else this.size+=t>>3},n.prototype._writeUint=function(t,e){if(this._rawo){var r,n,i=this._cursor.offset-this._rawo.byteOffset;switch(t){case 8:this._rawo.setUint8(i,e);break;case 16:this._rawo.setUint16(i,e);break;case 24:r=(16776960&e)>>8,n=255&e,this._rawo.setUint16(i,r),this._rawo.setUint8(i+2,n);break;case 32:this._rawo.setUint32(i,e);break;case 64:n=e-(r=Math.floor(e/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,r),this._rawo.setUint32(i+4,n)}this._cursor.offset+=t>>3}else this.size+=t>>3},n.prototype._writeString=function(t,e){for(var r=0;r<t;r++)this._writeUint(8,e.charCodeAt(r))},n.prototype._writeTerminatedString=function(t){if(0!==t.length){for(var e=0;e<t.length;e++)this._writeUint(8,t.charCodeAt(e));this._writeUint(8,0)}},n.prototype._writeTemplate=function(t,e){var r=Math.floor(e),n=(e-r)*Math.pow(2,t/2);this._writeUint(t/2,r),this._writeUint(t/2,n)},n.prototype._writeData=function(t){if(t)if(this._rawo){if(t instanceof Array){for(var e=this._cursor.offset-this._rawo.byteOffset,r=0;r<t.length;r++)this._rawo.setInt8(e+r,t[r]);this._cursor.offset+=t.length}t instanceof Uint8Array&&(this._root.bytes.set(t,this._cursor.offset),this._cursor.offset+=t.length)}else this.size+=t.length},n.prototype._writeUTF8String=function(t){var r=e.Utils.utf8ToByteArray(t);if(this._rawo)for(var n=new DataView(this._rawo.buffer,this._cursor.offset,r.length),i=0;i<r.length;i++)n.setUint8(i,r[i]);else this.size+=r.length},n.prototype._writeField=function(t,e,r){switch(t){case"uint":this._writeUint(e,r);break;case"int":this._writeInt(e,r);break;case"template":this._writeTemplate(e,r);break;case"string":-1==e?this._writeTerminatedString(r):this._writeString(e,r);break;case"data":this._writeData(r);break;case"utf8":this._writeUTF8String(r)}},n.prototype._boxProcessors.avc1=n.prototype._boxProcessors.avc2=n.prototype._boxProcessors.avc3=n.prototype._boxProcessors.avc4=n.prototype._boxProcessors.hvc1=n.prototype._boxProcessors.hev1=n.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},n.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},n.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(t){this._procEntryField(t,"segment_duration","uint",1===this.version?64:32),this._procEntryField(t,"media_time","int",1===this.version?64:32),this._procEntryField(t,"media_rate_integer","int",16),this._procEntryField(t,"media_rate_fraction","int",16)}))},n.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},n.prototype._boxProcessors.free=n.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},n.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},n.prototype._boxProcessors.ftyp=n.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var t=-1;this._parsing&&(t=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",t,"string",4)},n.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},n.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},n.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},n.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},n.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},n.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},n.prototype._boxProcessors.mp4a=n.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},n.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},n.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},n.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},n.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},n.prototype._boxProcessors.sdtp=function(){this._procFullBox();var t=-1;this._parsing&&(t=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",t,"uint",8)},n.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(t){this._parsing||(t.reference=(1&t.reference_type)<<31,t.reference|=2147483647&t.referenced_size,t.sap=(1&t.starts_with_SAP)<<31,t.sap|=(3&t.SAP_type)<<28,t.sap|=268435455&t.SAP_delta_time),this._procEntryField(t,"reference","uint",32),this._procEntryField(t,"subsegment_duration","uint",32),this._procEntryField(t,"sap","uint",32),this._parsing&&(t.reference_type=t.reference>>31&1,t.referenced_size=2147483647&t.reference,t.starts_with_SAP=t.sap>>31&1,t.SAP_type=t.sap>>28&7,t.SAP_delta_time=268435455&t.sap)}))},n.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},n.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(t){this._procEntryField(t,"ranges_count","uint",32),this._procSubEntries(t,"ranges",t.ranges_count,(function(t){this._procEntryField(t,"level","uint",8),this._procEntryField(t,"range_size","uint",24)}))}))},n.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},n.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(t){this._procEntryField(t,"sample_delta","uint",32),this._procEntryField(t,"subsample_count","uint",16),this._procSubEntries(t,"subsamples",t.subsample_count,(function(t){this._procEntryField(t,"subsample_size","uint",1===this.version?32:16),this._procEntryField(t,"subsample_priority","uint",8),this._procEntryField(t,"discardable","uint",8),this._procEntryField(t,"codec_specific_parameters","uint",32)}))}))},n.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},n.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},n.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},n.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(t){this._procEntryField(t,"time","uint",1===this.version?64:32),this._procEntryField(t,"moof_offset","uint",1===this.version?64:32),this._procEntryField(t,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(t,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(t,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},n.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},n.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},n.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(t){256&this.flags&&this._procEntryField(t,"sample_duration","uint",32),512&this.flags&&this._procEntryField(t,"sample_size","uint",32),1024&this.flags&&this._procEntryField(t,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(t,"sample_composition_time_offset",1===this.version?"int":"uint",32)}))},n.prototype._boxProcessors["url "]=n.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},n.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},n.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},n.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},n.prototype._boxProcessors.vtte=function(){}}(Xr);var Jr={bufferToRanges:function(t){try{for(var e=t.buffered.length,r=[],n=0;n<e;n++){var i=t.buffered.start(n),o=t.buffered.end(n);r.push([i,o])}return r}catch(t){return[]}},getRange:Yr,bufferedAheadOf:function(t,e){var r=Yr(t,e);return r?r.get(1)-e:e},bufferedBehindBy:function(t,e){if(0===t.size)return 0;var r=0;return t.forEach((function(t){t.get(0)<e&&(r+=Math.min(e,t.get(1))-t.get(0))})),r},getBufferedDuration:function(t){return t.reduce((function(t,e){var r=a(e,2),n=r[0];return r[1]-n+t}),0)}},$r=function(t,e,r){var n="\\$".concat(e,"\\$");return t.replace(new RegExp(n,"g"),r)},Qr=function(t,e){return Number(Math.floor(t+"e"+e)+"e-"+e)},Zr="DASH",tn="HLS",en={DASH:"mpd",HLS:"m3u8"},rn="com.apple.fps.1_0",nn="com.widevine.alpha",on="com.microsoft.playready",sn={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":{label:nn,initKey:"cenc:pssh"},"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":{label:on,initKey:"mspr:pro"}},an="cenc";function un(t,e){return e.getIn(["cache",t])}function cn(t,e){return e.getIn(["media",t,"mediaSource","readyState"])}function hn(t,e){return t.getIn(["bitrates",e,"fragments"])}function fn(t,e,r){return isNaN(t)?0:-1===t?Jr.getRange(r,e)?1:0:Jr.getRange(r,t+.1)?1:0}function ln(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.floor(e/t)-r}function pn(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return t.get(ln(e,r,n))}function dn(t){var e=Date.now()/1e3-function(t){var e=isNaN(t.get("serverTimeOffset"))?0:t.get("serverTimeOffset");return t.get("availabilityStartTime")-e}(t)+function(t){return t.get("fragmentDuration")*t.get("startNumber")}(t);return Math.max(0,Qr(e,2))}function bn(t){var e=dn(t)-t.get("suggestedPresentationDelay")-t.get("minBufferTime");return Math.max(0,Qr(e,2))}function gn(t,e){return Xr.parseBuffer(t).fetch(e)}function vn(t){var e=Z.Map.isMap(t),r=e?t.get("extension"):t.extension;if(r)switch(r){case en.DASH:return Zr;case en.HLS:return tn;default:return}var n=e?t.get("url"):t.url;return n&&n.includes(".mpd")?Zr:n&&n.includes(".m3u8")?tn:void 0}var yn={getTrack:un,getCurrentTrack:function(t){return un(t.getIn(["playback","id"]),t)},isFullyBuffered:function(t,e){var r=e.getIn(["cache",t,"duration"]),n=e.getIn(["media",t,"ranges"]);return Jr.getBufferedDuration(n)>=r-.01},getMediaReadyState:cn,getCurrentMediaReadyState:function(t){return cn(t.getIn(["playback","id"]),t)},getNextFragmentToFetch:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=t.get("isDynamic")?bn(t):n,s=t.get("fragmentDuration"),a=Math.floor(o/s)-t.get("fragmentIndexOffset"),u=Math.ceil(i/s);return hn(t,e).slice(a,a+u).filter((function(t){return!fn(t.get("startTime"),t.get("endTime"),r)})).filter((function(t){return!t.get("isRequesting")&&!t.get("data")})).first()},getNextFragmentToAppend:function(t){var e=t.fragments,r=t.lastBufferedIndex,n=t.defaultStartIndex,i=void 0===n?0:n,o=t.fragmentIndexOffset;void 0===r&&(r=i-1);var s=r+1-(void 0===o?0:o),a=e.get(s);if(a&&a.get("data"))return a},getCurrentNextFragmentToAppend:function(t){var e,r=t.time,n=t.ranges,i=t.fragments,o=t.fragmentDuration,s=t.lastBufferedIndex,a=t.fragmentIndexOffset,u=void 0===a?0:a;return n&&0!==n.size?function(t,e,r){var n=t.slice(r,t.size).filter((function(t){return!fn(t.get("startTime"),t.get("endTime"),e)})).first();return n&&n.get("data")?n:void 0}(i,n,Jr.getRange(n,r)&&s>=0?s+1-u:ln(o,r,u)):(e=pn(i,o,r,u))&&e.get("data")?e:void 0},getFragmentAtTime:pn,getInitFragment:function(t,e){return t.getIn(["bitrates",e.toString(),"initialization"])},getFragmentsForBitrate:hn,getMimeType:function(t,e){var r=t.getIn(["bitrates",e]);return"".concat(r.get("mimeType"),';codecs="').concat(r.get("codecs"),'"')},getMediaKeySessionType:function(t,e){var r=t.getIn(["bitrates",e]);return Ze.isSafari()?r.get("mimeType"):"".concat(r.get("mimeType"),';codecs="').concat(r.get("codecs"),'"')},getBitrate:function(t,e){var r=Z.Map.isMap(t)?t:e.getIn(["cache",t]);if(r&&(vn(r)!==Zr||r.get("fragmented"))){var n=e.getIn(["playback","id"]);return r.get("id")===n&&e.getIn(["playback","bitrate"])?e.getIn(["playback","bitrate"]):r.get("startBitrate")}},isRequestingAFragment:function(t,e){var r,n=f(hn(t,e));try{for(n.s();!(r=n.n()).done;)if(r.value.get("isRequesting"))return!0}catch(t){n.e(t)}finally{n.f()}return!1},isFragmentRequestable:function(t,e,r){if(!t)return!1;var n=t.get("isRequesting"),i=!!t.get("data"),o=fn(t.get("startTime"),t.get("endTime"),r);return!(n||i||o)},getDynamicTrackDuration:dn,getDynamicTrackDurationWithOffset:bn,getNewFragmentForDynamicTrack:function(t,e,r){var n=t.getIn(["bitrates",e,"urlTemplate"]);return{url:$r(n,"Number",r),data:null,index:r,endTime:-1,startTime:-1,isRequesting:!1,isBuffering:!1}},getEMSGEvents:function(t,e){var r=t.get("inbandEventStreams"),n=gn(e,"emsg"),i=[];if(r&&n){var o=n.scheme_id_uri;r.forEach((function(t){var e=t.toJS();if(e.schemeIdUri===o){var r=Object.assign({},e,{presentationTimeDelta:n.presentation_time_delta,schemeIdUri:o,messageData:n.message_data,value:n.value,id:n.id});i.push(r)}}))}return i},isFragmentInBufferedRanges:fn,getIndexForFragment:function(t,e){var r=e.get("index");return void 0===r?void 0:r-t.get("fragmentIndexOffset")},getFragmentStartTime:function(t){var e=gn(t,"sidx");return e&&e.timescale?e.earliest_presentation_time/e.timescale:-1},getFragmentEndTime:function(t){return t&&0!==t.length?t[t.length-1][1]:-1},getTrackContentProtection:function(t,e){return t&&t.get("supportedContentProtection")?t.getIn(["bitrates",e,"contentProtections",t.get("supportedContentProtection")]):null},getTrackProtocol:vn,isProgressiveTrack:function(t){var e=t.get("extension");if(e)return!Object.values(en).includes(e);var r=t.get("url");return!Object.values(en).find((function(t){return r.includes(t)}))}},mn=function(t,e){return t<e-1||t>e+1},_n=function(t){var e=yn.getCurrentTrack(t);if(!e||!t.getIn(["playback","bitrate"]))return null;var r=e.get("bitrateList"),n=t.getIn(["playback","bitrate"]);return r.get(r.indexOf(n)+1)||r.last()},wn=function(t,e){var r=Z.Map.isMap(t)?t.get("bitrateList"):Z.List(t.bitrateList);return r.find((function(t){return e>=t}))||r.last()},En=function(){return{type:kt}},Sn=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(r,n){var i,o,s,a=n(),u=a.getIn(["cache",t]);a.getIn(["playback","id"])===t?(i=a.getIn(["playback","bitrate"]),o=a.getIn(["playback","codecs"]),s=a.getIn(["playback","duration"])):(i=yn.getBitrate(t,a),o=u.getIn(["bitrates",i,"codecs"]),s=u.get("duration")),r({type:xt,payload:{trackId:t,bitrate:i,codecs:o,time:e,duration:s}})}},In=function(){return{type:Ot}},Tn=function(){return{type:Ct}},kn=function(){return{type:Dt}},xn=function(){return{type:qt}},On=function(){return{type:At}},Cn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{type:Mt,payload:{time:t}}},Dn=function(t){return function(e,r){var n=r(),i=n.getIn(["playback","time"]);if(mn(t,i)){var o=!1,s=yn.getCurrentTrack(n),a=s&&s.get("id");if(s&&s.get("fragmented")){var u=n.getIn(["media",a,"ranges"]);if(0===t){var c=u.first();if(c){var h=c.first();h<1&&(t=h)}}else{var f=n.getIn(["media",a,"ranges"]);Jr.getRange(f,t)||(o=!0)}}e({type:Nt,payload:{trackId:a,time:t,seekToUnbufferedPosition:o}})}}},An=function(t){return{type:Rt,payload:{volume:t}}},Rn=function(t){return{type:Pt,payload:{duration:t}}},Mn=function(){return function(t,e){var r=e(),n=yn.getCurrentTrack(r);if(n&&r.getIn(["playback","bitrate"])){var i=r.getIn(["abr","bandwidthBPS"]);if(i>=0){var o=wn(n,i),s=n.getIn(["bitrates",o,"codecs"]);t({type:Ft,payload:{bitrate:o,codecs:s}})}}}},Nn=function(){return{type:Ut}},Fn=function(){return{type:Lt}},Pn=function(){return{type:jt}},Un=function(){return function(t,e){var r=e(),n=yn.getCurrentTrack(r);if(n){var i=n.get("bitrateList"),o=r.getIn(["playback","bitrate"]),s=i.get(i.indexOf(o)+1);if(s){var a=n.getIn(["bitrates",s,"codecs"]);t({type:ve,payload:{bitrate:s,codecs:a}})}}}},Ln=function(){return function(t,e){var r=e(),n=yn.getCurrentTrack(r);if(n){var i=n.get("bitrateList"),o=r.getIn(["playback","bitrate"]),s=i.indexOf(o)-1>=0?i.get(i.indexOf(o)-1):null;if(s){var a=n.getIn(["bitrates",s,"codecs"]);t({type:ye,payload:{bitrate:s,codecs:a}})}}}},jn=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.timestamp=Date.now(),{type:be,payload:{error:t,extra:e}}},qn="NETWORK_ERROR",Bn="MEDIA_SOURCE_CODECS_NOT_SUPPORTED",zn="MEDIA_SOURCE_ERROR",Vn="SOURCE_BUFFER_ERROR",Wn="AUDIO_ERROR",Hn="MANIFEST_SANITIZATION_ERROR",Kn="EME_LICENSE_EXCHANGE_FAILED",Gn=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,Xn=/([0-9]+)-([0-9]+)/;function Yn(t){return new Date(Date.parse(t))}function Jn(t){return t}function $n(t){return"true"===t}function Qn(t){if(!t)return 0;if(t.match(/^\d+/))return parseInt(t,10);var e=Gn.exec(t);return 365*parseFloat(e[2]||0)*24*60*60+30*parseFloat(e[4]||0)*24*60*60+24*parseFloat(e[6]||0)*60*60+60*parseFloat(e[8]||0)*60+60*parseFloat(e[10]||0)+parseFloat(e[12]||0)}function Zn(t){return"true"===t||"false"!==t&&parseInt(t,10)}function ti(t){var e=Xn.exec(t);return e?[+e[1],+e[2]]:null}var ei={id:Jn,profiles:Jn,type:Jn,availabilityStartTime:Yn,availabilityEndTime:Yn,publishTime:Yn,mediaPresentationDuration:Qn,minimumUpdatePeriod:Qn,minBufferTime:Qn,timeShiftBufferDepth:Qn,suggestedPresentationDelay:Qn,maxSegmentDuration:Qn,maxSubsegmentDuration:Qn,start:Qn,duration:Qn,bitstreamSwitching:$n,group:parseInt,lang:Jn,contentType:Jn,par:Jn,minBandwidth:parseInt,maxBandwidth:parseInt,minWidth:parseInt,maxWidth:parseInt,minHeight:parseInt,maxHeight:parseInt,minFrameRate:Jn,maxFrameRate:Jn,segmentAlignment:Zn,subsegmentAlignment:Zn,bandwidth:parseInt,qualityRanking:parseInt,index:Jn,media:Jn,mediaRange:ti,indexRange:ti,schemeIdUri:Jn,value:Jn,startNumber:parseInt,timescale:parseInt,presentationTimeOffset:parseFloat,indexRangeExact:$n,availabilityTimeOffset:parseFloat,availabilityTimeComplete:$n,width:parseInt,height:parseInt,frameRate:Jn,audioSamplingRate:Jn,mimeType:Jn,segmentProfiles:Jn,codecs:Jn,maximumSAPPeriod:parseFloat,maxPlayoutRate:parseFloat,codingDependency:$n};function ri(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){var r=Array.isArray(t)?t:[t],n=e?{representation:e}:{};return r.map((function(t){return Object.assign(t,n)})).filter((function(t){return t&&t.hasOwnProperty("schemeIdUri")}))}return[]}var ni=function(t){var e=function t(e){var r={};if(1===e.nodeType){if(e.attributes.length>0)for(var n=0;n<e.attributes.length;n++){var i=e.attributes.item(n),o=ei[i.nodeName];r[i.nodeName]=o?o(i.nodeValue):i.nodeValue}}else 3===e.nodeType&&(r=e.nodeValue);if(e.hasChildNodes())for(var s=0;s<e.childNodes.length;s++){var a=e.childNodes.item(s),u=a.nodeName;if(void 0===r[u])r[u]=t(a);else{if(void 0===r[u].push){var c=r[u];r[u]=[],r[u].push(c)}r[u].push(t(a))}}return r}((new DOMParser).parseFromString(t,"application/xml"));return function(t){if(t.UTCTiming){var e=Array.isArray(t.UTCTiming)?t.UTCTiming:[t.UTCTiming];t.UTCTiming=e.filter((function(t){return t.hasOwnProperty("schemeIdUri")&&t.hasOwnProperty("value")}))}}(e.MPD),function(t){var e=t.Period,r=Array.isArray(e.AdaptationSet)?e.AdaptationSet:[e.AdaptationSet],n=[],i=[];r.forEach((function(r){var o;n.push.apply(n,u((o=r,(Array.isArray(o.Representation)?o.Representation:[o.Representation]).map((function(r){var n=ri(r.InbandEventStream);if(r.adapationSet=o,o.hasOwnProperty("SegmentTemplate")){var i=t.BaseURL?t.BaseURL["#text"].replace(/"|'/g,""):"",s=o.SegmentTemplate,a=$r(s.initialization,"RepresentationID",r.id),u=$r(s.media,"RepresentationID",r.id),c=t.availabilityStartTime?t.availabilityStartTime.getTime()/1e3:Date.now()/1e3,h=t.suggestedPresentationDelay?t.suggestedPresentationDelay:0,f=t.minBufferTime?t.minBufferTime:0,l=s.startNumber,p=s.duration/1e3,d=s.presentationTimeOffset/1e3||0,b=t.mediaPresentationDuration||yn.getDynamicTrackDuration(Z.fromJS({availabilityStartTime:c,startNumber:l,fragmentDuration:p})),g=t.mediaPresentationDuration||b-h-f,v=Math.floor(b/p),y="dynamic"!==t.type||t.mediaPresentationDuration?0:1,m=Ce.initialConfig.maxPrecedingTime/p,_=y?Math.max(0,v-m):0;return Object.assign(r,{baseURL:i,isDynamic:y,startNumber:l,minBufferTime:f,segmentTemplate:s,fragmentDuration:p,inbandEventStreams:n,fragmentIndexOffset:_,availabilityStartTime:c,presentationTimeOffset:d,numOfAvailableSegments:v,suggestedPresentationDelay:h,durationWithOffset:Qr(g,2),sourceURL:"".concat(i).concat(a),mimeType:o.mimeType,duration:Qr(b,2),codecs:o.codecs,type:t.type,url:"".concat(i).concat(u)})}var w=Math.min((r.SegmentList.duration/r.SegmentList.timescale).toFixed(2),t.maxSegmentDuration),E=Qr(t.mediaPresentationDuration||e.duration,2),S=Array.isArray(r.SegmentList.SegmentURL)?r.SegmentList.SegmentURL.length:1;return Object.assign(r,{duration:E,fragmentDuration:w,inbandEventStreams:n,numOfAvailableSegments:S,mimeType:r.mimeType||o.mimeType,sourceURL:r.SegmentList.Initialization.sourceURL})}))))),i.push.apply(i,u(ri(r.InbandEventStream)))})),t.representations=n.sort((function(t,e){return+e.bandwidth-+t.bandwidth})),n.forEach((function(t){i.push.apply(i,u(t.inbandEventStreams))})),t.inbandEventStreams=i}(e.MPD),e},ii="undefined"!=typeof window?window:void 0!==p?p:"undefined"!=typeof self?self:{};
/*! @name m3u8-parser @version 4.4.0 @license Apache-2.0 */function oi(){return(oi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function si(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var ai=function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.off=function(t,e){if(!this.listeners[t])return!1;var r=this.listeners[t].indexOf(e);return this.listeners[t].splice(r,1),r>-1},e.trigger=function(t){var e,r,n,i=this.listeners[t];if(i)if(2===arguments.length)for(r=i.length,e=0;e<r;++e)i[e].call(this,arguments[1]);else for(n=Array.prototype.slice.call(arguments,1),r=i.length,e=0;e<r;++e)i[e].apply(this,n)},e.dispose=function(){this.listeners={}},e.pipe=function(t){this.on("data",(function(e){t.push(e)}))},t}(),ui=function(t){function e(){var e;return(e=t.call(this)||this).buffer="",e}return si(e,t),e.prototype.push=function(t){var e;for(this.buffer+=t,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)},e}(ai),ci=function(t){for(var e,r=t.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),n={},i=r.length;i--;)""!==r[i]&&((e=/([^=]*)=(.*)/.exec(r[i]).slice(1))[0]=e[0].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^['"](.*)['"]$/g,"$1"),n[e[0]]=e[1]);return n},hi=function(t){function e(){var e;return(e=t.call(this)||this).customParsers=[],e.tagMappers=[],e}si(e,t);var r=e.prototype;return r.push=function(t){var e,r,n=this;0!==(t=t.trim()).length&&("#"===t[0]?this.tagMappers.reduce((function(e,r){var n=r(t);return n===t?e:e.concat([n])}),[t]).forEach((function(t){for(var i=0;i<n.customParsers.length;i++)if(n.customParsers[i].call(n,t))return;if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t))n.trigger("data",{type:"tag",tagType:"m3u"});else{if(e=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return r={type:"tag",tagType:"inf"},e[1]&&(r.duration=parseFloat(e[1])),e[2]&&(r.title=e[2]),void n.trigger("data",r);if(e=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"targetduration"},e[1]&&(r.duration=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"totalduration"},e[1]&&(r.duration=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"version"},e[1]&&(r.version=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return r={type:"tag",tagType:"media-sequence"},e[1]&&(r.number=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return r={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(r.number=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return r={type:"tag",tagType:"playlist-type"},e[1]&&(r.playlistType=e[1]),void n.trigger("data",r);if(e=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"byterange"},e[1]&&(r.length=parseInt(e[1],10)),e[2]&&(r.offset=parseInt(e[2],10)),void n.trigger("data",r);if(e=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return r={type:"tag",tagType:"allow-cache"},e[1]&&(r.allowed=!/NO/.test(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-MAP:?(.*)$/.exec(t)){if(r={type:"tag",tagType:"map"},e[1]){var o=ci(e[1]);if(o.URI&&(r.uri=o.URI),o.BYTERANGE){var s=o.BYTERANGE.split("@"),a=s[0],u=s[1];r.byterange={},a&&(r.byterange.length=parseInt(a,10)),u&&(r.byterange.offset=parseInt(u,10))}}n.trigger("data",r)}else if(e=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t)){if(r={type:"tag",tagType:"stream-inf"},e[1]){if(r.attributes=ci(e[1]),r.attributes.RESOLUTION){var c=r.attributes.RESOLUTION.split("x"),h={};c[0]&&(h.width=parseInt(c[0],10)),c[1]&&(h.height=parseInt(c[1],10)),r.attributes.RESOLUTION=h}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}n.trigger("data",r)}else{if(e=/^#EXT-X-MEDIA:?(.*)$/.exec(t))return r={type:"tag",tagType:"media"},e[1]&&(r.attributes=ci(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-ENDLIST/.exec(t))n.trigger("data",{type:"tag",tagType:"endlist"});else if(e=/^#EXT-X-DISCONTINUITY/.exec(t))n.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(e=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t))return r={type:"tag",tagType:"program-date-time"},e[1]&&(r.dateTimeString=e[1],r.dateTimeObject=new Date(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-KEY:?(.*)$/.exec(t))return r={type:"tag",tagType:"key"},e[1]&&(r.attributes=ci(e[1]),r.attributes.IV&&("0x"===r.attributes.IV.substring(0,2).toLowerCase()&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),void n.trigger("data",r);if(e=/^#EXT-X-START:?(.*)$/.exec(t))return r={type:"tag",tagType:"start"},e[1]&&(r.attributes=ci(e[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),void n.trigger("data",r);if(e=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-out-cont"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);if(e=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-out"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);if(e=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-in"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);n.trigger("data",{type:"tag",data:t.slice(4)})}}}else n.trigger("data",{type:"comment",text:t.slice(1)})})):this.trigger("data",{type:"uri",uri:t}))},r.addParser=function(t){var e=this,r=t.expression,n=t.customType,i=t.dataParser,o=t.segment;"function"!=typeof i&&(i=function(t){return t}),this.customParsers.push((function(t){if(r.exec(t))return e.trigger("data",{type:"custom",data:i(t),customType:n,segment:o}),!0}))},r.addTagMapper=function(t){var e=t.expression,r=t.map;this.tagMappers.push((function(t){return e.test(t)?r(t):t}))},e}(ai);function fi(t){for(var e=ii.atob(t||""),r=new Uint8Array(e.length),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}var li=function(t){function e(){var e;(e=t.call(this)||this).lineStream=new ui,e.parseStream=new hi,e.lineStream.pipe(e.parseStream);var r,n,i=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e),o=[],s={},a=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c=0;return e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},e.parseStream.on("data",(function(t){var e,h;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var e={};"length"in t&&(s.byterange=e,e.length=t.length,"offset"in t||(this.trigger("info",{message:"defaulting offset to zero"}),t.offset=0)),"offset"in t&&(s.byterange=e,e.offset=t.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),t.duration>0&&(s.duration=t.duration),0===t.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=o},key:function(){if(t.attributes)if("NONE"!==t.attributes.METHOD)if(t.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===t.attributes.KEYFORMAT)return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===t.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==t.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):t.attributes.KEYID&&"0x"===t.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:t.attributes.KEYFORMAT,keyId:t.attributes.KEYID.substring(2)},pssh:fi(t.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),n={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},void 0!==t.attributes.IV&&(n.iv=t.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else n=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,c=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){r={},t.uri&&(r.uri=t.uri),t.byterange&&(r.byterange=t.byterange)},"stream-inf":function(){this.manifest.playlists=o,this.manifest.mediaGroups=this.manifest.mediaGroups||u,t.attributes?(s.attributes||(s.attributes={}),oi(s.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME){var r=this.manifest.mediaGroups[t.attributes.TYPE];r[t.attributes["GROUP-ID"]]=r[t.attributes["GROUP-ID"]]||{},e=r[t.attributes["GROUP-ID"]],(h={default:/yes/i.test(t.attributes.DEFAULT)}).default?h.autoselect=!0:h.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(h.language=t.attributes.LANGUAGE),t.attributes.URI&&(h.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(h.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(h.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(h.forced=/yes/i.test(t.attributes.FORCED)),e[t.attributes.NAME]=h}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){c+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(o.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),s.dateTimeString=t.dateTimeString,s.dateTimeObject=t.dateTimeObject},targetduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):this.manifest.targetDuration=t.duration},totalduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+t.duration}):this.manifest.totalDuration=t.duration},start:function(){t.attributes&&!isNaN(t.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){s.cueOut=t.data},"cue-out-cont":function(){s.cueOutCont=t.data},"cue-in":function(){s.cueIn=t.data}}[t.tagType]||a).call(i)},uri:function(){s.uri=t.uri,o.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),n&&(s.key=n),s.timeline=c,r&&(s.map=r),s={}},comment:function(){},custom:function(){t.segment?(s.custom=s.custom||{},s.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(i)})),e}si(e,t);var r=e.prototype;return r.push=function(t){this.lineStream.push(t)},r.end=function(){this.lineStream.push("\n")},r.addParser=function(t){this.parseStream.addParser(t)},r.addTagMapper=function(t){this.parseStream.addTagMapper(t)},e}(ai),pi=function(t){var e=new li;return e.push(t),e.end(),e.manifest},di=function(t){return t.map((function(t){var e;return t.hasOwnProperty("SegmentList")?e=function(t){return(Array.isArray(t.SegmentList.SegmentURL)?t.SegmentList.SegmentURL:[t.SegmentList.SegmentURL]).map((function(t,e){return{url:t.media,data:null,index:e,endTime:-1,startTime:-1,isRequesting:!1,isBuffering:!1}}))}(t):t.hasOwnProperty("segmentTemplate")&&(e=function(t){var e=[];if(!t.segmentTemplate)return e;for(var r=t.numOfAvailableSegments-1;r>=t.fragmentIndexOffset;r--)e.unshift({url:$r(t.url,"Number",""+r),data:null,index:r,endTime:-1,startTime:-1,isRequesting:!1,isBuffering:!1});return e}(t)),e}))},bi=function(t){for(var e=l.atob(t.replace(/-/g,"+").replace(/_/g,"/")),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r},gi=function(t,e,r){if(!t)return"";if(!r&&t.byteLength%2!=0)throw new Error("Data has an incorrect length, must be even.");var n;if(t instanceof ArrayBuffer)n=t;else{var i=new Uint8Array(t.byteLength);i.set(new Uint8Array(t)),n=i.buffer}for(var o=Math.floor(t.byteLength/2),s=new Uint16Array(o),a=new DataView(n),u=0;u<o;u++)s[u]=a.getUint16(2*u,e);return function(t){for(var e="",r=0;r<t.length;r+=16e3){var n=t.subarray(r,r+16e3);e+=String.fromCharCode.apply(null,n)}return e}(s)},vi=function(t){for(var e=new ArrayBuffer(2*t.length),r=new Uint16Array(e),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r};function yi(t,e,r,n){Z.Map.isMap(t)&&(t=t.toJS()),n||(n=t.url);var i,o={id:t.id,url:t.url,duration:Qr(t.duration,2),extension:t.extension||(i=t.url,i.split(".").pop().split(/\W+/).shift()),fragmented:!1,isEncrypted:!1,expireAt:t.expiration,addedAt:Date.now(),manifestIds:t.manifestIds,certificateData:t.certificateData,supportedContentProtection:t.supportedContentProtection};if(t.manifests||t.manifest){var a=yn.getTrackProtocol(o);a===Zr&&(n="MPD"),o.manifests=t.manifests||function(t,e){return s({},e,{manifest:t.manifest})}(t,n);var u=o.manifests[n],c=u?u.manifest:null;switch(a){case Zr:c&&function(t,e,r,n){try{var i=ni(e).MPD,o=i.representations,s=o.map((function(t){return t.bandwidth.toString()})),a=di(o),u=function(t){return t.map((function(t){return{data:null,url:t.sourceURL,isRequesting:!1,isBuffering:!1}}))}(o),c=o[0],h=i.UTCTiming,f=c.isDynamic||!1,l=f&&h&&h.length>0,p=Array.isArray(i.Period.AdaptationSet)?i.Period.AdaptationSet[0]:i.Period.AdaptationSet,d=!(!p||!p);Object.assign(t,{waitingServerTimeSync:l,UTCTiming:h,isDynamic:f,isEncrypted:d,suggestedPresentationDelay:c.suggestedPresentationDelay,numOfAvailableSegments:c.numOfAvailableSegments,availabilityStartTime:c.availabilityStartTime,presentationTimeOffset:c.presentationTimeOffset||0,fragmentIndexOffset:c.fragmentIndexOffset||0,durationWithOffset:c.durationWithOffset,inbandEventStreams:i.inbandEventStreams,dynamicTrackEnded:!f&&void 0,fragmentDuration:c.fragmentDuration||c.SegmentList.duration/c.SegmentList.timescale,minBufferTime:c.minBufferTime,startNumber:c.startNumber||0,bitrateList:s,fragmented:!0,duration:c.duration,type:i.type||c.type,bitrates:s.reduce((function(t,e){var r,n=s.indexOf(e);return d&&(r=(o[n].adapationSet.ContentProtection||[]).filter((function(t){return sn[t.schemeIdUri]})).map((function(t){return{initDataType:an,initData:bi(t[sn[t.schemeIdUri].initKey]["#text"]),label:sn[t.schemeIdUri].label,isRequesting:!1,isUpdating:!1,data:null}})).reduce((function(t,e){return t[e.label]=e,t}),{})),t[e]={needsInitFragment:!!u[n],initialization:u[n],urlTemplate:o[n].url,fragments:a[n],mimeType:o[n].mimeType,codecs:o[n].codecs,contentProtections:r},t}),{})}),t.startBitrate=mi(t,r)}catch(t){n(t)}}(o,c,e,r);break;case tn:o.bitrates=t.bitrates,o.startBitrate=t.startBitrate,c&&function(t,e,r,n,i){var o;try{(o=pi(e)).playlists?function(t,e,r){var n={};e.playlists.forEach((function(t){var e=t.uri,r=t.attributes,i=r.BANDWIDTH,o=r.CODECS;n[i]={codecs:o,mimeType:"audio/aac",uri:e,contentProtections:s({},rn,{label:rn,initDataType:"cbcs"})}}));var i="EVENT"===e.playlistType;Object.assign(t,{isDynamic:i,isEncrypted:!0,startNumber:0,type:i?"dynamic":"static",bitrates:n,bitrateList:Object.keys(n)}),t.startBitrate=mi(t,r)}(t,o,r):function(t,e,r){var n=e.segments,i=e.targetDuration,o=n.length,s=!!n.length,a=Math.round(n.reduce((function(t,e){return t+e.duration}),0)),u=(t.url||r).match(/^(.*)\/[^\/]+\.m3u8.*$/,"");if(u.length<2||!u[1])throw new Error("Bitrate data url not parsed");var c=u[1],h=n.map((function(t,e){var r=t.uri,n={url:"".concat(c,"/").concat(r),data:null,index:e,endTime:-1,startTime:-1,isRequesting:!1,isBuffering:!1};if(t.byterange){var i=t.byterange,o=i.offset,s=i.length;Object.assign(n,{addressRange:[o,o+s]})}return n})),f=t.bitrates,l=Object.entries(f).find((function(t){return t[1].uri===r}))[0];Object.assign(f[l],{fragments:h}),Object.assign(t,{numOfAvailableSegments:o,fragmented:s,fragmentDuration:i,duration:a,durationWithOffset:a,bitrates:f})}(t,o,n)}catch(t){i(t)}}(o,c,e,n,r)}}return o}function mi(t,e){var r,n=e.getIn(["abr","bandwidthBPS"]);if(n)r=wn(t,n);else{var i=e.getIn(["config","abr","rule"]),o=t.bitrateList,s=o.length-1;switch(i){case"fixed":var a=e.getIn(["config","abr","audioQuality"]);r=a<s&&a>=0?o[a]:o[s];break;default:r=o[s]}}return r}function _i(t,e){return{type:Ht,payload:{track:t,playback:e}}}var wi=function(t){return function(e,r){var n=r().getIn(["cache",t.id]),i=function(t){return e(jn(Hn,{error:t}))};if(n){var o=function(t,e,r){var n=e(),i=n.getIn(["cache",t.id]);if(i.get("fragmented"))return i.get("isDynamic")?function(t,e,r,n){e.manifests=t.get("manifests").toJS();var i=yi(e,r,n);i.waitingServerTimeSync=t.get("waitingServerTimeSync");var o=(t=t.merge(i)).get("bitrateList");return o&&o.forEach((function(e){t=t.setIn(["bitrates",e,"needsInitFragment"],!1)})),t}(i,t,e(),r):function(t,e,r,n){e.manifest||(e.manifests=e.manifests||t.get("manifests").toJS());var i=yi(e,r,n),o=t.get("bitrateList");return o&&o.forEach((function(e){var r=["bitrates",e,"initialization","url"],n=["bitrates",e,"fragments"];t.getIn(r)&&(t=t.setIn(r,i.bitrates[e].initialization.url)),t=t.setIn(n,t.getIn(n).map((function(t){return t.set("url",i.bitrates[e].fragments[t.get("index")].url)}))).set("expireAt",i.expireAt).set("certificateData",i.certificateData).set("addedAt",Date.now())})),t}(i,t,e(),r);var o=i.get("url")!==t.url,s=yn.isFullyBuffered(t.id,n);if(o&&!s){var a={};return t.url&&(a.url=t.url,a.expireAt=t.expiration||i.get("expireAt")),i.merge(a)}return i}(t,r,i);o!==n&&e({type:Wt,payload:{track:o}})}else{var s=yi(t,r(),i);e({type:Bt,payload:{track:s}})}}},Ei=function(t){return function(e,r){var n=r().getIn(["cache",t]);if(n&&n.get("fragmented")){var i=n.get("bitrateList");i&&i.forEach((function(t){n=n.setIn(["bitrates",t,"needsInitFragment"],!0).setIn(["bitrates",t,"initialization","isBuffering"],!1).setIn(["bitrates",t,"fragments"],n.getIn(["bitrates",t,"fragments"]).map((function(t){return t.set("isBuffering",!1)})))})),e({type:Vt,payload:{track:n}})}}},Si=function(t,e){return function(r,n){if(Z.Map.isMap(t)){var i=n();t=yi(t=t.toJS(),n(),(function(t){return r(jn(Hn,{error:t}))}),e),t=Z.fromJS(t);var o=yn.getDynamicTrackDurationWithOffset(t),s={bitrate:yn.getBitrate(t,i),time:t.get("isDynamic")?o:i.getIn(["playback","time"])};r(_i(t,s))}}},Ii=function(t){return{type:zt,payload:{trackId:t}}},Ti=function(t){return{type:re,payload:{trackId:t}}},ki=function(t){return function(e){var r=t.get("id"),n=yn.getDynamicTrackDuration(t),i=yn.getDynamicTrackDurationWithOffset(t),o=t.get("numOfAvailableSegments"),s=Math.floor(n/t.get("fragmentDuration"));if(s>o){var a={},u=t.get("bitrateList");u&&u.forEach((function(e){for(var r=o,n=[];r<s;)n.push(yn.getNewFragmentForDynamicTrack(t,e,r)),r++;a[e]=n})),e({type:Gt,payload:{trackId:r,availableDuration:n,availableDurationWithOffset:i,newNumOfAvailableSegments:s,newFragmentsForBitrate:a}})}else s<o&&e({type:Xt,payload:{trackId:r,availableDuration:n,availableDurationWithOffset:i,newNumOfAvailableSegments:s,numOfFragsToBeRemoved:o-s}})}},xi=function(t){return{type:ge,payload:{config:t}}},Oi=function(t){return Date.parse(t)};function Ci(t,e,r){return function(n,i){var o=i().getIn(["config","maxNetworkRetries"]);return n({type:Qt,payload:{trackId:e}}),Pr({url:r},"text",o).subscribe((function(r){n({type:Zt,payload:{trackId:e}});var i=Date.now(),o=t(r);n({type:ee,payload:{trackId:e,serverTimeOffset:(o-i)/1e3}})}),(function(t){n(jn(qn,{error:t,response:t.response})),n({type:te,payload:{trackId:e}})}))}}var Di=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(n,i){if(t&&!yn.isProgressiveTrack(e)){var o=i().getIn(["config","maxNetworkRetries"]),s=e.get("id"),a=yn.getTrackProtocol(e)===Zr?"MPD":t;return n({type:Yt,payload:{trackId:s,manifestId:a}}),Pr({url:t,resolver:"text"},"text",o).subscribe((function(t){if(n({type:Jt,payload:{trackId:s,manifestId:a,manifest:t}}),r){var e={trackId:s};Object.assign(e,{data:r}),n({type:Kt,payload:e})}}),(function(t){n(jn(qn,{error:t,response:t.response})),n({type:$t,payload:{trackId:s,manifestId:a}})}))}}},Ai=function(t){return function(e){var r=t.get("UTCTiming");if(r){var n=t.get("id"),i=r.last(),o=i.get("value");switch(i.get("schemeIdUri")){case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-iso:2012":return void e(Ci(Oi,n,o));default:return}}}},Ri={open:function(t){return{type:ne,payload:{trackId:t}}},closed:function(t){return{type:ie,payload:{trackId:t}}},ended:function(t){return{type:oe,payload:{trackId:t}}},appending:function(t,e,r){return{type:ae,payload:{trackId:t.get("id"),bitrate:e,fragmentIndex:yn.getIndexForFragment(t,r)}}},appended:function(t,e,r,n,i){return{type:se,payload:{endTime:i,fragment:r,startTime:n,trackId:t.get("id"),bitrate:e,fragmentIndex:yn.getIndexForFragment(t,r)}}},rangesUpdated:function(t,e){return{type:ue,payload:{trackId:t,ranges:e}}}};function Mi(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return r.reduce((function(t,e){return t.map((function(t){return t.get(e)})).distinctUntilChanged()}),t)}var Ni={propertyObservable:Mi,truthyPropertyObservable:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Mi.apply(void 0,[t].concat(r)).filter((function(t){return t}))}},Fi=function(t){return"open"===t},Pi=function(t){return"closed"===t},Ui=function(t){return"ended"===t},Li=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t.getIn(["playback","id"]),n=yn.getCurrentTrack(t),i=t.getIn(["media",r,"audioEl"]);i.src=n&&n.get("url"),Ze.isSafari()||Ze.isIE()?$.Observable.fromEvent(i,"canplay").take(1).subscribe((function(){i.currentTime=e})):i.currentTime=e,i.pause(),t.getIn(["playback","playing"])&&i.play()},ji=function(t){var e=yn.getCurrentTrack(t),r=t.getIn(["playback","duration"])-t.getIn(["playback","time"])<1;return e&&yn.isProgressiveTrack(e)&&r},qi=function(t){if("object"!==r(t))throw new Error("Expected the store to be an object.");var e=t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("fragmented")})).distinctUntilChanged((function(t){return t.getIn(["playback","id"])})),n=Ni.truthyPropertyObservable(t.stateObservable,"playback","playing"),i=t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["network","online"])})).filter((function(t){return t.getIn(["network","online"])})),o=[],s=[],a=t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t.getIn(["playback","id"])})).flatMapLatest((function(e){var r=e.getIn(["playback","id"]);return e.getIn(["media",r,"audioEl"])?$.Observable.just(e):t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["media",r,"audioEl"])})).filter((function(t){return t.getIn(["media",r,"audioEl"])}))}));return a.subscribe((function(r){var u=r.getIn(["playback","id"]),c=r.getIn(["media",u,"audioEl"]);o.map((function(t){return t.dispose()})),s.map((function(t){return t.dispose()})),o=function(t,r){var o=t.stateObservable,s=[];return s.push(n.flatMapLatest((function(){var r=t.getState(),n=r.getIn(["playback","id"]),i=r.getIn(["cache",n]);return i.get("fragmented")||yn.isProgressiveTrack(i)?$.Observable.just():e.take(1)})).subscribe((function(){var e=t.getState().getIn(["playback","time"]),n=r.currentTime;(!isFinite(n)||Math.abs(e-n)>1)&&(r.currentTime=e);var i=r.play();i&&"undefined"!=typeof Promise&&i instanceof Promise&&i.catch((function(e){e&&"NotAllowedError"===e.name&&(t.dispatch(In()),t.dispatch(jn("PLAY_NOT_AUTHORIZED")))}))}))),s.push(n.filter((function(){return!t.getState().getIn(["playback","started"])})).flatMapLatest((function(){var e=t.getState().getIn(["playback","id"]);return Ni.propertyObservable(t.stateObservable,"media",e,"ranges").catch((function(){return $.Observable.empty()}))})).flatMapLatest((function(e){var r=t.getState().getIn(["playback","time"]);if(0===r){var n=e.first();if(n)return r=n.first(),$.Observable.just(r)}return $.Observable.empty()})).subscribe((function(t){t>0&&t<1&&(r.currentTime=t)}))),s.push(Ni.truthyPropertyObservable(o,"playback","paused").subscribe((function(){r.pause()}))),s.push(Ni.propertyObservable(o,"playback","muted").subscribe((function(t){r.muted=t}))),s.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","volume"])})).subscribe((function(t){var e=t.getIn(["playback","volume"]);r.volume=e,t.getIn(["media","_freeAudioEls"]).forEach((function(t){return t.volume=e}))}))),s.push(Ni.propertyObservable(o,"playback","ended").filter((function(t){return t})).subscribe((function(){t.getState().getIn(["playback","repeating"])&&(t.dispatch(Dn(0)),t.dispatch(En()))}))),s.push(t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).distinctUntilChanged((function(t){return t.getIn(["playback","time"])})).flatMap((function(e){var r=e.getIn(["playback","id"]);return e.getIn(["media",r,"ranges"]).size>0?$.Observable.just():t.stateObservable.filter((function(t){return t.getIn(["media",r,"ranges"]).size>0})).take(1)})).subscribe((function(){var e=t.getState().get("playback").get("time"),n=r.currentTime;mn(e,n)&&(r.currentTime=e)}))),s.push(t.stateObservable.filter((function(t){return t.getIn(["playback","started"])})).distinctUntilChanged((function(t){return t.getIn(["playback","seeking"])})).filter((function(t){return t.getIn(["playback","seeking"])})).flatMapLatest((function(){return r.volume=0,t.stateObservable.filter((function(t){return!t.getIn(["playback","seeking"])})).delay(100).take(1)})).subscribe((function(t){var e=t.getIn(["playback","volume"]);r.volume=e}))),s.push(t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).distinctUntilChanged((function(t){return t.getIn(["playback","seeking"])})).filter((function(t){return t.getIn(["playback","seeking"])})).flatMapLatest((function(){return $.Observable.merge($.Observable.fromEvent(r,"playing"),$.Observable.fromEvent(r,"seeked")).take(1)})).subscribe((function(){t.dispatch(Pn()),Ze.isSafari()&&Ze.isLessThanVersion("10.1")&&!Ze.isComcastTV()&&r.currentTime>0&&(r.currentTime=r.currentTime,r.pause(),r.play())}))),s.push(o.filter((function(t){return t.getIn(["playback","id"])})).map((function(t){return yn.getCurrentTrack(t)})).filter((function(t){return t})).distinctUntilChanged((function(t){return t.get("duration")})).subscribe((function(e){var r=e.get("duration");r&&t.dispatch(Rn(r))}))),s.push(a.filter((function(t){return yn.getCurrentTrack(t)})).flatMapLatest((function(){return Number.isFinite(r.duration)?$.Observable.just(r.duration):$.Observable.fromEvent(r,"durationchange").take(1)})).subscribe((function(){Number.isFinite(r.duration)&&t.dispatch(Rn(r.duration))}))),s.push(t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).map((function(t){return yn.getCurrentTrack(t)})).filter((function(t){return t&&t.get("isDynamic")})).distinctUntilChanged((function(t){return t.get("durationWithOffset")})).subscribe((function(e){var r=t.getState().getIn(["playback","time"]),n=e.get("durationWithOffset");r+5<n&&t.dispatch(Cn(n))}))),s.push(t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t.getIn(["playback","playing"])})).distinctUntilChanged((function(t){return t.getIn(["playback","codecs"])})).filter((function(t){return t.getIn(["playback","codecs"])})).skip(1).flatMap((function(){return t.stateObservable.map((function(t){return yn.getCurrentMediaReadyState(t)})).distinctUntilChanged().filter((function(t){return Fi(t)})).take(1)})).subscribe((function(){var e=t.getState(),n=e.getIn(["playback","time"]),i=r.currentTime;0===i&&i!==n&&(r.currentTime=e.getIn(["playback","time"]))}))),s.push(Ni.truthyPropertyObservable(o,"playback","stalled").flatMapLatest((function(){return $.Observable.merge($.Observable.fromEvent(r,"playing").filter((function(){return!t.getState().getIn(["playback","seeking"])})),$.Observable.fromEvent(r,"durationchange"),t.stateObservable.filter((function(){return Ze.isEdge()||Ze.isIE()})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&!e.get("isDynamic")})).distinctUntilChanged((function(t){var e=t.getIn(["playback","id"]);return t.getIn(["media",e,"audioEl"]).currentTime})).skip(1).filter((function(t){return!t.getIn(["playback","seeking"])}))).take(1)})).subscribe((function(){var e=t.getState(),n=yn.getCurrentTrack(e),i=e.getIn(["playback","time"]);t.dispatch(Fn()),n&&n.get("isDynamic")&&mn(i,r.currentTime)&&(r.currentTime=i)}))),s.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","time"])})).filter((function(t){return!t.getIn(["playback","ended"])})).filter((function(t){var e=t.getIn(["playback","duration"]),r=t.getIn(["playback","time"]);return r<e&&r+.01>=e})).subscribe((function(){return t.dispatch(Tn())}))),Ze.isSafari()&&Ze.isLessThanVersion("10.1")&&!Ze.isComcastTV()&&s.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","stalled"])})).filter((function(t){return t.getIn(["playback","stalled"])})).flatMapLatest((function(e){var r=e.getIn(["playback","id"]),n=e.getIn(["media",r,"ranges"]);return t.stateObservable.distinctUntilChanged((function(t){var e=t.getIn(["media",r,"ranges"]);return n===e})).takeUntil(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","stalled"])})).filter((function(t){return!t.getIn(["playback","stalled"])})))})).subscribe((function(t){r.currentTime=t.getIn(["playback","time"]),r.pause(),r.play()}))),s.push(t.stateObservable.filter((function(t){var e=yn.getCurrentTrack(t);return e&&yn.isProgressiveTrack(e)})).filter((function(t){return!t.getIn(["network","online"])})).flatMapLatest((function(){return i.filter((function(t){return t.getIn(["playback","stalled"])})).map((function(t){var e=t.getIn(["playback","id"]);return t.getIn(["media",e,"audioEl"]).currentTime})).take(1)})).subscribe((function(e){Li(t.getState(),e)}))),s.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","stalled"])})).filter((function(t){return t.getIn(["playback","stalled"])})).filter((function(t){return t.getIn(["playback","started"])})).filter((function(t){return t.getIn(["network","online"])})).filter((function(){return Ze.isAndroid()})).filter((function(t){var e=t.getIn(["errors","list"]).toJS().map((function(t){return t.error}));return Array.isArray(e)&&e.includes(Kn)})).filter((function(t){return!t.getIn(["media","_freeAudioEls","size"])})).filter((function(t){var e=t.getIn(["playback","time"]);return e>=29&&e<=31})).subscribe((function(){return t.dispatch(jn("CDM_DECRYPTION_FAILED"))}))),s.push(i.filter((function(t){var e=yn.getCurrentTrack(t);return e&&yn.isProgressiveTrack(e)})).filter((function(t){return t.getIn(["playback","playing"])})).filter((function(t){return!t.getIn(["playback","started"])})).subscribe((function(t){var e=t.getIn(["playback","time"]);Li(t,e)}))),s}(t,c),s=function(t,e,r){var n=[];return n.push($.Observable.fromEvent(e,"playing").map((function(){return t.getState()})).filter((function(t){return!t.getIn(["playback","started"])})).subscribe((function(){t.dispatch(xn()),t.dispatch(Ri.rangesUpdated(r,Jr.bufferToRanges(e)))}))),n.push($.Observable.fromEvent(e,"ended").map((function(){return t.getState()})).filter((function(t){return!t.getIn(["playback","ended"])})).subscribe((function(e){!Ze.isSafari()||e.getIn(["network","online"])||ji(e)?t.dispatch(Tn()):t.dispatch(Nn())}))),n.push($.Observable.fromEvent(e,"progress").map((function(){return t.getState()})).filter((function(t){return t.getIn(["playback","started"])})).subscribe((function(){t.dispatch(Cn(e.currentTime)),t.dispatch(Ri.rangesUpdated(r,Jr.bufferToRanges(e)))}))),n.push($.Observable.fromEvent(e,"timeupdate").map((function(){return t.getState()})).filter((function(t){return t.getIn(["playback","playing"])})).filter((function(t){return t.getIn(["playback","started"])})).distinctUntilChanged((function(t){var e=t.getIn(["playback","id"]);return t.getIn(["media",e,"audioEl"]).currentTime})).filter((function(t){var e=yn.getCurrentTrack(t);return yn.getTrackProtocol(e)===tn||!t.getIn(["playback","bitrate"])||!Pi(yn.getCurrentMediaReadyState(t))})).subscribe((function(){t.dispatch(Cn(e.currentTime))}))),n.push($.Observable.fromEvent(e,"error").subscribe((function(r){var n=(new Error).stack,i=e.error,o=Wn;if(i)switch(i.code){case i.MEDIA_ERR_ABORTED:o="MEDIA_ERR_ABORTED";break;case i.MEDIA_ERR_NETWORK:o="MEDIA_ERR_NETWORK",t.dispatch(Nn());break;case i.MEDIA_ERR_DECODE:o="MEDIA_ERR_DECODE",t.dispatch(Nn());break;case i.MEDIA_ERR_SRC_NOT_SUPPORTED:o="MEDIA_ERR_SRC_NOT_SUPPORTED";break;default:o=Wn}t.dispatch(jn(o,{error:r,stack:n,audioError:i}))}))),n.push($.Observable.fromEvent(e,"waiting").map((function(){return t.getState()})).filter((function(t){return t.getIn(["playback","started"])})).filter((function(t){return!t.getIn(["playback","seeking"])})).filter((function(){return e.currentTime>0})).filter((function(t){var e=t.getIn(["playback","duration"]);return t.getIn(["playback","time"])<e})).subscribe((function(){t.dispatch(Cn(e.currentTime)),t.dispatch(Nn())}))),n.push($.Observable.fromEvent(e,"waiting").map((function(){return t.getState()})).filter((function(t){return t.getIn(["playback","started"])})).filter((function(t){return!t.getIn(["playback","seeking"])})).filter((function(t){return!t.getIn(["playback","ended"])})).filter((function(t){var e=t.getIn(["playback","duration"]);return t.getIn(["playback","time"])>=e})).subscribe((function(){t.dispatch(Tn())}))),n}(t,c,u)})),a.filter((function(t){return!yn.getCurrentTrack(t).get("fragmented")})).subscribe((function(e){var r=e.getIn(["playback","id"]),n=e.getIn(["media",r,"audioEl"]);t.dispatch(Ri.rangesUpdated(r,Jr.bufferToRanges(n)))})),{dispose:function(){o.map((function(t){return t.dispose()})),s.map((function(t){return t.dispose()}))}}};function Bi(t){var e=a(t,2),r=e[0],n=e[1];return"bytes:".concat(r,"-").concat(n)}var zi=function(t,e,r){return function(n,i){if(!t.get("waitingServerTimeSync")){var o=i(),s=t.get("id"),a=yn.getIndexForFragment(t,r),u=o.getIn(["config","maxNetworkRetries"]),c=Date.now(),h=t.get("isDynamic"),f=r.get("addressRange");n({type:ce,payload:{trackId:s,fragmentIndex:a,bitrate:e}});var l={url:r.get("url")};return f&&Object.assign(l,{headers:{Range:Bi(f)}}),Pr(l,"arrayBuffer",u).subscribe((function(t){var r=Lr(c,t,i());n({type:he,payload:{trackId:s,fragmentIndex:a,bitrate:e,data:t,metrics:r}})}),(function(t){var r=(new Error).stack,o=jr(c,t,i());n(jn(qn,{error:t,stack:r,response:t.response})),n({type:fe,payload:{trackId:s,fragmentIndex:a,bitrate:e,metrics:o}}),h&&t.response&&404===t.response.status&&n({type:le,payload:{trackId:s}})}))}}},Vi=function(t){if("object"!==r(t))throw new Error("Expected the store to be an object.");var e=function(t){var e=[],r=t.stateObservable.filter((function(t){return t.getIn(["playback","bitrate"])})).distinctUntilChanged((function(t){return t.getIn(["playback","bitrate"])})),n=t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("fragmented")})).distinctUntilChanged((function(t){return t.getIn(["playback","id"])})),i=t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["network","online"])})).filter((function(t){return t.getIn(["network","online"])})),o=t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).map((function(t){return yn.getCurrentTrack(t)})).filter((function(t){return t})).distinctUntilChanged((function(t){return t.get("waitingServerTimeSync")})).filter((function(t){return!t.get("waitingServerTimeSync")})).map((function(){return t.getState()}));return e.push($.Observable.merge(n,r,i,o).filter((function(t){return t.getIn(["network","online"])})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("fragmented")})).subscribe((function(e){var r=e.getIn(["playback","time"]),n=yn.getCurrentTrack(e),i=e.getIn(["playback","bitrate"]),o=yn.getInitFragment(n,i),s=n.get("id"),a=e.getIn(["media",s,"ranges"]),u=yn.getNextFragmentToFetch(n,i,a,r);yn.isFragmentRequestable(o)&&t.dispatch(zi(n,i,o)),yn.isFragmentRequestable(u,n.get("fragmentDuration"),a)&&t.dispatch(zi(n,i,u))}))),e.push($.Observable.merge(t.stateObservable,i,o).filter((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t.getIn(["network","online"])})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("fragmented")})).distinctUntilChanged((function(t){return yn.getCurrentTrack(t).get("bitrates")})).map((function(t){return{track:yn.getCurrentTrack(t),bitrate:t.getIn(["playback","bitrate"]),time:t.getIn(["playback","time"])}})).filter((function(t){return t.time>0})).filter((function(t){return!yn.isRequestingAFragment(t.track,t.bitrate)})).map((function(e){var r=e.track,n=e.bitrate,i=e.time,o=r.get("isDynamic")?r.get("suggestedPresentationDelay"):t.getState().getIn(["config","secondsToPrefetchAhead"]),s=r.get("id"),a=t.getState().getIn(["media",s,"ranges"]);return{fragment:yn.getNextFragmentToFetch(r,n,a,i,o),track:r,bitrate:n}})).filter((function(t){return t.fragment})).subscribe((function(e){t.dispatch(zi(e.track,e.bitrate,e.fragment))}))),e.push($.Observable.merge(t.stateObservable,i,o).filter((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t.getIn(["network","online"])})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("fragmented")})).distinctUntilChanged((function(t){return t.getIn(["playback","time"])})).map((function(t){return{track:yn.getCurrentTrack(t),bitrate:t.getIn(["playback","bitrate"]),time:t.getIn(["playback","time"]),seeking:t.getIn(["playback","seeking"])}})).filter((function(t){var e=yn.isRequestingAFragment(t.track,t.bitrate);return t.seeking||!e})).map((function(e){var r=e.track,n=e.bitrate,i=e.time,o=t.getState().getIn(["config","secondsToPrefetchAhead"]),s=r.get("id"),a=t.getState().getIn(["media",s,"ranges"]);return{fragment:yn.getNextFragmentToFetch(r,n,a,i,o),track:r,bitrate:n}})).filter((function(t){return t.fragment})).subscribe((function(e){t.dispatch(zi(e.track,e.bitrate,e.fragment))}))),e}(t);return{dispose:function(){var t,r=f(e);try{for(r.s();!(t=r.n()).done;)t.value.dispose()}catch(t){r.e(t)}finally{r.f()}}}},Wi=function(t,e,n,i){if("object"!==r(t))throw new Error("Expected the store to be an object.");if("string"!=typeof e)throw new Error("Expected the trackId to be a string.");if("object"!==r(n))throw new Error("Expected the sourceBuffer to be an object.");if("object"!==r(i))throw new Error("Expected the mediaSource to be an object.");var o=function(t,r){var n=[],i=$.Observable.fromEvent(r,"error"),o=$.Observable.fromEvent(r,"updateend");n.push(i.subscribe((function(e){var r=(new Error).stack;t.dispatch(jn(Vn,{error:e,stack:r}))})));var s=t.getState(),a=$.Observable.merge($.Observable.just(s),t.stateObservable),u=a.flatMap((function(t){var r=t.getIn(["cache",e]),n=yn.getBitrate(r,t);if(r.getIn(["bitrates",n,"needsInitFragment"])){var i=yn.getInitFragment(r,n);if(i.get("data")&&!i.get("isBuffering"))return $.Observable.just(i)}return $.Observable.empty()})),c=function(t){return t.flatMap((function(t){var r=t.getIn(["cache",e]),n=yn.getBitrate(r,t);if(!r.getIn(["bitrates",n,"needsInitFragment"])){var i=t.getIn(["media",e]),o=t.getIn(["playback","id"]),s=r.get("fragmentDuration"),a={fragments:yn.getFragmentsForBitrate(r,n),lastBufferedIndex:i.get("lastBufferedIndex"),fragmentIndexOffset:r.get("fragmentIndexOffset")};return o===e?(a.time=t.getIn(["playback","time"]),a.ranges=i.get("ranges"),a.fragmentDuration=s,$.Observable.just(yn.getCurrentNextFragmentToAppend(a))):(a.defaultStartIndex=r.get("isDynamic")?Math.floor(r.get("durationWithOffset")/s):0,$.Observable.just(yn.getNextFragmentToAppend(a)))}return $.Observable.empty()}))}(a),h=$.Observable.merge(u,c).pausableBuffered(new $.Subject),f=h.filter((function(){return!r.updating})).filter((function(t){return t&&!t.get("isBuffering")})).distinctUntilChanged((function(t){return t.get("url")})).flatMap((function(n){h.pause();var i=t.getState(),s=i.getIn(["cache",e]),a=yn.getBitrate(s,i);return t.dispatch(Ri.appending(s,a,n)),function(t,e,r){return $.Observable.create((function(n){var i=r.take(1).subscribe((function(){n.onNext(),n.onCompleted()}));try{t.appendBuffer(e)}catch(t){n.onError(t)}return function(){return i.dispose()}}))}(r,n.get("data"),o).map((function(){return n})).retryWhen((function(t){return t.delay(5e3)}))})).subscribe((function(n){var i=t.getState(),o=i.getIn(["cache",e]),s=yn.getBitrate(o,i),a=Jr.bufferToRanges(r),u=yn.getFragmentStartTime(n.get("data")),c=yn.getFragmentEndTime(a);o.get("isEncrypted")||void 0===n.get("index")||-1!==u||t.dispatch(jn("SEGMENT_INDEX_NOT_AVAILABLE")),t.dispatch(Ri.rangesUpdated(e,a)),t.dispatch(Ri.appended(o,s,n,u,c)),h.resume()}),(function(e){var r=e&&e.name,n=e&&e.message,i=(new Error).stack;"QuotaExceededError"===r?t.dispatch(jn("SOURCE_BUFFER_QUOTA_EXCEEDED",{message:n,stack:i})):t.dispatch(jn(Vn,{message:n,stack:i}))}));return n.push(f),h.resume(),n}(t,n);return{dispose:function(){o.map((function(t){return t.dispose()})),Fi(i.readyState)&&n.abort(),Pi(i.readyState)||n.remove(0,1/0)}}};function Hi(){}var Ki=function(t,e){if("object"!==r(t))throw new Error("Expected the store to be an object.");if("string"!=typeof e)throw new Error("Expected the trackId to be a string.");var n,i=[],o=Ni.propertyObservable(t.stateObservable,"playback","id").filter((function(t){return t})).filter((function(t){return t===e})).flatMapLatest((function(){return t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","codecs"])})).map((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t===e})).distinctUntilChanged().skip(1)})),s=t.stateObservable.filter((function(t){return t.getIn(["cache",e])})).distinctUntilChanged((function(t){return t.getIn(["cache",e,"fragmented"])})),a=t.stateObservable.filter((function(t){return t.getIn(["cache",e])})).distinctUntilChanged((function(t){return t.getIn(["cache",e,"url"])}));return i.push($.Observable.merge($.Observable.just(),a).filter((function(){return t.getState().getIn(["cache",e])})).filter((function(){return yn.isProgressiveTrack(t.getState().getIn(["cache",e]))})).subscribe((function(){var r=t.getState(),i=yn.getTrack(e,r),o=r.getIn(["media",e,"audioEl"]);n=null,o.src=i.get("url"),Ze.isChrome()&&!Ze.isLessThanVersion("58.0.3029.81")&&Ze.isLessThanVersion("59.0.3071.86")?o.preload="none":o.preload="auto"}))),i.push(a.filter((function(){return t.getState().getIn(["playback","id"])===e})).filter((function(){return yn.isProgressiveTrack(t.getState().getIn(["cache",e]))})).subscribe((function(){var r=t.getState(),i=yn.getTrack(e,r),o=r.getIn(["media",e,"audioEl"]),s=r.getIn(["playback","playing"]),a=r.getIn(["playback","stalled"]);n=null,o.src=i.get("url"),o.currentTime=r.getIn(["playback","time"]),(s||a)&&o.play()}))),i.push($.Observable.merge(s,o).filter((function(){return t.getState().getIn(["cache",e])})).filter((function(){var r=t.getState().getIn(["cache",e]);return yn.getTrackProtocol(r)===Zr})).subscribe((function(){var i=t.getState(),o=yn.getTrack(e,i).get("fragmented"),s=i.getIn(["media",e,"audioEl"]);n&&n.dispose&&n.dispose(),o&&(n=function(t,e,n){if("object"!==r(t))throw new Error("Expected the store to be an object.");if("object"!==r(e))throw new Error("Expected the audioElement to be an object.");if("string"!=typeof n)throw new Error("Expected the trackID to be a string.");var i,o=e._mediaSource,s=e.src,a=[];return a.push(t.stateObservable.distinctUntilChanged((function(t){return yn.getMediaReadyState(n,t)})).filter((function(t){return Fi(yn.getMediaReadyState(n,t))})).filter((function(t){return t.getIn(["cache",n,"fragmented"])})).do((function(e){var r=yn.getTrack(n,e);o.duration=r.get("duration");var s=yn.getBitrate(n,e),a=o.addSourceBuffer(yn.getMimeType(r,s));i=Wi(t,n,a,o)})).catch((function(e){var r=e&&e.name,n=e&&e.message,i=(new Error).stack;"InvalidAccessError"===r?t.dispatch(jn(Bn,{message:n,stack:i})):"InvalidStateError"===r?t.dispatch(jn("MEDIA_SOURCE_NOT_OPEN",{message:n,stack:i})):"NotSupportedError"===r?t.dispatch(jn(Bn,{message:n,stack:i})):"QuotaExceededError"===r?t.dispatch(jn("MEDIA_SOURCE_QUOTA_EXCEEDED",{message:n,stack:i})):t.dispatch(jn(zn,{message:n,stack:i}))})).take(1).subscribe()),a.push(t.stateObservable.filter((function(t){return!t.getIn(["cache",n,"isDynamic"])})).map((function(t){return yn.getMediaReadyState(n,t)})).filter((function(t){return Fi(t)})).filter((function(){return!t.getState().getIn(["media",n,"mediaSource","sourceBuffer","updating"])})).map((function(){var e=t.getState(),r=e.getIn(["playback","bitrate"]);return e.getIn(["cache",n,"bitrates",r,"fragments",-1])})).filter((function(t){return t})).filter((function(e){var r=e.get("endTime"),i=t.getState().getIn(["media",n,"ranges"]);return yn.isFragmentInBufferedRanges(-1,r,i)})).subscribe((function(){t.dispatch(Ri.ended(n))}))),a.push(t.stateObservable.map((function(t){return t.getIn(["cache",n])})).filter((function(t){return t.get("isDynamic")})).distinctUntilChanged((function(t){return t.get("dynamicTrackEnded")})).filter((function(t){return t.get("dynamicTrackEnded")})).subscribe((function(){t.dispatch(Ri.ended(n))}))),a.push(t.stateObservable.map((function(t){return yn.getMediaReadyState(n,t)})).distinctUntilChanged().filter((function(t){return Ui(t)})).do((function(){return o.endOfStream()})).subscribe(Hi,(function(e){var r=e&&e.name,n=e&&e.message,i=(new Error).stack;"InvalidAccessError"===r?t.dispatch(jn("MEDIA_SOURCE_STREAM_ENDED",{message:n,stack:i})):t.dispatch(jn(zn,{message:n,stack:i}))}))),a=a.concat(function(t,e){var r=[];return t.dispatch(Ri[e.readyState](n)),r.push($.Observable.fromEvent(e,"sourceopen").subscribe((function(){return t.dispatch(Ri.open(n))}))),r.push($.Observable.fromEvent(e,"sourceclose").subscribe((function(){return t.dispatch(Ri.closed(n))}))),r.push($.Observable.fromEvent(e,"error").subscribe((function(e){var r=(new Error).stack;t.dispatch(jn(zn,{error:e,stack:r}))}))),r.push($.Observable.just().delay(1e3).filter((function(){return Pi(e.readyState)})).subscribe((function(){t.dispatch(jn("MEDIA_SOURCE_UNOPENED",{}))}))),r}(t,o)),{dispose:function(){i&&i.dispose(),a.forEach((function(t){return t.dispose()}));var e=t.getState();Pi(yn.getMediaReadyState(n,e))||t.dispatch(Ri.closed(n)),URL.revokeObjectURL(s)},mediaSource:o,objectURL:s}}(t,s,e))}))),i.push(t.stateObservable.filter((function(t){var r=t.getIn(["cache",e]);return r&&yn.getTrackProtocol(r)===tn})).distinctUntilChanged((function(t){return yn.getBitrate(e,t)})).filter((function(t){return!!yn.getBitrate(e,t)})).map((function(t){var r=yn.getBitrate(e,t),n=t.getIn(["cache",e,"bitrates",r,"uri"]);return{state:t,uri:n}})).filter((function(t){return!!t.uri})).subscribe((function(t){var r=t.state,n=t.uri;r.getIn(["media",e,"audioEl"]).src=n}))),{dispose:function(){n&&n.dispose&&n.dispose(),i.forEach((function(t){return t.dispose()}))},_getMediaSource:function(){return n?n.mediaSource:null}}},Gi=function(t,e,r,n){return function(i,o){var s=o(),a=s.getIn(["config","maxNetworkRetries"]);i({type:me,payload:{trackId:e,bitrate:r,label:n}}),Pr(t,t.resolver,a).flatMap((function(t){var e=s.getIn(["config","drm",n,"licenseServerResponseInterceptor"]);return e?$.Observable.of(e(t)):$.Observable.of(t)})).subscribe((function(t){i({type:_e,payload:{trackId:e,bitrate:r,label:n,data:t}})}),(function(t){var o={};t.response&&"function"==typeof t.response.json?t.response.json().then((function(t){Object.assign(o,t)})).catch((function(){})).finally((function(){i(jn(qn,{error:t,response:t.response,data:o})),i({type:we,payload:{trackId:e,bitrate:r,label:n}})})):(i(jn(qn,{error:t,response:t.response})),i({type:we,payload:{trackId:e,bitrate:r,label:n}}))}))}},Xi=function(t,e,r){return{type:Ee,payload:{trackId:t,bitrate:e,label:r}}},Yi=function(t,e,r){return{type:Se,payload:{trackId:t,bitrate:e,label:r}}},Ji=function(t,e){return{type:Te,payload:{trackId:t,label:e}}},$i=function(t){var e=gi(t.buffer,!0,!0).match(/skd:\/\/(.*)$/);if(e.length<2)throw new Error("no contentId matched");return e[1]},Qi=function(t,e,r){var n=vi(e),i=bi(r),o=0,s=new ArrayBuffer(t.byteLength+4+n.byteLength+4+i.byteLength),a=new DataView(s);new Uint8Array(s,o,t.byteLength).set(t),o+=t.byteLength,a.setUint32(o,n.byteLength,!0),o+=4;var u=new Uint16Array(s,o,n.length);return u.set(n),o+=u.byteLength,a.setUint32(o,i.byteLength,!0),o+=4,new Uint8Array(s,o,i.byteLength).set(i),new Uint8Array(s,0,s.byteLength)};function Zi(){}var to=function(t,e){if("object"!==r(t))throw new Error("Expected the store to be an object.");if("string"!=typeof e)throw new Error("Expected the trackId to be a string.");var n=[];function i(t){return $.Observable.merge($.Observable.fromEvent(t,"message"),$.Observable.fromEvent(t,"mskeymessage").filter((function(t){return!t.messageType||"license-request"===t.messageType})),$.Observable.fromEvent(t,"webkitkeymessage"))}function o(t,e,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=l.navigator.__emePolyfilled?[yn.getMediaKeySessionType(r,n),t instanceof Uint8Array?t:new Uint8Array(t)]:[],s=e.mediaKeys.createSession.apply(e.mediaKeys,o);return i&&(s.contentId=i),s}var s=new $.Subject,a=new $.ReplaySubject(1);t.stateObservable.filter((function(t){return t.getIn(["cache",e])})).distinctUntilChanged((function(t){return t.getIn(["cache",e,"isEncrypted"])})).filter((function(t){return t.getIn(["cache",e,"isEncrypted"])})).take(1).flatMap((function(t){var r=t.getIn(["media",e,"audioEl"]);return $.Observable.merge($.Observable.fromEvent(r,"encrypted"),$.Observable.fromEvent(r,"msneedkey").filter((function(t){return t.initData})),$.Observable.fromEvent(r,"webkitneedkey")).take(1)})).flatMap((function(r){var n=t.getState(),i=yn.getTrack(e,n),s=yn.getBitrate(i,n),u=i.getIn(["bitrates",s,"contentProtections"]),c=i.get("certificateData"),h=r.target;return function(e,r,n,i){var o=e.toList();return $.Observable.just().flatMap((function(){var t=o.first();return o=o.shift(),$.Observable.defer((function(){return function(t,e,r,n){var i=e.get("label"),o=[{initDataTypes:[yn.getTrackProtocol(t)===tn?"cbcs":an],audioCapabilities:[{contentType:r,robustness:"SW_SECURE_CRYPTO"}]}];return Ze.isChromeOS()&&(o[0].videoCapabilities=[{contentType:"".concat("video/mp4",'; codecs="').concat("avc1.4d401f",'"'),robustness:"SW_SECURE_DECODE"}]),navigator.requestMediaKeySystemAccess(i,o).then((function(t){return!Ze.isIE()&&n.mediaKeys?Promise.resolve():t.createMediaKeys().then((function(t){return n.setMediaKeys(t)}))}))}(r,t,yn.getMimeType(r,n),i)})).map((function(){return t}))})).retryWhen((function(t){return t.scan((function(t,e){if(o.size>0)return t+1;throw e}),0)})).catch((function(e){return e.message.includes("MediaDrmBridge creation failed")?t.dispatch(jn("MEDIA_DRM_BRIDGE_CREATION_FAILED"),{error:e}):t.dispatch(jn("NO_KEY_SYSTEM_SUPPORTED"),{error:e}),$.Observable.of(null)})).filter((function(t){return t})).take(1)}(u,i,s,h).map((function(t){return t.get("label")})).do((function(r){t.dispatch(Ji(e,r))})).map((function(){if(!c)return o(r.initData,h,i,s);try{var e=$i(r.initData);return o(Qi(r.initData,e,c),h,i,s,e)}catch(e){return void t.dispatch(jn("CREATE_MEDIA_KEY_SESSION_FAILED",{error:e}))}})).filter((function(t){return!!t})).do((function(e){if(!l.navigator.__emePolyfilled){var n=e.generateRequest(an,r.initData);n&&n.catch((function(e){t.dispatch(jn("EME_SESSION_GENERATE_REQUEST_FAILED",{error:e})),t.dispatch(Nn())}))}})).do((function(t){a.onNext(t)}))})).takeUntil(s).subscribe(),a.filter((function(t){return t})).flatMap((function(t){return i(t)})).do((function(r){var n=t.getState(),i=yn.getTrack(e,t.getState());!function(e,r,n,i){var o=t.getState(),s=o.getIn(["config","drm",i,"licenseServerUrl"]),a=o.getIn(["config","drm",i,"licenseServerRequestInterceptor"]),u=Object.assign({url:s,method:"POST",body:e.message,resolver:"arrayBuffer",headers:{}});u=Object.assign({},u,i===on?function(t){for(var e=gi(t.body,!0,!0),r=(new DOMParser).parseFromString(e,"application/xml"),n=Object.assign({},t),i=r.getElementsByTagName("HttpHeader"),o=0;o<i.length;++o){var s=i[o].querySelector("name"),a=i[o].querySelector("value");n.headers[s.textContent]=a.textContent}var u=r.querySelector("Challenge");return n.body=bi(u.textContent).buffer,n}(u):{}),u=a?a(u,r):u,t.dispatch(Gi(u,r,n,i))}(r,i.get("id"),yn.getBitrate(i,n),i.get("supportedContentProtection"))})).takeUntil(s).subscribe(),t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["cache",e,"supportedContentProtection"])})).filter((function(t){return t.getIn(["cache",e,"supportedContentProtection"])})).flatMap((function(){return t.stateObservable.filter((function(t){return yn.getTrack(e,t)})).filter((function(t){var r=yn.getTrack(e,t),n=yn.getTrackContentProtection(r,yn.getBitrate(r,t));return n&&n.get("data")})).distinctUntilChanged((function(t){var r=yn.getTrack(e,t);return yn.getTrackContentProtection(r,yn.getBitrate(r,t)).get("data")}))})).flatMap((function(r){return a.filter((function(t){return t})).flatMap((function(n){var i=yn.getTrack(e,r),o=yn.getBitrate(i,r),s=yn.getTrackContentProtection(i,o);return t.dispatch(Xi(i.get("id"),o,s.get("label"))),$.Observable.fromPromise(n.update(new Uint8Array(s.get("data")))).do((function(){t.dispatch(Yi(i.get("id"),o,s.get("label")))}))}))})).takeUntil(s).subscribe();var u=yn.getTrack(e,t.getState());if(u&&yn.getTrackProtocol(u)===Zr){var c=a.filter((function(t){return t})).flatMap((function(t){return i(t)})).take(1),h=a.filter((function(t){return t})).flatMap((function(t){return i(t)})).bufferWithCount(2),f=c.delay(500).filter((function(){return t.getState().getIn(["cache",e,"supportedContentProtection"])===nn})).do((function(){return t.dispatch(jn(Kn,{silent:!0}))}));n.push($.Observable.amb(h,f).take(1).subscribe())}return s.flatMap((function(){return a.filter((function(t){return t})).do((function(t){var e=t.close();void 0!==e&&e.catch(Zi)}))})).take(1).subscribe(),{dispose:function(){s.onNext(),s.onCompleted(),n.map((function(t){return t.dispose()}))}}},eo=function(t){if("object"!==r(t))throw new Error("Expected the store to be an object.");var e=new Map,n=t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["cache","trackIds"])})).subscribe((function(r){var n=r.getIn(["cache","trackIds"]);n.forEach((function(r){if(!e.get(r)){var n=new Set;n.add(Ki(t,r)),n.add(to(t,r)),e.set(r,n)}}));var i,o=f(e.keys());try{for(o.s();!(i=o.n()).done;){var s=i.value;n.includes(s)||(e.get(s).forEach((function(t){return t.dispose()})),e.get(s).clear(),e.delete(s))}}catch(r){o.e(r)}finally{o.f()}}));return{dispose:function(){n.dispose(),e.clear()},localCache:e}},ro=function(){function t(e){if(n(this,t),!e.getState().hasIn(["config","abr","audioQuality"]))throw new Error('The "audioQuality" is missing from the abr configuration')}return o(t,[{key:"abort",value:function(){}}]),t}(),no=function(t){return{type:ke,payload:{abr:{bandwidthBPS:parseInt(t,10)}}}},io=function(t){return{type:xe,payload:{abr:{bandwidthBPS:parseInt(t,10)}}}},oo=function(){function t(e){n(this,t),this.store=e,this.minBytes=16e3,this.minTotalBytes=128e3,this.samples=[],this.blackoutCounter=0,this.bytesSampled=0,this.minValue=1/0,this.blackoutEndTime=Date.now(),this.factor=e.getState().getIn(["config","abr","factor"]),this.samplesSize=e.getState().getIn(["config","abr","samples"]),this.blackoutDuration=e.getState().getIn(["config","abr","blackoutDuration"]),this.blackoutMaxDuration=e.getState().getIn(["config","abr","blackoutMaxDuration"]),this.disposable$=new $.Subject,this.onNewRequestCompleted$().takeUntil(this.disposable$).subscribe(),this.onStalled$().takeUntil(this.disposable$).subscribe()}return o(t,[{key:"sample",value:function(t){if(!(t.get("size")<this.minBytes)){var e=t.get("bitrate");this.samples.push(e),e<this.minValue&&(this.minValue=e),this.samples.length>this.samplesSize&&this.samples.shift()<=this.minValue&&(this.minValue=u(this.samples).sort((function(t,e){return t-e}))[0]),this.bytesSampled+=e}}},{key:"getBandwidthEstimate",value:function(t){return this.bytesSampled<this.minTotalBytes?t:this.minValue}},{key:"abort",value:function(){this.disposable$.onNext(),this.disposable$.onCompleted()}},{key:"onNewRequestCompleted$",value:function(){var t=this;return Ni.propertyObservable(this.store.stateObservable,"network","lastRequest").filter((function(t){return t})).do((function(e){return t.sample(e)})).filter((function(){return Date.now()>t.blackoutEndTime})).do((function(){var e=t.factor*t.getBandwidthEstimate(0);e&&(Date.now()>t.blackoutEndTime?t.store.dispatch(no(e)):t.store.dispatch(io(e)))}))}},{key:"onStalled$",value:function(){var t=this;return Ni.propertyObservable(this.store.stateObservable,"playback","stalled").filter((function(t){return t})).filter((function(){var e=t.store.getState(),r=e.getIn(["playback","time"]),n=e.getIn(["playback","id"]),i=e.getIn(["media",n,"ranges"]),o=Jr.getRange(i,r);return!o||o.last()-r<.5})).do((function(){Date.now()>t.blackoutEndTime&&(t.blackoutCounter=0),t.blackoutCounter+=1,t.blackoutEndTime=Date.now()+1e3*Math.min(t.blackoutDuration*Math.pow(2,t.blackoutCounter),t.blackoutMaxDuration);var e=t.store.getState(),r=Math.min(_n(e),e.getIn(["abr","bandwidthBPS"]));t.store.dispatch(no(r)),t.store.dispatch(Mn())}))}}]),t}(),so=function(){function t(e){n(this,t),this.alpha=Math.exp(Math.log(.5)/e),this.estimate=0,this.totalWeight=0}return o(t,[{key:"sample",value:function(t,e){var r=Math.pow(this.alpha,t),n=e*(1-r)+r*this.estimate;isNaN(n)||(this.estimate=n,this.totalWeight+=t)}},{key:"getEstimate",value:function(){var t=1-Math.pow(this.alpha,this.totalWeight);return this.estimate/t}}]),t}(),ao=function(){function t(e){if(n(this,t),this.store=e,this.fast=new so(2),this.slow=new so(10),this.bytesSampled=0,this.minTotalBytes=128e3,this.minBytes=16e3,this.factor=e.getState().getIn(["config","abr","factor"]),!this.factor)throw new Error('The "factor" is missing from the abr configuration');this.disposable$=new $.Subject,this.onNewRequestCompleted$().takeUntil(this.disposable$).subscribe(),this.onStalled$().takeUntil(this.disposable$).subscribe()}return o(t,[{key:"sample",value:function(t){if(!(t.get("size")<this.minBytes)){var e=t.get("bitrate"),r=t.get("latency")/1e3;this.bytesSampled+=t.get("size"),this.fast.sample(r,e),this.slow.sample(r,e)}}},{key:"getBandwidthEstimate",value:function(t){return this.bytesSampled<this.minTotalBytes?t:Math.min(this.fast.getEstimate(),this.slow.getEstimate())}},{key:"abort",value:function(){this.disposable$.onNext(),this.disposable$.onCompleted()}},{key:"onNewRequestCompleted$",value:function(){var t=this;return Ni.propertyObservable(this.store.stateObservable,"network","lastRequest").filter((function(t){return t})).do((function(e){return t.sample(e)})).do((function(){var e=t.factor*t.getBandwidthEstimate(0);e&&t.store.dispatch(no(e))}))}},{key:"onStalled$",value:function(){var t=this;return Ni.propertyObservable(this.store.stateObservable,"playback","stalled").filter((function(t){return t})).filter((function(){var e=t.store.getState(),r=e.getIn(["playback","time"]),n=e.getIn(["playback","id"]),i=e.getIn(["media",n,"ranges"]),o=Jr.getRange(i,r);return!o||o.last()-r<.5})).do((function(){return t.store.dispatch(Mn())}))}}]),t}(),uo=function(t){if("object"!==r(t))throw new Error("Expected the store to be an object.");var e,n=new $.Subject,i=["min","ewma","fixed"],o=t.getState().getIn(["config","abr","rule"])||i[0];if(-1===i.indexOf(o))throw new Error("Incorrect abr rule. Expected values: (".concat(i.join(", "),")"));return t.stateObservable.map((function(t){return t.getIn(["config","abr","rule"])})).filter((function(t){return!!t})).distinctUntilChanged().do((function(r){switch(e&&e.abort&&e.abort(),r){case"fixed":e=new ro(t);break;case"min":e=new oo(t);break;case"ewma":e=new ao(t)}})).takeUntil(n).subscribe(),{dispose:function(){n.onNext(),n.onCompleted()}}},co=function(t){if("object"!==r(t))throw new Error("Expected the store to be an object.");var e=function(t){var e=[],r=t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["network","online"])})).filter((function(t){return t.getIn(["network","online"])})),n=$.Observable.merge(t.stateObservable,r).filter((function(t){return t.getIn(["network","online"])})).map((function(t){return t.getIn(["cache","trackIds"])})).distinctUntilChanged().flatMapLatest((function(e){var r,n=[];return e.forEach((function(e){return n.push(function(t,e){return t.stateObservable.map((function(t){return t.getIn(["cache",e,"manifestIds"])})).filter((function(t){return!!t})).distinctUntilChanged().flatMapLatest((function(r){var n,i=[];return r.forEach((function(r){var n=["cache",e,"manifests",r,"manifest"];i.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(n)})).filter((function(t){return!!t.getIn(n)})).take(1).map((function(t){return{track:t.getIn(["cache",e]),manifestId:r}})))})),(n=$.Observable).merge.apply(n,i)}))}(t,e))})),(r=$.Observable).merge.apply(r,n)}));return e.push(Ni.propertyObservable(t.stateObservable,"cache","trackIds").subscribe((function(e){var r=t.getState().getIn(["config","cacheSize"]);if(e.size>r){var n=t.getState().getIn(["playback","id"]),i=e.first();n===i?t.dispatch(Ii(e.get(1))):t.dispatch(Ii(i))}}))),e.push($.Observable.merge(t.stateObservable,r).filter((function(t){return t.getIn(["network","online"])})).map((function(t){return t.getIn(["cache","trackIds"])})).subscribe((function(e){var r=t.getState(),n=r.getIn(["cache",e.last()]);if(n&&n.get("fragmented")){var i=yn.getBitrate(n,r),o=yn.getInitFragment(n,i);yn.isFragmentRequestable(o)&&t.dispatch(zi(n,i,o))}}))),e.push($.Observable.merge(t.stateObservable,r).filter((function(t){return t.getIn(["network","online"])})).distinctUntilChanged((function(t){return t.get("cache")})).subscribe((function(e){var r=e.getIn(["cache","trackIds"]),n=e.getIn(["playback","id"]);r.map((function(r){var i=e.getIn(["cache",r]);if(r!==n&&i&&i.get("fragmented")){var o=yn.getBitrate(i,e);if(!yn.isRequestingAFragment(i,o)){var s=e.getIn(["media",r,"ranges"]),a=i.get("isDynamic")?i.get("suggestedPresentationDelay"):e.getIn(["config","secondsToPrefetch"]),u=yn.getNextFragmentToFetch(i,o,s,0,a),c=i.get("fragmentDuration");yn.isFragmentRequestable(u,c,s)&&t.dispatch(zi(i,o,u))}}return!0}))}))),e.push(Ni.propertyObservable(t.stateObservable,"playback","id").scan((function(t,e){return{prev:t.curr,curr:e}}),{curr:void 0}).map((function(t){return t.prev})).filter((function(t){return t})).subscribe((function(e){var r=t.getState().getIn(["cache",e]);r&&r.get("fragmented")&&t.dispatch(Ei(r.get("id")))}))),e.push($.Observable.interval(1e3).subscribe((function(){var e=t.getState(),r=yn.getCurrentTrack(e);r&&r.get("isDynamic")&&!r.get("waitingServerTimeSync")&&Fi(yn.getMediaReadyState(r.get("id"),e))&&t.dispatch(ki(r))}))),e.push(n.subscribe((function(e){var r=e.track,n=e.manifestId;t.dispatch(Si(r,n))}))),e.push(n.map((function(t){return t.track})).filter((function(t){return!t.get("isDynamic")})).filter((function(e){return e.get("id")===t.getState().getIn(["playback","id"])})).filter((function(e){var r=e.get("id"),n=t.getState().getIn(["media",r,"ranges"]),i=e.get("duration")+e.get("presentationTimeOffset");return Jr.getRange(n,i)})).flatMapLatest((function(e){return t.stateObservable.map((function(t){return yn.getMediaReadyState(e.get("id"),t)})).filter((function(t){return Fi(t)})).map((function(){return e.get("id")})).filter((function(e){return!t.getState().getIn(["media",e,"mediaSource","sourceBuffer","updating"])}))})).subscribe((function(e){t.dispatch(Ri.ended(e))}))),e.push($.Observable.merge(t.stateObservable,r).filter((function(t){return t.getIn(["network","online"])})).distinctUntilChanged((function(t){return t.getIn(["cache","trackIds"])})).map((function(t){return t.getIn(["cache","trackIds"])})).flatMapLatest((function(e){var r,n=[];return e.forEach((function(e){n.push(t.stateObservable.distinctUntilChanged((function(){return t.getState().getIn(["cache",e,"waitingServerTimeSync"])})).filter((function(){return t.getState().getIn(["cache",e,"waitingServerTimeSync"])})).map((function(){return t.getState().getIn(["cache",e])})))})),(r=$.Observable).merge.apply(r,n)})).subscribe((function(e){e.get("isRequestingUTCTiming")||t.dispatch(Ai(e))}))),e.push($.Observable.merge(t.stateObservable,r).filter((function(t){return t.getIn(["network","online"])})).distinctUntilChanged((function(t){return t.getIn(["cache","trackIds"])})).subscribe((function(e){e.getIn(["cache","trackIds"]).forEach((function(r){var n=e.getIn(["cache",r]);n.get("waitingServerTimeSync")&&!n.get("isRequestingUTCTiming")&&t.dispatch(Ai(n))}))}))),e.push($.Observable.merge(t.stateObservable).distinctUntilChanged((function(t){return t.getIn(["cache","trackIds"])})).map((function(t){return t.getIn(["cache","trackIds"])})).flatMapLatest((function(e){var r,n=[];return e.forEach((function(e){n.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["cache",e,"serverTimeOffset"])})).filter((function(t){return!isNaN(t.getIn(["cache",e,"serverTimeOffset"]))})).map((function(t){return t.getIn(["cache",e])})))})),(r=$.Observable).merge.apply(r,n)})).subscribe((function(e){t.dispatch(ki(e)),t.dispatch(Ti(e.get("id")))}))),e}(t);return{dispose:function(){e.map((function(t){return t.dispose()}))}}},ho=function(){return{type:pe}},fo=function(){return{type:de}},lo=function(t){if("object"!==r(t))throw new Error("Expected the store to be an object.");l.navigator.onLine?t.dispatch(ho()):t.dispatch(fo());var e=function(t){var e=[],r=$.Observable.fromEvent(l,"online"),n=$.Observable.fromEvent(l,"offline");return e.push(r.subscribe((function(){t.dispatch(ho())}))),e.push(n.subscribe((function(){t.dispatch(fo())}))),e}(t);return{dispose:function(){var t,r=f(e);try{for(r.s();!(t=r.n()).done;)t.value.dispose()}catch(t){r.e(t)}finally{r.f()}}}},po=function(t){if("object"!==r(t))throw new Error("Expected the store to be an object.");var e=function(t){var e=[],r=t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["network","online"])})).filter((function(t){return t.getIn(["network","online"])}));return e.push(t.stateObservable.map((function(t){return t.getIn(["cache","trackIds"])})).filter((function(t){return!!t})).distinctUntilChanged().flatMapLatest((function(e){var r,n=[];return e.filter((function(e){var r=t.getState().getIn(["cache",e]);return yn.getTrackProtocol(r)===tn})).forEach((function(e){var r=["cache",e,"bitrateList"];n.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(r)})).filter((function(t){return!!t.getIn(r)})).map((function(){return e})))})),(r=$.Observable).merge.apply(r,n)})).subscribe((function(e){var r=t.getState().getIn(["cache",e]);r.get("bitrateList").forEach((function(e){var n=r.getIn(["bitrates",e,"uri"]),i=r.getIn(["manifests",n]);(!i||!i.get("isRequesting")&&!i.get("manifest"))&&t.dispatch(Di(n,r))}))}))),e.push($.Observable.merge(t.stateObservable,r).filter((function(t){return t.getIn(["network","online"])})).distinctUntilChanged((function(t){return t.getIn(["media"])})).map((function(t){return t.getIn(["cache","trackIds"])})).flatMapLatest((function(e){var r,n=[];return e.forEach((function(e){n.push(t.stateObservable.distinctUntilChanged((function(){return t.getState().getIn(["media",e,"lastBufferedIndex"])})).filter((function(){return t.getState().getIn(["media",e,"lastBufferedIndex"])>=0})).map((function(){return t.getState().getIn(["cache",e])})))})),(r=$.Observable).merge.apply(r,n)})).subscribe((function(e){if(e&&e.get("fragmented")){var r=e.get("id"),n=t.getState().getIn(["media",r,"lastBufferedIndex"]),i=t.getState().getIn(["media",r,"lastBufferedData"]),o=i&&n!==e.get("lastIndexWithEMSG")?yn.getEMSGEvents(e,i):null;o&&o.forEach((function(r){if("urn:mpeg:dash:event:2012"===r.schemeIdUri&&"1"===r.value){var i=e.get("manifests");i&&i.valueSeq&&i.valueSeq().filter((function(t){return!t.get("isRequesting")})).forEach((function(r){t.dispatch(Di(r.get("url"),e,{lastBufferedIndex:n}))}))}}))}}))),e}(t);return{dispose:function(){var t,r=f(e);try{for(r.s();!(t=r.n()).done;)t.value.dispose()}catch(t){r.e(t)}finally{r.f()}}}};function bo(t,e){return Object.assign(document.createElement(t),e)}var go={createElement:bo,createDebugPanel:function(){return bo("div",{id:"maestroDebugPanel"})},createPlayerStatus:function(){var t=bo("div",{className:"playerStatus"});return["bitrate","bufferRange","lastBufferedIndex","numOfAvailableSegments"].forEach((function(e){t.appendChild(bo("li",{id:e,innerHTML:e}))})),t},createStreamingStatus:function(){var t=bo("div",{className:"streamingStatus"}),e=bo("div",{innerHTML:" blue - appended, green - appending, yellow - waiting for appending, orange - requesting, red - waiting for requesting  "});return t.appendChild(e),t.style.marginBottom="10px",t.style.height="100px",t},createPropertyWatcher:function(){var t=bo("span",{className:"propertyWatcher"});return t.appendChild(bo("input",{id:"keyPath"})),t.appendChild(bo("button",{innerHTML:"submit"})),t.appendChild(bo("span",{innerHTML:" for example: playback "})),t},createCloseDebugPanel:function(){var t=bo("span",{id:"closeDebugPanel",innerHTML:"&#10006;"});return t.style.right="20px",t.style.position="absolute",t}},vo=function(t,e){var r=go.createPropertyWatcher();e.appendChild(r);var n=r.querySelector("button"),i=[];return n.addEventListener("click",(function(){var e=r.querySelector("input").value.replace(/\s/g,"").split(","),n=document.querySelector(".propertyWatcher"),o=go.createElement("li",{innerHTML:e});n.appendChild(o),i.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(e)})).map((function(t){return t.getIn(e)})).subscribe((function(t){o.innerHTML="".concat(e," is ").concat(t)})))})),{dispose:function(){i.map((function(t){return t.dispose()}))}}},yo=function(t,e){var r=[];return r.push(t.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t.getIn(["playback","id"])})).map((function(t){return yn.getCurrentTrack(t)})).filter((function(t){return t&&t.get("fragmented")&&!t.get("isDynamic")})).subscribe((function(t){var r=document.querySelector(".streamingStatus");r&&e.removeChild(r);var n=Math.min(t.get("numOfAvailableSegments"),500);r=go.createStreamingStatus(),t.get("bitrateList").forEach((function(t){for(var e=0;e<n;){var i=go.createElement("canvas",{id:"".concat(t,"_").concat(e)});i.style.width=Qr(100/n,2)+"%",i.style.height="20%",i.style.float="left",r.appendChild(i),e++}r.appendChild(go.createElement("br"))})),e.appendChild(r)}))),r.push(t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).map((function(t){return yn.getCurrentTrack(t)})).distinctUntilChanged((function(t){return t&&t.get("fragmented")&&t.get("isDynamic")})).filter((function(t){return t&&t.get("fragmented")&&t.get("isDynamic")})).subscribe((function(t){var r=document.querySelector(".streamingStatus");r&&e.removeChild(r);var n=t.get("numOfAvailableSegments");r=go.createStreamingStatus(),t.get("bitrateList").forEach((function(t){for(var e=n;e<n+50;){var i=go.createElement("canvas",{id:"".concat(t,"_").concat(e)});i.style.width=Qr(2,2)+"%",i.style.height="20%",i.style.float="left",r.appendChild(i),e++}r.appendChild(go.createElement("br"))})),e.appendChild(r)}))),r.push(t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("fragmented")})).map((function(t){return t.getIn(["playback","id"])})).distinctUntilChanged().flatMapLatest((function(e){var r,n=[];return yn.getTrack(e,t.getState()).get("bitrateList").forEach((function(r){n.push(function(t,e,r){return t.stateObservable.map((function(t){return yn.getTrack(e,t)})).filter((function(t){return t})).flatMap((function(){var n=["cache",e,"bitrates",r];return t.stateObservable.distinctUntilChanged((function(t){return t.getIn(n)})).filter((function(t){return t.getIn(n)})).map((function(t){return{fragmentDuration:t.getIn(["cache",e,"fragmentDuration"]),fragments:t.getIn(n).get("fragments"),bitrate:r,ranges:t.getIn(["media",e,"ranges"])}}))}))}(t,e,r))})),(r=$.Observable).merge.apply(r,n)})).subscribe((function(t){var e,r,n;e=t.fragments,t.fragmentDuration,r=t.ranges,n=t.bitrate,e.forEach((function(t){!function(t,e,r,n){var i,o=document.getElementById("".concat(n,"_").concat(t.index));o&&(i=yn.isFragmentInBufferedRanges(t.startTime,t.endTime,r)?"blue":t.data&&t.isBuffering?"green":t.data&&!t.isBuffering?"yellow":t.isRequesting?"orange":"red",o.style.backgroundColor=i)}(t.toJS(),0,r,n)}))}))),{dispose:function(){r.map((function(t){return t.dispose()}))}}},mo=function(t,e){var r=go.createPlayerStatus(),n=[];function i(e){return t.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("fragmented")})).map((function(t){return t.getIn(e)})).filter((function(t){return t})).distinctUntilChanged()}return e.appendChild(r),n.push(t.stateObservable.map((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t})).distinctUntilChanged().flatMap((function(t){return i(["media",t,"lastBufferedIndex"])})).subscribe((function(t){r.querySelector("#lastBufferedIndex").innerHTML="lastBufferedIndex is ".concat(t)}))),n.push(t.stateObservable.map((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t})).distinctUntilChanged().flatMap((function(t){return i(["media",t,"ranges"])})).subscribe((function(t){var e=r.querySelector("#bufferRange"),n="bufferRange: ";t.forEach((function(t){n+="".concat(t.get(0)," to ").concat(t.get(1)," ")})),e.innerHTML=n}))),n.push(t.stateObservable.map((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t})).distinctUntilChanged().flatMap((function(t){return i(["cache",t,"numOfAvailableSegments"])})).subscribe((function(t){r.querySelector("#numOfAvailableSegments").innerHTML="numOfAvailableSegments is ".concat(t)}))),n.push(i(["playback","bitrate"]).subscribe((function(t){r.querySelector("#bitrate").innerHTML="bitrate is ".concat(t)}))),{dispose:function(){n.map((function(t){return t.dispose()}))}}},_o=function(t){var e=function(t){var e=document.body,r=go.createDebugPanel(),n=vo(t,r);r.appendChild(go.createCloseDebugPanel());var i=mo(t,r),o=yo(t,r);return e.insertBefore(r,e.firstChild),{dispose:function(){n.dispose(),i.dispose(),o.dispose()}}}(t);return document.querySelector("#closeDebugPanel").addEventListener("click",(function(){e.dispose(),document.body.removeChild(document.querySelector("#maestroDebugPanel"))})),{dispose:function(){return e.dispose()}}},wo=function(){return!l.navigator.requestMediaKeySystemAccess&&!!l.MSMediaKeys||!!l.WebKitMediaKeys},Eo=function(){l.MSMediaKeys?l.HTMLAudioElement.prototype.setMediaKeys=function(t){this.msSetMediaKeys(t),this.mediaKeys=t}:l.WebKitMediaKeys&&(Object.defineProperty(l.HTMLAudioElement.prototype,"mediaKeys",{get:function(){return this.webkitKeys}}),l.HTMLAudioElement.prototype.setMediaKeys=function(t){this.webkitSetMediaKeys(t)}),l.navigator.__emePolyfilled=!0,l.navigator.requestMediaKeySystemAccess=function(t,e){var r,n=!0,i=f(e);try{for(i.s();!(r=i.n()).done;){var o,s=f(r.value.audioCapabilities);try{for(s.s();!(o=s.n()).done;){var a=o.value;n&&(l.MSMediaKeys?n=l.MSMediaKeys.isTypeSupported(t,a.contentType):l.WebKitMediaKeys&&(n=l.WebKitMediaKeys.isTypeSupported(t,a.contentType)))}}catch(t){s.e(t)}finally{s.f()}}}catch(t){i.e(t)}finally{i.f()}return n?Promise.resolve({createMediaKeys:function(){var e;return l.MSMediaKeys?e=new l.MSMediaKeys(t):l.WebKitMediaKeys&&(e=new l.WebKitMediaKeys(t)),Promise.resolve(e)}}):Promise.reject()}};return{Player:function(){function t(){n(this,t),this.store=function(){var t=Kr.apply(void 0,arguments);return t.stateObservable=Gr(t),t}(),wo()&&Eo(),this.ABREngine=uo(this.store),this.streamingEngine=Vi(this.store),this.cacheEngine=co(this.store),this.networkEngine=lo(this.store),this.manifestEngine=po(this.store),this.playbackEngine=qi(this.store),this.mediaEngine=eo(this.store),Ce.getDebugMode()&&(this.debugPanel=_o(this.store)),this._listeners={paused:[],error:[],ended:[],started:[],timeupdate:[],buffertime:[],bitratechange:[],canplay:[],stalled:[],seeking:[],resumed:[],expired:[],fragmentLatency:[]},this.listenerObservables=this._setupEventListeners(),this.load=this.load.bind(this),this.play=this.play.bind(this),this.resume=this.resume.bind(this),this.pause=this.pause.bind(this),this.mute=this.mute.bind(this),this.repeat=this.repeat.bind(this),this.seekTo=this.seekTo.bind(this),this.volume=this.volume.bind(this),this.setConfig=this.setConfig.bind(this),this.isPlaying=this.isPlaying.bind(this),this.isPaused=this.isPaused.bind(this),this.isEnded=this.isEnded.bind(this),this.isCached=this.isCached.bind(this),this.isStalled=this.isStalled.bind(this),this.isSeeking=this.isSeeking.bind(this),this.getCurrentTime=this.getCurrentTime.bind(this),this.getCurrentBitrate=this.getCurrentBitrate.bind(this),this.getBufferedTime=this.getBufferedTime.bind(this),this.getDuration=this.getDuration.bind(this),this.getAudioElement=this.getAudioElement.bind(this),this.getVolume=this.getVolume.bind(this),this.addEventListener=this.addEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.decreaseBitrate=this.decreaseBitrate.bind(this),this.increaseBitrate=this.increaseBitrate.bind(this),this.destroy=this.destroy.bind(this),this.getNetworkMetrics=this.getNetworkMetrics.bind(this),this.getCurrentState=this.getCurrentState.bind(this),this.getLatestError=this.getLatestError.bind(this)}return o(t,[{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t.id;this.store.dispatch(wi(t));var n=yn.getTrack(r,this.store.getState());return n.get("manifests")||this.store.dispatch(Di(n.get("url"),n)),e>0&&(this.seekTo(e),this.store.dispatch(In()),this.store.dispatch(Sn(r,e))),this}},{key:"play",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=yn.getTrack(t,this.store.getState()),n=r.get("isDynamic")?yn.getDynamicTrackDurationWithOffset(r):e;return this.store.dispatch(In()),this.store.dispatch(Sn(t,n)),this.store.dispatch(En()),this}},{key:"remove",value:function(t){return this.store.dispatch(Ii(t)),this}},{key:"resume",value:function(){return this.store.dispatch(En()),this}},{key:"pause",value:function(){return this.store.dispatch(In()),this}},{key:"mute",value:function(){return this.store.dispatch(On()),this}},{key:"repeat",value:function(){return this.store.dispatch(kn()),this}},{key:"seekTo",value:function(t){return this.store.dispatch(Dn(t)),this}},{key:"volume",value:function(t){return this.store.dispatch(An(t)),this}},{key:"setConfig",value:function(t){return this.store.dispatch(xi(t)),this}},{key:"isPlaying",value:function(){return this.store.getState().getIn(["playback","playing"])}},{key:"isPaused",value:function(){return this.store.getState().getIn(["playback","paused"])}},{key:"isEnded",value:function(){return this.store.getState().getIn(["playback","ended"])}},{key:"isCached",value:function(t){return this.store.getState().get("cache").has(t)}},{key:"isStalled",value:function(){return this.store.getState().getIn(["playback","stalled"])}},{key:"isSeeking",value:function(){return this.store.getState().getIn(["playback","seeking"])}},{key:"getCacheList",value:function(){return this.store.getState().getIn(["cache","trackIds"]).toArray()}},{key:"isCurrentTrackId",value:function(t){var e=yn.getCurrentTrack(this.store.getState());return!!e&&e.get("id")===t}},{key:"getCurrentTrackId",value:function(){var t=yn.getCurrentTrack(this.store.getState());return t?t.get("id"):null}},{key:"getCurrentTime",value:function(){return this.store.getState().getIn(["playback","time"])}},{key:"getCurrentBitrate",value:function(){return this.store.getState().getIn(["playback","bitrate"])}},{key:"getBufferedTime",value:function(){var t=this.store.getState(),e=yn.getCurrentTrack(t),r=this.getCurrentTime();if(!e)return r;var n=t.getIn(["media",e.get("id"),"ranges"]),i=Jr.getRange(n,r);return i?i.get(1):r}},{key:"getDuration",value:function(){return this.store.getState().getIn(["playback","duration"])}},{key:"getAudioElement",value:function(){var t=this.store.getState(),e=yn.getCurrentTrack(t);if(e)return t.getIn(["media",e.get("id"),"audioEl"])}},{key:"getNetworkMetrics",value:function(t){var e=this.store.getState().get("network");return t?e.get(t).toJS():e.toJS()}},{key:"getBandwidthBPS",value:function(){return this.store.getState().getIn(["abr","bandwidthBPS"])}},{key:"getLatestBandwidthBPS",value:function(){return this.store.getState().getIn(["abr","latestBandwidthBPS"])}},{key:"getVolume",value:function(){return this.store.getState().getIn(["playback","volume"])}},{key:"getCurrentState",value:function(){return this.store.getState()}},{key:"getLatestError",value:function(){var t=this.store.getState().getIn(["errors","list"]).last();return t?t.toJS():null}},{key:"getPlaybackTimestamps",value:function(){return this.store.getState().getIn(["playbackTimestamps"]).toJS()}},{key:"addEventListener",value:function(t,e){var r=this._listeners[t];return r&&r.push(e),this}},{key:"removeEventListener",value:function(t,e){var r=this._listeners[t];if(r){var n=r.indexOf(e);n>=0&&r.splice(n,1)}return this}},{key:"_setupEventListeners",value:function(){var t=this,e=[];e.push(Ni.propertyObservable(this.store.stateObservable,"playback","time").subscribe((function(e){t._listeners.timeupdate.forEach((function(t){return t(e)}))}))),e.push(Ni.propertyObservable(this.store.stateObservable,"playback","bitrate").subscribe((function(e){t._listeners.bitratechange.forEach((function(t){return t(e)}))}))),e.push(Ni.truthyPropertyObservable(this.store.stateObservable,"playback","started").subscribe((function(){t._listeners.started.forEach((function(t){return t()}))}))),e.push(this.store.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","ended"])})).filter((function(t){return t.getIn(["playback","ended"])})).subscribe((function(){t._listeners.ended.forEach((function(t){return t()}))}))),e.push(this.store.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","stalled"])})).filter((function(t){return t.getIn(["playback","started"])})).subscribe((function(e){var r=e.getIn(["playback","stalled"]),n=e.getIn(["playback","bitrate"]);t._listeners.stalled.forEach((function(t){return t(r,n)}))}))),e.push(this.store.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","paused"])})).filter((function(t){return t.getIn(["playback","started"])})).filter((function(t){return t.getIn(["playback","paused"])})).subscribe((function(){t._listeners.paused.forEach((function(t){return t()}))}))),e.push(this.store.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","paused"])})).filter((function(t){return t.getIn(["playback","started"])})).filter((function(t){return!t.getIn(["playback","paused"])})).subscribe((function(){t._listeners.resumed.forEach((function(t){return t()}))}))),e.push(this.store.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","seeking"])})).filter((function(t){return t.getIn(["playback","started"])})).subscribe((function(e){var r=e.getIn(["playback","seeking"]);t._listeners.seeking.forEach((function(t){return t(r)}))}))),e.push(this.store.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t.getIn(["playback","id"])})).flatMapLatest((function(e){var r=e.getIn(["playback","id"]),n=e.getIn(["media",r,"ranges"]);return n&&n.size>0?$.Observable.just():t.store.stateObservable.map((function(t){return t.getIn(["media",r,"ranges"])})).filter((function(t){return t&&t.size>=1})).take(1)})).subscribe((function(){t._listeners.canplay.forEach((function(t){return t()}))}))),e.push(Ni.propertyObservable(this.store.stateObservable,"errors","list").subscribe((function(e){var r=e.last();if(r){var n=r.get("extra").toJS();n.silent||t._listeners.error.forEach((function(t){return t(r.get("error"),n)}))}}))),e.push(this.store.stateObservable.filter((function(t){return t.getIn(["playback","id"])})).filter((function(t){return t.getIn(["playback","started"])})).distinctUntilChanged((function(t){var e=t.getIn(["playback","id"]);return t.getIn(["media",e,"ranges"])})).map((function(t){var e=t.getIn(["playback","id"]),r=t.getIn(["media",e,"ranges"]),n=t.getIn(["playback","time"]);return Jr.bufferedAheadOf(r,n)})).subscribe((function(e){t._listeners.buffertime.forEach((function(t){return t(e)}))})));var r=this.store.stateObservable.filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("expireAt")})).distinctUntilChanged((function(t){return yn.getCurrentTrack(t).get("expireAt")})),n=this.store.stateObservable.distinctUntilChanged((function(t){return t.getIn(["playback","id"])})).filter((function(t){var e=yn.getCurrentTrack(t);return e&&e.get("expireAt")}));return e.push($.Observable.merge(n,r).flatMapLatest((function(t){var e=yn.getCurrentTrack(t),r=t.getIn(["config","secondsToRetryManifest"]),n=t.getIn(["config","secondsToRetryManifestJitter"]),i=e.get("expireAt"),o=Math.random()*n;return $.Observable.just().delay(i-Date.now()-1e3*(r+o))})).subscribe((function(){t._listeners.expired.forEach((function(t){return t()}))}))),e.push(this.store.stateObservable.map((function(t){return t.getIn(["network","lastRequest"])})).filter((function(t){return t})).distinctUntilChanged((function(t){return t.get("time")})).subscribe((function(e){t._listeners.fragmentLatency.forEach((function(t){return t(e.get("latency"),e.get("time"))}))}))),e}},{key:"decreaseBitrate",value:function(){return this.store.dispatch(Un()),this}},{key:"increaseBitrate",value:function(){return this.store.dispatch(Ln()),this}},{key:"destroy",value:function(){return this.ABREngine.dispose(),this.playbackEngine.dispose(),this.streamingEngine.dispose(),this.cacheEngine.dispose(),this.networkEngine.dispose(),this.mediaEngine.dispose(),this.manifestEngine.dispose(),this.createDebugPanel&&this.createDebugPanel.dispose(),this.store.unsubscribe(),this.listenerObservables.forEach((function(t){return t.dispose()})),this}}],[{key:"isSupported",value:function(t){var e,r=!!l.Audio&&!!l.MediaSource;e=t?r&&MediaSource.isTypeSupported(t):r;var n=Ze.isVersionSupported();return e&&n}},{key:"isEMESupported",value:function(t,e){var r=Ze.isEMEVersionSupported()&&(!!l.MSMediaKeys||!!l.MediaKeys&&!!l.navigator&&!!l.navigator.requestMediaKeySystemAccess&&!!l.MediaKeySystemAccess&&!!l.MediaKeySystemAccess.prototype.getConfiguration);return t?r?l.navigator.requestMediaKeySystemAccess(t,e):Promise.reject():r}}]),t}(),Config:Ce}}()}).call(this,r("yLpj"),r("YuTi")(t))},YsRS:function(t,e,r){(function(t){!function(e){"use strict";var r=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};function n(t){var e=t.appName,n=t.appVersion,i=r()+"-"+r()+"-"+e.substring(0,4)+"-"+r()+"-"+(r()+Math.floor(16*(1+Math.random())).toString(16).substring(1));return"Maestro/1.0 "+e+"/"+n+" ("+i+")"}function i(t,e){var r=[],n=e,i=Array.isArray(n),o=0;for(n=i?n:n[Symbol.iterator]();;){var s;if(i){if(o>=n.length)break;s=n[o++]}else{if((o=n.next()).done)break;s=o.value}var a=s;t.hasOwnProperty(a)&&t[a]||r.push(a)}if(r.length>0)throw"the configuration is missing the following keys: "+r.join(", ")}var o={UK:"music.amazon.co.uk",DE:"music.amazon.de",CH:"music.amazon.de",AT:"music.amazon.de",FR:"music.amazon.fr",IT:"music.amazon.it",JP:"music.amazon.co.jp",ES:"music.amazon.es",IN:"music.amazon.in",MX:"music.amazon.com.mx",CA:"music.amazon.ca",AU:"music.amazon.com.au",NZ:"music.amazon.com.au",BR:"music.amazon.com.br"},s={US:"NA",CA:"NA",MX:"NA",BR:"NA",AR:"NA",BO:"NA",CL:"NA",CO:"NA",CR:"NA",DO:"NA",EC:"NA",SV:"NA",GT:"NA",HN:"NA",NI:"NA",PA:"NA",PY:"NA",PE:"NA",UY:"NA",GB:"EU",DE:"EU",CH:"EU",AT:"EU",FR:"EU",IT:"EU",ES:"EU",IN:"EU",IE:"EU",BE:"EU",BG:"EU",CY:"EU",CZ:"EU",EE:"EU",FI:"EU",GR:"EU",HU:"EU",IS:"EU",LV:"EU",LI:"EU",LT:"EU",LU:"EU",MT:"EU",NL:"EU",PL:"EU",PT:"EU",SK:"EU",SE:"EU",JP:"FE",AU:"FE",NZ:"FE"},a=["api"];function u(t){var e=t.musicTerritory,r=t.api,n=t.hostname,u=t.protocol,c=void 0===u?"https:":u;i({api:r},a);var h=function(t){return void 0===t&&(t="US"),s[t]||"NA"}(e);return c+"//"+(!n||function(t){return t.includes(".amazon.")&&!function(t){return t.includes(".amazon.")&&t.includes("music")}(t)&&!t.includes(".aka.")}(n)?function(t){return void 0===t&&(t="US"),o[t]||"music.amazon.com"}(e):n)+"/"+h+"/api/"+r+"/"}var c={},h=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}};function f(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var l=Object.prototype.toString;function p(t){return"[object Array]"===l.call(t)}function d(t){return null!==t&&"object"==typeof t}function b(t){return"[object Function]"===l.call(t)}function g(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),p(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}var v={isArray:p,isArrayBuffer:function(t){return"[object ArrayBuffer]"===l.call(t)},isBuffer:function(t){return null!=t&&(f(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&f(t.slice(0,0))}(t)||!!t._isBuffer)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:d,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===l.call(t)},isFile:function(t){return"[object File]"===l.call(t)},isBlob:function(t){return"[object Blob]"===l.call(t)},isFunction:b,isStream:function(t){return d(t)&&b(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:g,merge:function t(){var e={};function r(r,n){"object"==typeof e[n]&&"object"==typeof r?e[n]=t(e[n],r):e[n]=r}for(var n=0,i=arguments.length;n<i;n++)g(arguments[n],r);return e},extend:function(t,e,r){return g(e,(function(e,n){t[n]=r&&"function"==typeof e?h(e,r):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}},y=function(t,e,r,n,i){return function(t,e,r,n,i){return t.config=e,r&&(t.code=r),t.request=n,t.response=i,t}(new Error(t),e,r,n,i)};function m(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var _=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],w=v.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=n(window.location.href),function(e){var r=v.isString(e)?n(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0};function E(){this.message="String contains an invalid character"}E.prototype=new Error,E.prototype.code=5,E.prototype.name="InvalidCharacterError";var S=function(t){for(var e,r,n=String(t),i="",o=0,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.charAt(0|o)||(s="=",o%1);i+=s.charAt(63&e>>8-o%1*8)){if((r=n.charCodeAt(o+=.75))>255)throw new E;e=e<<8|r}return i},I=v.isStandardBrowserEnv()?{write:function(t,e,r,n,i,o){var s=[];s.push(t+"="+encodeURIComponent(e)),v.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),v.isString(n)&&s.push("path="+n),v.isString(i)&&s.push("domain="+i),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},T="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||S,k=function(t){return new Promise((function(e,r){var n=t.data,i=t.headers;v.isFormData(n)&&delete i["Content-Type"];var o=new XMLHttpRequest,s="onreadystatechange",a=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in o||w(t.url)||(o=new window.XDomainRequest,s="onload",a=!0,o.onprogress=function(){},o.ontimeout=function(){}),t.auth){var u=t.auth.username||"",c=t.auth.password||"";i.Authorization="Basic "+T(u+":"+c)}if(o.open(t.method.toUpperCase(),function(t,e,r){if(!e)return t;var n;if(r)n=r(e);else if(v.isURLSearchParams(e))n=e.toString();else{var i=[];v.forEach(e,(function(t,e){null!=t&&(v.isArray(t)?e+="[]":t=[t],v.forEach(t,(function(t){v.isDate(t)?t=t.toISOString():v.isObject(t)&&(t=JSON.stringify(t)),i.push(m(e)+"="+m(t))})))})),n=i.join("&")}return n&&(t+=(-1===t.indexOf("?")?"?":"&")+n),t}(t.url,t.params,t.paramsSerializer),!0),o.timeout=t.timeout,o[s]=function(){if(o&&(4===o.readyState||a)&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in o?function(t){var e,r,n,i={};return t?(v.forEach(t.split("\n"),(function(t){if(n=t.indexOf(":"),e=v.trim(t.substr(0,n)).toLowerCase(),r=v.trim(t.substr(n+1)),e){if(i[e]&&_.indexOf(e)>=0)return;i[e]="set-cookie"===e?(i[e]?i[e]:[]).concat([r]):i[e]?i[e]+", "+r:r}})),i):i}(o.getAllResponseHeaders()):null,i={data:t.responseType&&"text"!==t.responseType?o.response:o.responseText,status:1223===o.status?204:o.status,statusText:1223===o.status?"No Content":o.statusText,headers:n,config:t,request:o};!function(t,e,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?e(y("Request failed with status code "+r.status,r.config,null,r.request,r)):t(r)}(e,r,i),o=null}},o.onerror=function(){r(y("Network Error",t,null,o)),o=null},o.ontimeout=function(){r(y("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",o)),o=null},v.isStandardBrowserEnv()){var h=I,f=(t.withCredentials||w(t.url))&&t.xsrfCookieName?h.read(t.xsrfCookieName):void 0;f&&(i[t.xsrfHeaderName]=f)}if("setRequestHeader"in o&&v.forEach(i,(function(t,e){void 0===n&&"content-type"===e.toLowerCase()?delete i[e]:o.setRequestHeader(e,t)})),t.withCredentials&&(o.withCredentials=!0),t.responseType)try{o.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&o.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&o.upload&&o.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){o&&(o.abort(),r(t),o=null)})),void 0===n&&(n=null),o.send(n)}))},x={"Content-Type":"application/x-www-form-urlencoded"};function O(t,e){!v.isUndefined(t)&&v.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var C,D={adapter:("undefined"!=typeof XMLHttpRequest?C=k:void 0!==t&&(C=k),C),transformRequest:[function(t,e){return function(t,e){v.forEach(t,(function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])}))}(e,"Content-Type"),v.isFormData(t)||v.isArrayBuffer(t)||v.isBuffer(t)||v.isStream(t)||v.isFile(t)||v.isBlob(t)?t:v.isArrayBufferView(t)?t.buffer:v.isURLSearchParams(t)?(O(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):v.isObject(t)?(O(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};v.forEach(["delete","get","head"],(function(t){D.headers[t]={}})),v.forEach(["post","put","patch"],(function(t){D.headers[t]=v.merge(x)}));var A=D;function R(){this.handlers=[]}R.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},R.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},R.prototype.forEach=function(t){v.forEach(this.handlers,(function(e){null!==e&&t(e)}))};var M=R,N=function(t,e,r){return v.forEach(r,(function(r){t=r(t,e)})),t},F=function(t){return!(!t||!t.__CANCEL__)};function P(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var U=function(t){var e,r,n;return P(t),t.baseURL&&(n=t.url,!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(n))&&(t.url=(e=t.baseURL,(r=t.url)?e.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):e)),t.headers=t.headers||{},t.data=N(t.data,t.headers,t.transformRequest),t.headers=v.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),v.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||A.adapter)(t).then((function(e){return P(t),e.data=N(e.data,e.headers,t.transformResponse),e}),(function(e){return F(e)||(P(t),e&&e.response&&(e.response.data=N(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))};function L(t){this.defaults=t,this.interceptors={request:new M,response:new M}}L.prototype.request=function(t){"string"==typeof t&&(t=v.merge({url:arguments[0]},arguments[1])),(t=v.merge(A,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[U,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)r=r.then(e.shift(),e.shift());return r},v.forEach(["delete","get","head","options"],(function(t){L.prototype[t]=function(e,r){return this.request(v.merge(r||{},{method:t,url:e}))}})),v.forEach(["post","put","patch"],(function(t){L.prototype[t]=function(e,r,n){return this.request(v.merge(n||{},{method:t,url:e,data:r}))}}));var j=L;function q(t){this.message=t}q.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},q.prototype.__CANCEL__=!0;var B=q;function z(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var r=this;t((function(t){r.reason||(r.reason=new B(t),e(r.reason))}))}z.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},z.source=function(){var t;return{token:new z((function(e){t=e})),cancel:t}};var V=z;function W(t){var e=new j(t),r=h(j.prototype.request,e);return v.extend(r,j.prototype,e),v.extend(r,e),r}var H=W(A);H.Axios=j,H.create=function(t){return W(v.merge(A,t))},H.Cancel=B,H.CancelToken=V,H.isCancel=F,H.all=function(t){return Promise.all(t)},H.spread=function(t){return function(e){return t.apply(null,e)}};var K=H,G=H;K.default=G;var X=K;function Y(t,e){var r={"Content-Encoding":"amz-1.0","Content-Type":"application/json"};if(e&&(r["X-Amz-Target"]=e),t.oAuthToken&&(r.Authorization="Bearer "+t.oAuthToken),t.csrf&&(r["csrf-rnd"]=t.csrf.rnd,r["csrf-token"]=t.csrf.token,r["csrf-ts"]=t.csrf.ts),t.cookie)try{r.Cookie=t.cookie}catch(t){console.warn(t)}return r}var J=["method","hostname","api"];function $(t){i(t,J);var e=Object.assign({},c,t),r=Y(e,e.target),n={method:e.method,url:u(e),dataType:"json",headers:r};return e.body&&(n.data=e.body),X(n)}var Q=["hostname","api"],Z=["deviceType","deviceId"];function tt(t){i(t,Z),t.sessionId=t.sessionId||"111-1111111-1111111";var e={customerId:t.customerId,deviceId:t.deviceId,deviceType:t.deviceType,sessionId:t.sessionId,musicTerritory:t.musicTerritory};return t.customerId&&(e.customerId=t.customerId),e}var et=["actionName","timestamp"],rt=["deviceId","deviceType","hostname","musicTerritory"],nt=["appVersion","specificEventVersion","musicTerritory"];function it(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var ot,st=function(t){return t<10?"0"+t:t},at=["actionName","appVersion","specificEventVersion","musicTerritory"],ut=["csSessionId"],ct=function(t){var e,r,n,i=this;if(!t.actionName)throw new Error("Cirrus metric Events must have a name");this.additionalDetails={baseEventVersion:"3",specificEventVersion:t.specificEventVersion,deviceTimeZone:(e=new Date,r=e.getTimezoneOffset()>0?"-":"+",n=Math.abs(e.getTimezoneOffset()),""+r+st(Math.floor(n/60))+":"+st(n%60)),appVersion:t.appVersion,musicTerritory:t.musicTerritory},this.timestamp=Date.now()/1e3,this.actionName=t.actionName,t.sessionId&&(t.csSessionId=t.sessionId),at.forEach((function(e){if(!t[e])throw new Error("Base Metric Events require "+e+" to be passed in")})),ut.forEach((function(e){void 0!==t[e]&&(i.additionalDetails[e]=t[e]+"")}))},ht=["asin","cdObjectId","platformName","subDeviceId","subDeviceId","subDeviceStreamMedium","selectionSourceId","selectionSourceType","selectionSourceSessionId"],ft=["asin","bitrates","campaignId","cdObjectId","externalId","initialPlaybackDelaySeconds","locale","mediaPlayerName","metricsContext","platformName","scrobblingStatus","selectionSourceId","selectionSourceSessionId","selectionSourceSubType","subDeviceId","subDeviceStreamMedium","trackCount","transferSpeedBPS","url","cdnType"],lt=["asin","bytesExpected","bytesReceived","campaignId","cdObjectId","durationSeconds","initialPlaybackDelayMilliseconds","initialPlaybackDelaySeconds","alexaTtsIpdMilliseconds","mediaPlayerName","percentageCompleted","selectionSourceId","selectionSourceSubType","selectionSourceSessionId","subDeviceId","subDeviceStreamMedium","transferSpeedBPS"],pt=["asin","campaignId","cdObjectId","contentSubscriptionMode","externalId","initialPlaybackDelaySeconds","linkedAmznAccountId","locale","metricsContext","platformName","resourceType","scrobblingStatus","selectionSourceSubType","speakerId","subDeviceId","subDeviceStreamMedium","trackCount","isVoiceInitiated","isDirectedPlay"],dt=["associateTag","detailPageItemId","detailPageItemIdType","loadTimeMilliseconds","pageSubType","referer","refMarker","region","viewType"],bt=["entityId","entityIdType","entityPos","entityType","interactionType","pageType","pageSubType","refMarker","url"],gt=["contentInfoInstId","contentSrc"],vt=["actionType"],yt=["flexEventName","strings","numbers"],mt={StreamingInitiatedMetric:function(t){function e(e){var r;void 0===e&&(e={}),e.actionName="streamingInitiated",e.specificEventVersion="1";var n=e,i=n.contentSubscriptionMode,o=void 0===i?"NONE":i,s=n.isDirectedPlay,a=void 0===s?"false":s,u=n.isExplicitLanguageFilterOn,c=void 0===u?"false":u,h=n.isShufflePlay,f=void 0===h?"false":h,l=n.locale,p=void 0===l?"en_US":l,d=n.mediaPlayerName,b=void 0===d?"MAESTRO":d,g=n.resourceType,v=void 0===g?null:g,y=n.source,m=void 0===y?"WIFI":y,_=n.streamOrDRMTech;if((r=t.call(this,e)||this).additionalDetails=Object.assign({},r.additionalDetails,{contentSubscriptionMode:o,isDirectedPlay:a,isExplicitLanguageFilterOn:c,isShufflePlay:f,locale:p,mediaPlayerName:b,resourceType:v,source:m,streamOrDRMTech:_}),ht.forEach((function(t){void 0!==e[t]&&(r.additionalDetails[t]=e[t]+"")})),!r.additionalDetails.asin&&!r.additionalDetails.cdObjectId)throw new Error("Streaming Initiated Metrics must have an asin or cdObjectId");return r}return it(e,t),e}(ct),StreamingTerminatedMetric:function(t){function e(e){var r;void 0===e&&(e={}),e.actionName="streamingTerminated",e.specificEventVersion="4";var n=e,i=n.cacheHitStatus,o=void 0===i?"UNKNOWN":i,s=n.durationSeconds,a=n.initialPlaybackDelayMilliseconds,u=n.isDirectedPlay,c=void 0===u?"false":u,h=n.isExplicitLanguageFilterOn,f=void 0===h?"false":h,l=n.contentSubscriptionMode,p=void 0===l?"NONE":l,d=n.isShufflePlay,b=void 0===d?"false":d,g=n.pageType,v=n.rebufferCount,y=void 0===v?"0":v,m=n.resourceType,_=n.selectionSourceType,w=n.source,E=void 0===w?"WIFI":w,S=n.streamOrDRMTech,I=n.terminationReason;if((r=t.call(this,e)||this).additionalDetails=Object.assign({},r.additionalDetails,{cacheHitStatus:o,durationSeconds:s,initialPlaybackDelayMilliseconds:a,isDirectedPlay:c,isExplicitLanguageFilterOn:f,contentSubscriptionMode:p,isShufflePlay:b,pageType:g,rebufferCount:y,resourceType:m,selectionSourceType:_,source:E,streamOrDRMTech:S,terminationReason:I}),ft.forEach((function(t){void 0!==e[t]&&(r.additionalDetails[t]=e[t]+"")})),!r.additionalDetails.asin&&!r.additionalDetails.cdObjectId)throw new Error("Streaming Terminated Metrics must have an asin or cdObjectId");return r}return it(e,t),e}(ct),StreamingRequiredRebufferingMetric:function(t){function e(e){var r;e.actionName="streamingRequiredReBuffering",e.specificEventVersion="3";var n=e.bitrates,i=e.cacheHitStatus,o=void 0===i?"UNKNOWN":i,s=e.contentSubscriptionMode,a=void 0===s?"NONE":s,u=e.durationMilliseconds,c=e.isExplicitLanguageFilterOn,h=void 0!==c&&c,f=e.loadTimeMilliseconds,l=e.selectionSourceType,p=void 0===l?"AUTO_PLAYLIST":l,d=e.source,b=void 0===d?"WIFI":d,g=e.streamOrDRMTech;if((r=t.call(this,e)||this).additionalDetails=Object.assign(r.additionalDetails,{bitrates:n,cacheHitStatus:o,contentSubscriptionMode:a,durationMilliseconds:u,isExplicitLanguageFilterOn:h,loadTimeMilliseconds:f,selectionSourceType:p,source:b,streamOrDRMTech:g}),lt.forEach((function(t){void 0!==e[t]&&(r.additionalDetails[t]=e[t]+"")})),!r.additionalDetails.asin&&!r.additionalDetails.cdObjectId)throw new Error("Streaming Initiated Metrics must have an asin or cdObjectId");return r}return it(e,t),e}(ct),TrackStreamedMetric:function(t){function e(e){var r;void 0===e&&(e={}),e.actionName="trackStreamed",e.specificEventVersion="3";var n=e,i=n.selectionSourceId,o=void 0===i?"":i,s=n.selectionSourceType,a=void 0===s?"":s,u=n.subDeviceId,c=void 0===u?"UNKNOWN":u,h=n.trackProgress,f=void 0===h?"0":h;return(r=t.call(this,e)||this).additionalDetails=Object.assign({},r.additionalDetails,{selectionSourceId:o,selectionSourceType:a,subDeviceId:c,trackProgress:f}),pt.forEach((function(t){void 0!==e[t]&&(r.additionalDetails[t]=e[t])})),r.additionalDetails.asin||r.additionalDetails.cdObjectId||(r.additionalDetails.asin="o",r.additionalDetails.cdObjectId="o"),r}return it(e,t),e}(ct),UIPageViewMetric:function(t){function e(e){var r;if(void 0===e&&(e={}),!e.pageType)throw new Error("UIPageView Metrics must have a pageType");return e.actionName="uiPageView",e.specificEventVersion="2",(r=t.call(this,e)||this).additionalDetails=Object.assign({},r.additionalDetails,{pageType:e.pageType}),dt.forEach((function(t){void 0!==e[t]&&(r.additionalDetails[t]=e[t]+"")})),r}return it(e,t),e}(ct),UIClickMetric:function(t){function e(e){var r;void 0===e&&(e={}),vt.forEach((function(t){if(!e[t])throw new Error("UIClick Metrics must have a "+t)})),e.actionName="uiClick",e.specificEventVersion="4",(r=t.call(this,e)||this).additionalDetails=Object.assign({},r.additionalDetails,{actionType:e.actionType});var n={};return gt.forEach((function(t){void 0!==e[t]&&(n[t]=""+e[t])})),Object.keys(n).length&&(r.contentInfo=[n]),bt.forEach((function(t){void 0!==e[t]&&(r.additionalDetails[t]=""+e[t])})),r}return it(e,t),e}(ct),FlexMetric:function(t){function e(e){var r;if(void 0===e&&(e={}),yt.forEach((function(t){if(!e[t])throw new Error("UIClick Metrics must have a "+t)})),e.strings.length>4)throw new Error("You cannot have more than 4 flex strings reported");if(e.numbers.length>4)throw new Error("You cannot have more than 4 flex numbers reported");return e.actionName="flexEvent",e.specificEventVersion="1",e.baseEventVersion="2",(r=t.call(this,e)||this).additionalDetails=Object.assign({},r.additionalDetails,{flexEventName:e.flexEventName}),e.strings.reduce((function(t,e,r){return t["flexStr"+(r+1)]=e.toString(),t}),r.additionalDetails),e.numbers.reduce((function(t,e,r){return t["flexNum"+(r+1)]=e.toString(),t}),r.additionalDetails),r}return it(e,t),e}(ct)},_t=["customerId","deviceId","deviceType","oAuthToken","musicTerritory"],wt=new Uint8Array(16);function Et(){if(!ot&&!(ot="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ot(wt)}var St=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function It(t){return"string"==typeof t&&St.test(t)}for(var Tt,kt,xt=[],Ot=0;Ot<256;++Ot)xt.push((Ot+256).toString(16).substr(1));var Ct=0,Dt=0;function At(t,e,r){var n=e&&r||0,i=e||new Array(16),o=(t=t||{}).node||Tt,s=void 0!==t.clockseq?t.clockseq:kt;if(null==o||null==s){var a=t.random||(t.rng||Et)();null==o&&(o=Tt=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==s&&(s=kt=16383&(a[6]<<8|a[7]))}var u=void 0!==t.msecs?t.msecs:Date.now(),c=void 0!==t.nsecs?t.nsecs:Dt+1,h=u-Ct+(c-Dt)/1e4;if(h<0&&void 0===t.clockseq&&(s=s+1&16383),(h<0||u>Ct)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ct=u,Dt=c,kt=s;var f=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=255&f;var l=u/4294967296*1e4&268435455;i[n++]=l>>>8&255,i[n++]=255&l,i[n++]=l>>>24&15|16,i[n++]=l>>>16&255,i[n++]=s>>>8|128,i[n++]=255&s;for(var p=0;p<6;++p)i[n+p]=o[p];return e||function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(xt[t[e+0]]+xt[t[e+1]]+xt[t[e+2]]+xt[t[e+3]]+"-"+xt[t[e+4]]+xt[t[e+5]]+"-"+xt[t[e+6]]+xt[t[e+7]]+"-"+xt[t[e+8]]+xt[t[e+9]]+"-"+xt[t[e+10]]+xt[t[e+11]]+xt[t[e+12]]+xt[t[e+13]]+xt[t[e+14]]+xt[t[e+15]]).toLowerCase();if(!It(r))throw TypeError("Stringified UUID is invalid");return r}(i)}var Rt=["customerId","deviceTypeId","deviceId","clientId"];function Mt(t){return i(t,Rt),{customerId:t.customerId,deviceToken:{deviceTypeId:t.deviceTypeId,deviceId:t.deviceId},appMetadata:{https:"true"},clientMetadata:{clientId:t.clientId,clientRequestId:At()}}}var Nt=["musicTerritory"];function Ft(t,e,r,n){void 0===n&&(n={}),console.warn("getDashManifest has been deprecated in favor of getDashManifestsV2"),i(n=Object.assign({},c,n,{api:"dmls"}),Nt);var o=Y(n,"com.amazon.digitalmusiclocator.DigitalMusicLocatorServiceExternal.getDashManifests"),s=Object.assign({},Mt(n),{contentIdList:[{identifier:t,identifierType:"ASIN"}],bitRateList:r,mpegDashVersion:"V1"});return X({method:"post",url:u(n),data:s,headers:o})}var Pt=["appName","appVersion","musicTerritory"],Ut=["LOW","MEDIUM","HIGH"],Lt=["musicTerritory","marketplaceId","tier","clientId","ipAddress","customerId","userAgent","appVersion","containerFormat","format","drmType"],jt=["musicTerritory"],qt=["customerId","deviceTypeId","deviceId","clientId","ipAddress","musicTerritory"];function Bt(t){return i(t,qt),{Operation:"com.amazon.amazonmusicaudiolocatorservice.model.getondemandstreamingurls#GetOnDemandStreamingURLs",Service:"com.amazon.amazonmusicaudiolocatorservice.model#AmazonMusicAudioLocatorServiceExternal",Input:{customerId:t.customerId,deviceToken:{deviceTypeId:t.deviceTypeId,deviceId:t.deviceId},appMetadata:{appId:t.clientId},clientMetadata:{clientId:t.deviceTypeId,clientIpAddress:t.ipAddress}}}}var zt=[],Vt=[],Wt=["deviceType","deviceId"];function Ht(t){i(t,Wt),t.sessionId=t.sesionId||"111-1111111-1111111";var e={deviceType:t.deviceType,deviceId:t.deviceId,sessionId:t.sessionId};return t.customerId&&(e.customerId=t.customerId),e}var Kt=["customerId","deviceType","musicTerritory"],Gt=["musicTerritory"],Xt=["x-amzn-application-version","x-amzn-device-family","x-amzn-device-height","x-amzn-device-width","x-amzn-device-id","x-amzn-device-language","x-amzn-device-model","x-amzn-device-time-zone","x-amzn-os-version","x-amzn-request-id","x-amzn-timestamp","x-amzn-authentication"],Yt={getMusicAgent:n,getRequestUrl:u};e.Utils=Yt,e.defaults=c,e.get=function(t){return i(t,Q),$(Object.assign({},t,{method:"GET"}))},e.post=function(t){return i(t,[].concat(Q,["body"])),$(Object.assign({},t,{method:"POST"}))},e.put=function(t){return i(t,[].concat(Q,["body"])),$(Object.assign({},t,{method:"PUT"}))},e.reportClientActions=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),i(e=Object.assign({},c,e,{api:"cirrus/v3"}),rt),t.forEach((function(t){return i(t,et)})),t.forEach((function(t){return i(t.additionalDetails,nt)}));var r=Y(e,"com.amazon.cirrus.libraryservice.v3.CirrusLibraryServiceExternalV3.reportClientActions"),n=Object.assign({},tt(e),{clientActionList:t}),o=u(e);return X({method:"post",url:o,headers:r,data:n})},e.metrics=mt,e.getLibraryCounts=function(t){void 0===t&&(t={}),i(t=Object.assign({},c,t,{api:"cirrus/v3"}),_t);var e=Y(t,"com.amazon.cirrus.libraryservice.v3.CirrusLibraryServiceExternalV3.getLibraryCounts"),r=Object.assign({},tt(t),{counts:t.counts});return X({method:"post",url:u(t),data:r,headers:e,responseType:"json"})},e.getDashManifests=Ft,e.getDashManifestsV2=function(t,e,r){void 0===e&&(e=Ut),void 0===r&&(r={}),i(r=Object.assign({},c,r,{api:"dmls"}),Pt);var o=Y(r,"com.amazon.digitalmusiclocator.DigitalMusicLocatorServiceExternal.getDashManifestsV2"),s=Object.assign({},Mt(r),{contentIdList:[{identifier:t,identifierType:"ASIN"}],bitrateTypeList:e,musicDashVersionList:["V1","V2"],appInfo:{musicAgent:n(r)}});return r.VMPFailed&&(s.deviceToken=s.deviceToken||{},s.deviceToken.vmpValidationStatus="UNVERIFIED"),X({method:"post",responseType:"json",url:u(r),data:s,headers:o})},e.getDashManifestByAsin=function(t,e,r){return void 0===r&&(r={}),Ft(t,0,e,r)},e.getStreamingURLsWithFirstChunkV2=function(t,e,r){void 0===r&&(r={}),i(r=Object.assign({},c,r,{api:"dmls"}),Lt);var n=r,o=n.musicTerritory,s=n.marketplaceId,a=n.tier,h=n.clientId,f=n.ipAddress,l=n.customerId,p=n.userAgent,d=n.appVersion,b=n.additionalMetadata,g=n.containerFormat,v=n.format,y=n.drmType,m=function(t){switch(t){case"AMF":return"NIGHTWING";case"PRIME":return"ROBIN";case"UNLIMITED":return"HAWKFIRE";case"UNLIMITED_HD":return"KATANA";case"NONE":default:return""}}(a);if(!m||"NIGHTWING"===m&&"HIGH"===e)throw new Error("Unentitled DMLS request");var _=Y(r,"com.amazon.digitalmusiclocator.DigitalMusicLocatorServiceExternal.getStreamingURLsWithFirstChunkV2"),w=Object.assign({},Mt(r),{contentIdList:[{identifier:t,identifierType:"ASIN"}],customerInfo:{marketplaceId:s,territoryId:o,entitlementList:[m]},musicRequestIdentityContext:{musicIdentities:{musicAccountCid:l}},protocol:g,format:v,drmType:y});return Object.assign(w.clientMetadata,{clientIpAddress:f}),Object.assign(w.appMetadata,{appId:h,appVersion:d,userAgent:p}),b&&(w.appMetadata.additionalMetadata=b),e&&(w.bitRate=e),X({method:"post",responseType:"json",url:u(r),data:w,headers:_})},e.getRestrictedStreamingURL=function(t,e,r){void 0===r&&(r={}),i(r=Object.assign({},c,r,{api:"dmls"}),jt);var n=Y(r,"com.amazon.digitalmusiclocator.DigitalMusicLocatorServiceExternal.getRestrictedStreamingURL"),o=Object.assign({},Mt(r),{contentId:{identifier:t,identifierType:e},bitRate:"HIGH"});return X({method:"post",url:u(r),data:o,headers:n})},e.getLiveStreamingURL=function(t,e,r){void 0===e&&(e="DASH"),void 0===r&&(r={}),i(r=Object.assign({},c,r,{api:"amals"}),zt);var n=Y(r,"com.amazon.amazonmusicaudiolocatorservice.model.AmazonMusicAudioLocatorServiceExternal.GetLiveStreamingURLs"),o=Object.assign({},Bt(r),{Operation:"com.amazon.amazonmusicaudiolocatorservice.model.getlivestreamingurls#GetLiveStreamingURLs"});return o.Input=Object.assign({},o.Input,{contentIdList:[{identifier:t,identifierType:"MCID"}],protocol:e}),delete n["Content-Encoding"],X({method:"post",responseType:"json",url:u(r)+"getLiveStreamingURL",data:o,headers:n})},e.getOnDemandStreamingURL=function(t,e,r){void 0===e&&(e="DASH"),void 0===r&&(r={}),i(r=Object.assign({},c,r,{api:"amals"}),Vt);var n=Y(r,"com.amazon.amazonmusicaudiolocatorservice.model.AmazonMusicAudioLocatorServiceExternal.GetOnDemandStreamingURLs"),o=Object.assign({},Bt(r),{Operation:"com.amazon.amazonmusicaudiolocatorservice.model.getondemandstreamingurls#GetOnDemandStreamingURLs"});return o.Input=Object.assign({},o.Input,{contentIdList:[{identifier:t,identifierType:"MCID"}],protocol:e}),delete n["Content-Encoding"],X({method:"post",responseType:"json",url:u(r)+"getOnDemandStreamingURLs",data:o,headers:n})},e.acceptTermsOfUse=function(){return console.log("acceptTermsOfUse")},e.retrieveAccount=function(t){i(t=Object.assign({},c,t,{api:"stratus"}),Kt);var e=Y(t,"com.amazon.stratus.StratusServiceExternal.retrieveAccount"),r=Object.assign({},Ht(t),{responseFilters:["BENEFITS","HISTORY","LOCATION","STORAGE","TERMSOFUSE","VERIFIED"]});return X({method:"post",url:u(t),dataType:"json",data:r,headers:e})},e.retrieveCustomerHome=function(t){i(t=Object.assign({},c,t,{api:"stratus"}),Gt);var e=Y(t,"com.amazon.stratus.StratusServiceExternal.retrieveCustomerHome"),r=Ht(t);return X({method:"post",url:u(t),dataType:"json",data:r,headers:e})},e.skyfire=function(t,e){return void 0===e&&(e={}),e["x-amzn-device-id"]=e["x-amzn-device-id"]||c.deviceId,e["x-amzn-authentication"]=e["x-amzn-authentication"]||c.oAuthToken,i(e,Xt),X({url:"https://na.tv.music.a2z.com/"+t,responseType:"json",method:"get",headers:e})},Object.defineProperty(e,"__esModule",{value:!0})}(e)}).call(this,r("8oxB"))},YuTi:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},sTBv:function(t,e,r){!function(t,e,r){e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var n=function(t){for(const e of[].slice.call(arguments,1))if(e)for(const r of Object.keys(e)){const n=e[r];void 0!==n&&(t[r]=n)}return t},i=t=>""+(t=>"boolean"==typeof t?t:"true"===t)(t),o=t=>isNaN(t)?"":""+t;class s{now(){return Date.now()}}function a(){try{return localStorage&&"true"===localStorage.getItem("DEBUG")}catch(t){return!1}}var u=function(){a()&&console.log([].slice.call(arguments))},c=(t,e)=>{const r=[];for(const n of e)t.hasOwnProperty(n)&&t[n]||r.push(n);if(r.length>0)throw"the configuration is missing the following keys: "+r.join(", ")};const h={dmlsName:"WIDEVINE",keySystem:"com.widevine.alpha",supportedConfiguration:[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:"SW_SECURE_DECODE"}]}]},f={dmlsName:"WIDEVINE",keySystem:"com.widevine.alpha",supportedConfiguration:[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}]}]},l={dmlsName:"PLAYREADY",keySystem:"com.microsoft.playready",supportedConfiguration:[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:"SW_SECURE_DECODE"}]}]},p={dmlsName:"FAIRPLAY",keySystem:"com.apple.fps.1_0",supportedConfiguration:[{initDataTypes:["cbcs"],audioCapabilities:[{contentType:'audio/aac;codecs="mp4a.40.2"'}]}]},d={WIDEVINE:h,WIDEVINE_MOBILE:f,PLAYREADY:l,FAIRPLAY:p},b=["LOW","MEDIUM","HIGH"];var g=function(t){var e=[].slice.call(arguments,1);return e.length?function(){for(var r=[].slice.call(arguments),n=[],i=0;i<e.length;i++){var o=e[i];n[i]=void 0===o?r.shift():o}return t.apply(this,n.concat(r))}:t};function v(t,e,n){n.resolver="json",n.credentials="same-origin",n.headers=Object.assign({"content-type":"application/json","X-Amz-Target":"com.amazon.digitalmusiclocator.DigitalMusicLocatorServiceExternal.getLicenseForPlaybackV2","X-Requested-With":"XMLHttpRequest","Content-Encoding":"amz-1.0"},n.headers),e.oAuthToken&&(n.headers.Authorization="Bearer "+e.oAuthToken),e.csrf&&(n.headers["csrf-rnd"]=e.csrf.rnd,n.headers["csrf-token"]=e.csrf.token,n.headers["csrf-ts"]=e.csrf.ts),delete n.headers["Content-Type"],delete n.headers.SOAPAction;let i={DrmType:t,licenseChallenge:btoa(String.fromCharCode.apply(null,new Uint8Array(n.body))),customerId:e.customerId,deviceToken:{deviceTypeId:e.deviceTypeId,deviceId:e.deviceId},appInfo:{musicAgent:r.Utils.getMusicAgent(e)}};return e.oAuthToken&&(i.Authorization="Bearer "+e.oAuthToken),n.body=JSON.stringify(i),n}function y(t){for(var e=window.atob(t.license),r=e.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=e.charCodeAt(i);return n.buffer}var m=t=>{let e={};for(const n of Object.values(d))e[n.keySystem]={licenseServerUrl:r.Utils.getRequestUrl({api:"dmls",hostname:t.hostname,musicTerritory:t.musicTerritory}),licenseServerRequestInterceptor:g(v,n.dmlsName,t),licenseServerResponseInterceptor:y};return e},_=t=>!!window.WebKitMediaKeys&&t.hls,w=()=>!!window.navigator.platform.match(/iPhone|iPod|iPad/)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>0,E=()=>{const t=window.navigator;return t.vendor&&t.vendor.indexOf("Apple")>-1&&t.userAgent&&-1==t.userAgent.indexOf("CriOS")&&-1==t.userAgent.indexOf("FxiOS")};class S{constructor({appVersion:t,contentSubscriptionMode:e,customerId:r,locale:n,musicTerritory:i,resourceType:o,source:s}={}){this.appVersion=t,this.contentSubscriptionMode=e,this.customerId=r,this.locale=n,this.musicTerritory=i,this.resourceType=o,this.source=s}}class I{constructor({hasEnded:t=!1,id:e,initiatedAt:r=null,isDirectedPlay:n=!1,isExplicitLanguageFilterOn:i=!1,isShufflePlay:o=!1,isCached:s=!1,pageType:a,rebufferCount:u=0,selectionSourceId:c,selectionSourceType:h,selectionSourceSessionId:f,stalledAt:l=null,startedAt:p=null,type:d}={}){this.applyUpdates({hasEnded:t,id:e,initiatedAt:r,isDirectedPlay:n,isExplicitLanguageFilterOn:i,isShufflePlay:o,isCached:s,pageType:a,rebufferCount:u,selectionSourceId:c,selectionSourceType:h,selectionSourceSessionId:f,stalledAt:l,startedAt:p,type:d})}applyUpdates(t){return Object.keys(t).forEach(e=>{this[e]=t[e]}),this}getMetricsBaseAttributes(t){const{appVersion:e,contentSubscriptionMode:r,customerId:n,locale:i,musicTerritory:o,resourceType:s,source:a}=t.getConfig();return new S({appVersion:e,contentSubscriptionMode:r,customerId:n,locale:i,musicTerritory:o,resourceType:s,source:a})}getMetricsBitrates(t){const e=t.getCurrentBitrate();return e>=256e3?"AutoHigh":e>128e3?"AutoMedium":"AutoLow"}getMetricsCacheHitStatus(t){return this.isCached?t.getBufferedTime()<t.getDuration()?"PARTIAL":"COMPLETE":"NONE"}getMetricsStreamOrDRMTech(t){switch(this.type){case"asin":const e=t.getConfig().flags;return _(e)?"HLS":e.drm&&!E()?"DASH_DRM":"DASH";case"coid":case"https":return"PROG";case"livemcid":return _(t.getConfig().flags)?"HLS":"DASH";case"staticmcid":return"DASH";default:return null}}getMetricsTrackIdentifier(){switch(this.type){case"asin":return{asin:this.id};case"coid":default:return{cdObjectId:this.id}}}asStreamingInitiatedMetric({player:t,overrides:e}){const o={isDirectedPlay:i(this.isDirectedPlay),isExplicitLanguageFilterOn:i(this.isExplicitLanguageFilterOn),isShufflePlay:i(this.isShufflePlay),selectionSourceId:this.selectionSourceId,selectionSourceSessionId:this.selectionSourceSessionId,selectionSourceType:this.selectionSourceType,streamOrDRMTech:this.getMetricsStreamOrDRMTech(t)};return new r.metrics.StreamingInitiatedMetric(n({},this.getMetricsBaseAttributes(t),o,this.getMetricsTrackIdentifier(),e))}asStreamingRequiredRebufferingMetric({clock:t,player:e,overrides:s}){const a={bitrates:this.getMetricsBitrates(e),cacheHitStatus:this.getMetricsCacheHitStatus(e),durationMilliseconds:o(t.now()-this.stalledAt),initialPlaybackDelayMilliseconds:o(this.startedAt-this.initiatedAt),isExplicitLanguageFilterOn:i(this.isExplicitLanguageFilterOn),loadTimeMilliseconds:o(this.stalledAt),selectionSourceId:this.selectionSourceId,selectionSourceSessionId:this.selectionSourceSessionId,selectionSourceType:this.selectionSourceType,streamOrDRMTech:this.getMetricsStreamOrDRMTech(e),cdnType:this.cdnType};return new r.metrics.StreamingRequiredRebufferingMetric(n({},this.getMetricsBaseAttributes(e),a,this.getMetricsTrackIdentifier(),s))}asStreamingTerminatedMetric({clock:t,overrides:e,player:s}){const a={bitrates:this.getMetricsBitrates(s),cacheHitStatus:this.getMetricsCacheHitStatus(s),durationSeconds:o(Math.floor((t.now()-this.startedAt)/1e3)),initialPlaybackDelayMilliseconds:o(this.startedAt-this.initiatedAt),isDirectedPlay:i(this.isDirectedPlay),isExplicitLanguageFilterOn:i(this.isExplicitLanguageFilterOn),isShufflePlay:i(this.isShufflePlay),pageType:this.pageType,rebufferCount:o(this.rebufferCount),selectionSourceId:this.selectionSourceId,selectionSourceSessionId:this.selectionSourceSessionId,selectionSourceType:this.selectionSourceType,streamOrDRMTech:this.getMetricsStreamOrDRMTech(s),terminationReason:this.terminationReason,cdnType:this.cdnType};return new r.metrics.StreamingTerminatedMetric(n({},this.getMetricsBaseAttributes(s),a,this.getMetricsTrackIdentifier(),e))}asTrackStreamedMetric({overrides:t,player:e}){const i={selectionSourceId:this.selectionSourceId,selectionSourceType:this.selectionSourceType,trackProgress:o(Math.round(e.getCurrentTime()))};return new r.metrics.TrackStreamedMetric(n({},this.getMetricsBaseAttributes(e),i,this.getMetricsTrackIdentifier(),t))}}class T{constructor({player:t,clock:e=new s}){this.player=t,this.clock=e,this.tracks={},this.currentRequestedTrack=null,window.addEventListener("beforeunload",this.onBeforeunload.bind(this)),t.addEventListener("ended",this.onEnded.bind(this)),t.addEventListener("stalled",this.onStalled.bind(this)),t.addEventListener("started",this.onStarted.bind(this))}reportMetrics(){var t=[].slice.call(arguments);this.player.configuration.flags.metrics&&(u("Emitting metrics: "+t.map(t=>t.actionName),t),r.reportClientActions(t,this.player.getConfig()))}shouldEmitStreamingRequiredRebuffering(){return this.currentRequestedTrack&&"number"==typeof this.currentRequestedTrack.stalledAt&&this.clock.now()-this.currentRequestedTrack.stalledAt>10}currentRequestedTrackIsPaused(){return this.currentRequestedTrack&&"number"==typeof this.currentRequestedTrack.pausedAt}currentRequestedTrackHasStartedButNotEnded(){return this.currentRequestedTrack&&"number"==typeof this.currentRequestedTrack.startedAt&&!this.currentRequestedTrack.hasEnded}currentRequestedTrackHasStarted(){return this.currentRequestedTrack&&"number"==typeof this.currentRequestedTrack.startedAt}currentRequestedTrackHasStartedFromTheBeginnging(){return this.currentRequestedTrack&&this.currentRequestedTrack.hasStartedFromTheBeginning}currentRequestedTrackHasEnded(){return this.currentRequestedTrack&&this.currentRequestedTrack.hasEnded}currentRequestedTrackHasChanged(t){return this.currentRequestedTrack&&!this.player.isCurrentTrackId(t)}currentRequestedTrackHasChangedOrEnded(){return this.currentRequestedTrackHasChanged(this.currentRequestedTrack&&this.currentRequestedTrack.id)||this.currentRequestedTrackHasEnded()}currentRequestedTrackHasRestarted(t,e){return this.currentRequestedTrack&&t&&this.currentRequestedTrack.id===t&&this.currentRequestedTrackHasStarted()&&0===e}updateLoadedTrack(t){this.tracks[t.id]?this.tracks[t.id].applyUpdates(t):this.tracks[t.id]=new I(t)}updateCurrentTrack(t){null===this.currentRequestedTrack||t.id&&t.id!==this.currentRequestedTrack.id?this.currentRequestedTrack=new I(t):this.currentRequestedTrack.applyUpdates(t),this.tracks[this.currentRequestedTrack.id]=this.currentRequestedTrack}getStreamingInitiated(t={}){return this.currentRequestedTrack.asStreamingInitiatedMetric({overrides:t,player:this.player})}getStreamingRequiredReBuffering(t={}){return this.currentRequestedTrack.asStreamingRequiredRebufferingMetric({clock:this.clock,overrides:t,player:this.player})}getStreamingTerminated(t={}){return this.currentRequestedTrack.asStreamingTerminatedMetric({clock:this.clock,overrides:t,player:this.player})}getTrackStreamed(t={}){return this.currentRequestedTrack.asTrackStreamedMetric({overrides:t,player:this.player})}onBeforeunload(){u("beforeunload",this),this.currentRequestedTrackHasStartedButNotEnded()&&this.player.configuration.flags.metrics&&this.reportMetrics(this.getStreamingTerminated({terminationReason:"userStop"}),this.getTrackStreamed())}onEnded(){u("ended",this),this.currentRequestedTrackHasChangedOrEnded()||(this.updateCurrentTrack({hasEnded:!0}),this.player.configuration.flags.metrics&&this.reportMetrics(this.getStreamingTerminated({terminationReason:"trackFinished"}),this.getTrackStreamed()))}onStalled(t){u("stalled",this),this.currentRequestedTrackHasChangedOrEnded()||(t?this.updateCurrentTrack({rebufferCount:this.currentRequestedTrack.rebufferCount+1,stalledAt:this.clock.now()}):(this.shouldEmitStreamingRequiredRebuffering()&&this.player.configuration.flags.metrics&&this.reportMetrics(this.getStreamingRequiredReBuffering()),this.updateCurrentTrack({stalledAt:null})))}onStarted(){u("started",this),this.currentRequestedTrackHasChangedOrEnded()||this.currentRequestedTrackHasStarted()||(this.updateCurrentTrack({pausedAt:null,startedAt:this.clock.now()}),this.currentRequestedTrackHasStartedFromTheBeginnging()||this.player.configuration.flags.metrics&&this.reportMetrics(this.getStreamingInitiated()),this.updateCurrentTrack({hasStartedFromTheBeginning:!0}))}onLoad({id:t,type:e},{isDirectedPlay:r,isExplicitLanguageFilterOn:n,isShufflePlay:i,pageType:o,selectionSourceType:s,selectionSourceId:a,selectionSourceSessionId:c}){u("load",this),this.updateLoadedTrack({id:t,type:e,isDirectedPlay:r,isExplicitLanguageFilterOn:n,isShufflePlay:i,pageType:o,selectionSourceType:s,selectionSourceId:a,selectionSourceSessionId:c})}onPlay({id:t,position:e},{isDirectedPlay:r,isExplicitLanguageFilterOn:i,isShufflePlay:o,isCached:s,pageType:a,selectionSourceType:c,selectionSourceId:h,selectionSourceSessionId:f}){u("play",this);let l=!1;if(this.player.configuration.flags.metrics)if(this.currentRequestedTrackHasChanged(t)&&this.currentRequestedTrackHasStartedButNotEnded()){const t=[this.getTrackStreamed()];!this.currentRequestedTrackIsPaused()&&this.player.configuration.flags.metrics&&(t.push(this.getStreamingTerminated({terminationReason:"userNext"})),this.shouldEmitStreamingRequiredRebuffering()&&t.push(this.getStreamingRequiredReBuffering())),this.player.configuration.flags.metrics&&this.reportMetrics(...t)}else if(this.currentRequestedTrackHasRestarted(t,e)){const t=[this.getTrackStreamed()];this.currentRequestedTrackIsPaused()||t.push(this.getStreamingTerminated({terminationReason:"userPrev"})),this.player.configuration.flags.metrics&&this.reportMetrics(...t)}else this.currentRequestedTrackHasStartedButNotEnded()&&(l=!0,this.currentRequestedTrackIsPaused()||this.player.configuration.flags.metrics&&this.reportMetrics(this.getStreamingTerminated({terminationReason:"trackScrub"})));const p={hasEnded:!1,initiatedAt:this.clock.now(),isDirectedPlay:r,isExplicitLanguageFilterOn:i,isShufflePlay:o,isCached:s,pageType:a,pausedAt:null,selectionSourceType:c,selectionSourceId:h,selectionSourceSessionId:f,startedAt:null};l||(p.hasStartedFromTheBeginning=!1),this.updateCurrentTrack(n({},this.tracks[t],p))}onPause({terminationReason:t="userStop"}={}){u("pause",this),this.currentRequestedTrackHasStartedButNotEnded()&&!this.currentRequestedTrackIsPaused()&&(this.updateCurrentTrack({pausedAt:this.clock.now()}),this.player.configuration.flags.metrics&&this.reportMetrics(this.getStreamingTerminated({terminationReason:t})))}onSeekTo({terminationReason:t="trackScrub"}={}){u("seekTo",this),this.currentRequestedTrackHasStartedButNotEnded()&&this.player.configuration.flags.metrics&&this.reportMetrics(this.getStreamingTerminated({terminationReason:t}))}}const k=[/https\:\/\/[0-z]*\.ext-twitch\.tv/g,/https\:\/\/mp3localhost\.amazon\.com\:\d\d\d\d/g];class x{constructor({player:t,clock:e=new s}){c({player:t},["player"]),this.player=t,this.clock=e,this.isHealthy=!1,this.updateId=0,this.version="1.0.0",this.currentTrack={asin:null,duration:null},this.playbackState="PAUSED",this.positionInSong=-1,this.postToParentWindow=this.postToParentWindow.bind(this),this.healthCheckHandler=this.healthCheckHandler.bind(this),this.onBeforeUnload=this.onBeforeUnload.bind(this),this.onUnload=this.onUnload.bind(this),this.onEnded=this.onEnded.bind(this),this.onStarted=this.onStarted.bind(this),this.onLoad=this.onLoad.bind(this),this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeekTo=this.onSeekTo.bind(this),this.onSetConfig=this.onSetConfig.bind(this),t.addEventListener("started",this.onStarted.bind(this)),t.addEventListener("ended",this.onEnded.bind(this)),window.addEventListener("beforeunload",this.onBeforeUnload.bind(this)),window.window.addEventListener("message",this.healthCheckHandler.bind(this))}postToParentWindow(t){if(!this.player.configuration.flags.broadcast||!this.isHealthy)return;let e=Object.assign({},t);try{e.timeStamp=this.clock.now(),e.updateId=++this.updateId,e.version="1.0.0",window.opener.postMessage(JSON.stringify(e),"*")}catch(t){u(t)}}healthCheckHandler(t={}){window.window.opener&&t.origin&&k.some(e=>e.test(t.origin))&&"Health"===t.data&&(this.isHealthy||(this.isHealthy=!0,this.onSetConfig()),window.opener.postMessage("Health OK",t.origin))}onSetConfig(){const{appName:t,appVersion:e,clientId:r,deviceId:n,deviceTypeId:i,customerId:o,musicTerritory:s,tier:a}=this.player.configuration;this.postToParentWindow({appName:t,appVersion:e,clientId:r,deviceId:n,deviceTypeId:i,customerId:o,musicTerritory:s,tier:a})}onBeforeUnload(){this.postToParentWindow({playbackState:"PAUSED"})}onUnload(){this.postToParentWindow({playbackState:"PAUSED"})}onEnded(){this.postToParentWindow({playbackState:"PAUSED",positionInSong:0})}onStarted(){let t=Math.floor(this.player.getDuration());this.postToParentWindow({playbackState:"PLAYING",currentTrack:{duration:t},positionInSong:this.player.getCurrentTime()})}onLoad(t){this.postToParentWindow({trackToLoad:{asin:t}})}onPlay(t,e){const r={positionInSong:this.player.isCurrentTrackId(t)?e:0};t&&!this.player.isCurrentTrackId(t)&&(r.currentTrack={},r.currentTrack.asin=t),this.postToParentWindow(r)}onResume(){const t={playbackState:"PLAYING",positionInSong:this.player.getCurrentTime()};this.postToParentWindow(t)}onPause(){this.postToParentWindow({playbackState:"PAUSED"})}onSeekTo(t){this.postToParentWindow({positionInSong:t})}}var O=function(t,e,r){if(!t)return r;var n,i;if(Array.isArray(e)&&(n=e.slice(0)),"string"==typeof e&&(n=e.split(".")),"symbol"==typeof e&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;){if(i=n.shift(),!t)return r;if(void 0===(t=t[i]))return r}return t};const C=["appVersion","clientId","customerId","deviceId","deviceTypeId","hostname","musicTerritory"],D=["https","asin","coid","livemcid","staticmcid"];t.Player=class extends e.Player{constructor(t){c(t,C),super(),this.configuration=Object.assign({},t,{flags:Object.assign({broadcast:!1,metrics:!0,drm:!0},t.flags)}),this.flags=this.configuration.flags,this.setConfig({drm:m(this.configuration)}),this.setConfig(this.configuration),this.inflightIds=new Map,this.reportMetrics=this.reportMetrics.bind(this),this.load=this.load.bind(this),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.seekTo=this.seekTo.bind(this),this.getConfig=this.getConfig.bind(this),this.setConfig=this.setConfig.bind(this),this.inflightWrapper=this.inflightWrapper.bind(this),this.metricsReporter=new T({player:this}),this.addEventListener("error",this.handleError)}reportMetrics(t){this.metricsReporter&&t(this.metricsReporter)}load(t,{isDirectedPlay:e=!1,isExplicitLanguageFilterOn:n=!1,isShufflePlay:i=!1,pageType:o,selectionSourceType:s,selectionSourceId:a,selectionSourceSessionId:u,bitrates:c,position:h=0}={}){const[f,l]=t.split("://");let p,d=f;if(!D.includes(f))throw"Invalid identifier. Supported identifiers: "+D;const g=this.configuration.flags||{};switch("asin"===d&&w()&&!g.hls&&(d="coid"),this.playbackBroadcaster&&this.playbackBroadcaster.onLoad(l),this.reportMetrics(t=>t.onLoad({id:l,type:d},{isDirectedPlay:e,isExplicitLanguageFilterOn:n,isShufflePlay:i,pageType:o,selectionSourceType:s,selectionSourceId:a,selectionSourceSessionId:u})),d){case"asin":return p=function(t,e,n={flags:{}}){return _(n.flags)?function(t,e,n={}){try{return Object.assign(n,{containerFormat:"HLS",format:"ENCRYPTED_AAC",drmType:"FAIRPLAY",userAgent:navigator.userAgent}),Promise.resolve(r.getStreamingURLsWithFirstChunkV2(t,e&&e.length?e[0]:void 0,n)).then((function(t){if(!((e=t)&&e.data&&e.data.contentResponseList&&e.data.contentResponseList.length&&"SUCCESS"===e.data.contentResponseList[0].statusCode))throw new Error("CONTENT_NOT_ELIGIBLE");var e;const{urlList:r,cdnTypeList:n,expiration:i,firstChunkURL:o}=t.data.contentResponseList[0],s=n&&n.length?n[0]:null,a=r&&r.length?r[0]:null,u=t.data.clientCertificate;if(!a)throw new Error("No manifest url");if(!u)throw new Error("No certificate");return{url:a,firstChunkURL:o,expiration:i,extension:"m3u8",cdnType:s,certificateData:u}}))}catch(t){return Promise.reject(t)}}(t,e,n):function(t,e,n){const{flags:i}=n;return(i.drm&&!E()?r.getDashManifestsV2(t,e,n):r.getDashManifests(t,"ASIN",e,n)).then(t=>{if((t=>t.data&&t.data.contentResponseList&&t.data.contentResponseList[0]&&"SUCCESS"!==t.data.contentResponseList[0].contentResponseStatusCode)(t))throw new Error("CONTENT_NOT_ELIGIBLE");const e=(t=>t&&t.data&&t.data.contentResponseList&&t.data.contentResponseList[0].manifest.replace(/\n/g,"").replace(/\"/g,'"'))(t),r=(t=>t&&t.data&&t.data.contentResponseList&&t.data.contentResponseList[0]&&t.data.contentResponseList[0].cdnType)(t);return{manifest:e,expiration:(t=>{const e=t&&t.data&&t.data.contentResponseList&&t.data.contentResponseList[0]&&t.data.contentResponseList[0].expiration&&t.data.contentResponseList[0].expiration.fixedTime;return e?1e3*e:null})(t),extension:"mpd",cdnType:r}})}(t,e||b,n)}(l,c,this.configuration).then(t=>{const{manifest:e,expiration:r,extension:n,cdnType:i,url:o,certificateData:s}=t;return this.metricsReporter.updateLoadedTrack({id:l,cdnType:i}),super.load({id:l,manifest:e,extension:n,expiration:r,url:o,certificateData:s},h)}),this.inflightWrapper(l,p);case"coid":return p=r.getRestrictedStreamingURL(l,f.toUpperCase(),this.configuration).then(({data:t})=>{const e=(O(t,"contentResponse.urlList")||[])[0],r=O(t,"contentResponse.expiration");return super.load({id:l,url:e,expiration:r},h)}),this.inflightWrapper(l,p);case"https":return Promise.resolve(super.load({id:l,url:t},h));case"livemcid":return p=r.getLiveStreamingURL(l,w()?"HLS":"DASH",this.configuration).then(({data:t})=>{const e=(O(t.Output,"contentResponseList")||[])[0],r=(O(e,"urlList")||[])[0],n=O(e,"expiration");return super.load({id:l,url:r,expiration:n},h)}),this.inflightWrapper(l,p);case"staticmcid":return p=r.getOnDemandStreamingURL(l,w()?"HLS":"DASH",this.configuration).then(({data:t})=>{const e=(O(t.Output,"contentResponseList")||[])[0],r=(O(e,"urlList")||[])[0],n=O(e,"expiration");return super.load({id:l,url:r,expiration:n},h)}),this.inflightWrapper(l,p);default:return Promise.reject(new Error("UNSUPPORTED_IDENITIFIER"))}}play(t,e=0,{isDirectedPlay:r,isExplicitLanguageFilterOn:n,isShufflePlay:i,pageType:o,selectionSourceType:s,selectionSourceId:a,selectionSourceSessionId:u}={}){const[,c]=t.includes("://")?t.split("://"):[null,t];this.playbackBroadcaster&&this.playbackBroadcaster.onPlay(c,e),this.reportMetrics(t=>t.onPlay({id:c,position:e},{isDirectedPlay:r,isExplicitLanguageFilterOn:n,isShufflePlay:i,pageType:o,selectionSourceType:s,selectionSourceId:a,selectionSourceSessionId:u,isCached:this.isCached(c)})),this.isPlaying()&&!this.isCurrentTrackId(c)&&super.pause(),this.isCached(c)&&!this.isCurrentTrackId(c)||!this.inflightIds.has(c)?super.play(c,e):this.inflightIds.get(c).then(()=>{this.isCached(c)&&super.play(c,e)})}pause(){this.playbackBroadcaster&&this.playbackBroadcaster.onPause(),this.reportMetrics(t=>t.onPause()),super.pause()}resume(){this.playbackBroadcaster&&this.playbackBroadcaster.onResume(),super.resume()}seekTo(t,{terminationReason:e="trackScrub"}={}){this.playbackBroadcaster&&this.playbackBroadcaster.onSeekTo(t),this.reportMetrics(r=>r.onSeekTo({position:t,terminationReason:e})),super.seekTo(t)}getConfig(){return this.configuration}setConfig(t){this.configuration=Object.assign({},this.configuration,t),this.configuration=Object.assign({},this.configuration,{drm:m(this.configuration)}),super.setConfig(this.configuration),this.configuration.flags.broadcast?(this.playbackBroadcaster=this.playbackBroadcaster||new x({player:this}),this.playbackBroadcaster.onSetConfig()):this.playbackBroadcaster=void 0}inflightWrapper(t,e){return this.inflightIds.set(t,e),e.then(e=>(this.inflightIds.delete(t),e)).catch(e=>{throw this.inflightIds.delete(t),e})}handleError(t,e){const r=this;return Promise.resolve(function(n,i){try{var o=function(){const n=function(){if("NETWORK_ERROR"===t){const t=e.response,n=function(){if(t&&400===t.status&&t.url&&t.url.indexOf("api/dmls")>=0)return Promise.resolve(t.json()).then((function(t){"VMP_VALIDATION_FAILED"===t.denialReason&&r.setConfig({VMPFailed:!0})}))}();if(n&&n.then)return n.then((function(){}))}}();if(n&&n.then)return n.then((function(){}))}()}catch(t){return}return o&&o.then?o.then(void 0,(function(){})):o}())}static getBrowserDrmInfo(t,e,r){return function(t,e,r){if("Android"===r)return f;if("iOS"===r)return p;switch(t){case"Safari":return p;case"Chrome":case"Firefox":case"Opera":case"Brave":return h;case"IE":return l;case"Edge":return+e>=79?h:l;default:return h}}(t,e,r)}}}(e,r("BykZ"),r("YsRS"))}}]);
//# sourceMappingURL=vendors~orchestra.d911d95c206116a883da.js.map